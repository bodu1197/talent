{
  "statistics": {
    "detectionDate": "2025-12-16T21:38:00.807Z",
    "formats": {
      "typescript": {
        "sources": {
          "src/app/api/errands/[id]/applications/[appId]/route.ts": {
            "lines": 236,
            "tokens": 2335,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 54,
            "duplicatedTokens": 551,
            "percentage": 22.88,
            "percentageTokens": 23.6,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/services.test.ts": {
            "lines": 702,
            "tokens": 8075,
            "sources": 1,
            "clones": 16,
            "duplicatedLines": 276,
            "duplicatedTokens": 3280,
            "percentage": 39.32,
            "percentageTokens": 40.62,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/search.test.ts": {
            "lines": 237,
            "tokens": 2399,
            "sources": 1,
            "clones": 15,
            "duplicatedLines": 209,
            "duplicatedTokens": 1772,
            "percentage": 88.19,
            "percentageTokens": 73.86,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/reviews.test.ts": {
            "lines": 181,
            "tokens": 1921,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 53,
            "duplicatedTokens": 511,
            "percentage": 29.28,
            "percentageTokens": 26.6,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/quotes.test.ts": {
            "lines": 161,
            "tokens": 1706,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 35,
            "duplicatedTokens": 382,
            "percentage": 21.74,
            "percentageTokens": 22.39,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/personalized-services.test.ts": {
            "lines": 737,
            "tokens": 7916,
            "sources": 1,
            "clones": 30,
            "duplicatedLines": 701,
            "duplicatedTokens": 7433,
            "percentage": 95.12,
            "percentageTokens": 93.9,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/orders.test.ts": {
            "lines": 190,
            "tokens": 1995,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 32,
            "duplicatedTokens": 347,
            "percentage": 16.84,
            "percentageTokens": 17.39,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/messages.test.ts": {
            "lines": 76,
            "tokens": 870,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/earnings.test.ts": {
            "lines": 67,
            "tokens": 792,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/dashboard.test.ts": {
            "lines": 503,
            "tokens": 5480,
            "sources": 1,
            "clones": 26,
            "duplicatedLines": 354,
            "duplicatedTokens": 4134,
            "percentage": 70.38,
            "percentageTokens": 75.44,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/coupons.test.ts": {
            "lines": 93,
            "tokens": 1054,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 44,
            "duplicatedTokens": 544,
            "percentage": 47.31,
            "percentageTokens": 51.61,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/queries/category-visits.test.ts": {
            "lines": 150,
            "tokens": 1532,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 252,
            "percentage": 14.67,
            "percentageTokens": 16.45,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/mutations/reviews.test.ts": {
            "lines": 195,
            "tokens": 2046,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 55,
            "duplicatedTokens": 620,
            "percentage": 28.21,
            "percentageTokens": 30.3,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/supabase/mutations/orders.test.ts": {
            "lines": 163,
            "tokens": 1817,
            "sources": 1,
            "clones": 9,
            "duplicatedLines": 115,
            "duplicatedTokens": 1284,
            "percentage": 70.55,
            "percentageTokens": 70.67,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/webhook/portone/payment/route.ts": {
            "lines": 239,
            "tokens": 2133,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 23,
            "duplicatedTokens": 210,
            "percentage": 9.62,
            "percentageTokens": 9.85,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/webhook/portone/identity/route.ts": {
            "lines": 125,
            "tokens": 1117,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/seller/services/[serviceId]/route.ts": {
            "lines": 216,
            "tokens": 2279,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 11,
            "duplicatedTokens": 130,
            "percentage": 5.09,
            "percentageTokens": 5.7,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/seller/portfolio/[id]/route.ts": {
            "lines": 143,
            "tokens": 1633,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 58,
            "duplicatedTokens": 692,
            "percentage": 40.56,
            "percentageTokens": 42.38,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/seller/advertising/dashboard/route.ts": {
            "lines": 116,
            "tokens": 1247,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 10,
            "duplicatedTokens": 94,
            "percentage": 8.62,
            "percentageTokens": 7.54,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/seller/advertising/bank-transfer/route.ts": {
            "lines": 139,
            "tokens": 1366,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 10,
            "duplicatedTokens": 94,
            "percentage": 7.19,
            "percentageTokens": 6.88,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/bank-transfer/request/route.ts": {
            "lines": 101,
            "tokens": 954,
            "sources": 1,
            "clones": 10,
            "duplicatedLines": 121,
            "duplicatedTokens": 1401,
            "percentage": 119.8,
            "percentageTokens": 146.86,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/advertising/verify/route.ts": {
            "lines": 230,
            "tokens": 2361,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 233,
            "percentage": 9.57,
            "percentageTokens": 9.87,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/advertising/prepare/route.ts": {
            "lines": 100,
            "tokens": 1069,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 11,
            "duplicatedTokens": 149,
            "percentage": 11,
            "percentageTokens": 13.94,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/[id]/status/route.ts": {
            "lines": 148,
            "tokens": 1438,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 63,
            "duplicatedTokens": 670,
            "percentage": 42.57,
            "percentageTokens": 46.59,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/[id]/revision/route.ts": {
            "lines": 76,
            "tokens": 850,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 14,
            "duplicatedTokens": 138,
            "percentage": 18.42,
            "percentageTokens": 16.24,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/[id]/confirm/route.ts": {
            "lines": 112,
            "tokens": 1069,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 32,
            "duplicatedTokens": 336,
            "percentage": 28.57,
            "percentageTokens": 31.43,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/[id]/complete-revision/route.ts": {
            "lines": 81,
            "tokens": 853,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 65,
            "duplicatedTokens": 690,
            "percentage": 80.25,
            "percentageTokens": 80.89,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/[id]/cancel/route.ts": {
            "lines": 170,
            "tokens": 1719,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 25,
            "duplicatedTokens": 293,
            "percentage": 14.71,
            "percentageTokens": 17.04,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/notifications/[id]/read/route.ts": {
            "lines": 37,
            "tokens": 406,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 15,
            "duplicatedTokens": 172,
            "percentage": 40.54,
            "percentageTokens": 42.36,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/experts/nearby/categories/route.ts": {
            "lines": 81,
            "tokens": 745,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 20,
            "duplicatedTokens": 164,
            "percentage": 24.69,
            "percentageTokens": 22.01,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/errands/[id]/chat/route.ts": {
            "lines": 251,
            "tokens": 2263,
            "sources": 1,
            "clones": 6,
            "duplicatedLines": 80,
            "duplicatedTokens": 790,
            "percentage": 31.87,
            "percentageTokens": 34.91,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/errands/[id]/applications/route.ts": {
            "lines": 311,
            "tokens": 2837,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 26,
            "duplicatedTokens": 289,
            "percentage": 8.36,
            "percentageTokens": 10.19,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/errands/nearby-helpers/list/route.ts": {
            "lines": 102,
            "tokens": 1208,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 155,
            "percentage": 11.76,
            "percentageTokens": 12.83,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/rooms/create-from-order/route.ts": {
            "lines": 84,
            "tokens": 879,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 46,
            "duplicatedTokens": 475,
            "percentage": 54.76,
            "percentageTokens": 54.04,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/messages/mark-read/route.ts": {
            "lines": 50,
            "tokens": 548,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/messages/mark-all-read/route.ts": {
            "lines": 34,
            "tokens": 367,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 228,
            "percentage": 64.71,
            "percentageTokens": 62.13,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/advertising/track/impression/route.ts": {
            "lines": 70,
            "tokens": 598,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/advertising/track/click/route.ts": {
            "lines": 87,
            "tokens": 747,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/users/[userId]/route.ts": {
            "lines": 159,
            "tokens": 2013,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 11,
            "duplicatedTokens": 130,
            "percentage": 6.92,
            "percentageTokens": 6.46,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/analytics/referrers/route.ts": {
            "lines": 63,
            "tokens": 619,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 35,
            "duplicatedTokens": 363,
            "percentage": 55.56,
            "percentageTokens": 58.64,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/analytics/realtime/route.ts": {
            "lines": 84,
            "tokens": 854,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 14,
            "duplicatedTokens": 115,
            "percentage": 16.67,
            "percentageTokens": 13.47,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/analytics/devices/route.ts": {
            "lines": 86,
            "tokens": 910,
            "sources": 1,
            "clones": 9,
            "duplicatedLines": 102,
            "duplicatedTokens": 1106,
            "percentage": 118.6,
            "percentageTokens": 121.54,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/advertising/statistics/route.ts": {
            "lines": 264,
            "tokens": 2400,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 11,
            "duplicatedTokens": 115,
            "percentage": 4.17,
            "percentageTokens": 4.79,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/advertising/payments/route.ts": {
            "lines": 349,
            "tokens": 3191,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 58,
            "duplicatedTokens": 639,
            "percentage": 16.62,
            "percentageTokens": 20.03,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/advertising/credits/route.ts": {
            "lines": 234,
            "tokens": 2397,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 60,
            "duplicatedTokens": 709,
            "percentage": 25.64,
            "percentageTokens": 29.58,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/utils/nickname-generator.test.ts": {
            "lines": 117,
            "tokens": 1142,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/utils/crypto-shuffle.test.ts": {
            "lines": 140,
            "tokens": 1834,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/auth/singleton.test.ts": {
            "lines": 379,
            "tokens": 3568,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 184,
            "percentage": 5.8,
            "percentageTokens": 5.16,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/auth/server.test.ts": {
            "lines": 170,
            "tokens": 1705,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/auth/config.test.ts": {
            "lines": 347,
            "tokens": 2992,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/auth/client.test.ts": {
            "lines": 121,
            "tokens": 1316,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/api/error-handler.test.ts": {
            "lines": 132,
            "tokens": 1507,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/api/auth-middleware.test.ts": {
            "lines": 113,
            "tokens": 1284,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 20,
            "duplicatedTokens": 232,
            "percentage": 17.7,
            "percentageTokens": 18.07,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/admin/auth.test.ts": {
            "lines": 100,
            "tokens": 991,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/users/profile.test.ts": {
            "lines": 168,
            "tokens": 1713,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 55,
            "duplicatedTokens": 524,
            "percentage": 32.74,
            "percentageTokens": 30.59,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/user/service-views.test.ts": {
            "lines": 242,
            "tokens": 2625,
            "sources": 1,
            "clones": 31,
            "duplicatedLines": 491,
            "duplicatedTokens": 4633,
            "percentage": 202.89,
            "percentageTokens": 176.5,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/user/service-favorites.test.ts": {
            "lines": 291,
            "tokens": 3127,
            "sources": 1,
            "clones": 18,
            "duplicatedLines": 229,
            "duplicatedTokens": 2382,
            "percentage": 78.69,
            "percentageTokens": 76.18,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/user/category-visits.test.ts": {
            "lines": 240,
            "tokens": 2524,
            "sources": 1,
            "clones": 8,
            "duplicatedLines": 115,
            "duplicatedTokens": 1033,
            "percentage": 47.92,
            "percentageTokens": 40.93,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/search/services.test.ts": {
            "lines": 112,
            "tokens": 1240,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 31,
            "duplicatedTokens": 276,
            "percentage": 27.68,
            "percentageTokens": 22.26,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/portfolio/portfolio.test.ts": {
            "lines": 197,
            "tokens": 2123,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 62,
            "duplicatedTokens": 674,
            "percentage": 31.47,
            "percentageTokens": 31.75,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/payments/verify.test.ts": {
            "lines": 752,
            "tokens": 6149,
            "sources": 1,
            "clones": 67,
            "duplicatedLines": 1089,
            "duplicatedTokens": 9131,
            "percentage": 144.81,
            "percentageTokens": 148.5,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/payments/direct-purchase.test.ts": {
            "lines": 848,
            "tokens": 7934,
            "sources": 1,
            "clones": 54,
            "duplicatedLines": 921,
            "duplicatedTokens": 8564,
            "percentage": 108.61,
            "percentageTokens": 107.94,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/payment-requests/payment-requests.test.ts": {
            "lines": 134,
            "tokens": 1451,
            "sources": 1,
            "clones": 6,
            "duplicatedLines": 66,
            "duplicatedTokens": 574,
            "percentage": 49.25,
            "percentageTokens": 39.56,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/status.test.ts": {
            "lines": 689,
            "tokens": 6299,
            "sources": 1,
            "clones": 44,
            "duplicatedLines": 642,
            "duplicatedTokens": 6034,
            "percentage": 93.18,
            "percentageTokens": 95.79,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/seller.test.ts": {
            "lines": 150,
            "tokens": 1656,
            "sources": 1,
            "clones": 8,
            "duplicatedLines": 117,
            "duplicatedTokens": 1059,
            "percentage": 78,
            "percentageTokens": 63.95,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/seller-orders.test.ts": {
            "lines": 106,
            "tokens": 1049,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 67,
            "duplicatedTokens": 651,
            "percentage": 63.21,
            "percentageTokens": 62.06,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/seller-count.test.ts": {
            "lines": 105,
            "tokens": 1063,
            "sources": 1,
            "clones": 6,
            "duplicatedLines": 74,
            "duplicatedTokens": 695,
            "percentage": 70.48,
            "percentageTokens": 65.38,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/revision.test.ts": {
            "lines": 242,
            "tokens": 2812,
            "sources": 1,
            "clones": 19,
            "duplicatedLines": 252,
            "duplicatedTokens": 2861,
            "percentage": 104.13,
            "percentageTokens": 101.74,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/complete-revision.test.ts": {
            "lines": 243,
            "tokens": 2613,
            "sources": 1,
            "clones": 18,
            "duplicatedLines": 262,
            "duplicatedTokens": 2598,
            "percentage": 107.82,
            "percentageTokens": 99.43,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/buyer.test.ts": {
            "lines": 117,
            "tokens": 1237,
            "sources": 1,
            "clones": 6,
            "duplicatedLines": 81,
            "duplicatedTokens": 765,
            "percentage": 69.23,
            "percentageTokens": 61.84,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/buyer-orders.test.ts": {
            "lines": 135,
            "tokens": 1274,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 53,
            "duplicatedTokens": 532,
            "percentage": 39.26,
            "percentageTokens": 41.76,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/orders/buyer-count.test.ts": {
            "lines": 141,
            "tokens": 1452,
            "sources": 1,
            "clones": 9,
            "duplicatedLines": 107,
            "duplicatedTokens": 1030,
            "percentage": 75.89,
            "percentageTokens": 70.94,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/notifications/read-all.test.ts": {
            "lines": 109,
            "tokens": 1021,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 61,
            "duplicatedTokens": 548,
            "percentage": 55.96,
            "percentageTokens": 53.67,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/notifications/notifications.test.ts": {
            "lines": 146,
            "tokens": 1564,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 60,
            "duplicatedTokens": 563,
            "percentage": 41.1,
            "percentageTokens": 36,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/notifications/notification-read.test.ts": {
            "lines": 114,
            "tokens": 1228,
            "sources": 1,
            "clones": 8,
            "duplicatedLines": 94,
            "duplicatedTokens": 993,
            "percentage": 82.46,
            "percentageTokens": 80.86,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/notifications/count.test.ts": {
            "lines": 83,
            "tokens": 782,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 16,
            "duplicatedTokens": 145,
            "percentage": 19.28,
            "percentageTokens": 18.54,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/chat/unread-count.test.ts": {
            "lines": 109,
            "tokens": 1053,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 27,
            "duplicatedTokens": 236,
            "percentage": 24.77,
            "percentageTokens": 22.41,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/chat/search.test.ts": {
            "lines": 159,
            "tokens": 1700,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 14,
            "duplicatedTokens": 106,
            "percentage": 8.81,
            "percentageTokens": 6.24,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/chat/rooms.test.ts": {
            "lines": 118,
            "tokens": 1147,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 58,
            "duplicatedTokens": 525,
            "percentage": 49.15,
            "percentageTokens": 45.77,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/chat/messages.test.ts": {
            "lines": 267,
            "tokens": 2429,
            "sources": 1,
            "clones": 10,
            "duplicatedLines": 136,
            "duplicatedTokens": 1223,
            "percentage": 50.94,
            "percentageTokens": 50.35,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/chat/mark-read.test.ts": {
            "lines": 141,
            "tokens": 1526,
            "sources": 1,
            "clones": 7,
            "duplicatedLines": 101,
            "duplicatedTokens": 964,
            "percentage": 71.63,
            "percentageTokens": 63.17,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/chat/favorites.test.ts": {
            "lines": 142,
            "tokens": 1353,
            "sources": 1,
            "clones": 8,
            "duplicatedLines": 99,
            "duplicatedTokens": 908,
            "percentage": 69.72,
            "percentageTokens": 67.11,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/auth/check-email.test.ts": {
            "lines": 111,
            "tokens": 1114,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 41,
            "duplicatedTokens": 399,
            "percentage": 36.94,
            "percentageTokens": 35.82,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/analytics/track.test.ts": {
            "lines": 257,
            "tokens": 2374,
            "sources": 1,
            "clones": 13,
            "duplicatedLines": 187,
            "duplicatedTokens": 1748,
            "percentage": 72.76,
            "percentageTokens": 73.63,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/advertising/track-impression.test.ts": {
            "lines": 172,
            "tokens": 1822,
            "sources": 1,
            "clones": 12,
            "duplicatedLines": 139,
            "duplicatedTokens": 1388,
            "percentage": 80.81,
            "percentageTokens": 76.18,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/advertising/track-click.test.ts": {
            "lines": 176,
            "tokens": 1871,
            "sources": 1,
            "clones": 13,
            "duplicatedLines": 161,
            "duplicatedTokens": 1614,
            "percentage": 91.48,
            "percentageTokens": 86.26,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/admin/devices.test.ts": {
            "lines": 168,
            "tokens": 1521,
            "sources": 1,
            "clones": 6,
            "duplicatedLines": 91,
            "duplicatedTokens": 748,
            "percentage": 54.17,
            "percentageTokens": 49.18,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/admin/categories.test.ts": {
            "lines": 421,
            "tokens": 4099,
            "sources": 1,
            "clones": 8,
            "duplicatedLines": 89,
            "duplicatedTokens": 807,
            "percentage": 21.14,
            "percentageTokens": 19.69,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/api/admin/analytics.test.ts": {
            "lines": 291,
            "tokens": 2750,
            "sources": 1,
            "clones": 7,
            "duplicatedLines": 102,
            "duplicatedTokens": 866,
            "percentage": 35.05,
            "percentageTokens": 31.49,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/auth/register/utils/register-utils.ts": {
            "lines": 94,
            "tokens": 558,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/verification/business/route.ts": {
            "lines": 139,
            "tokens": 1337,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/verification/bank-account/route.ts": {
            "lines": 235,
            "tokens": 2193,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/users/profile/route.ts": {
            "lines": 79,
            "tokens": 766,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/user/service-views/route.ts": {
            "lines": 95,
            "tokens": 826,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 21,
            "duplicatedTokens": 253,
            "percentage": 22.11,
            "percentageTokens": 30.63,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/user/service-favorites/route.ts": {
            "lines": 160,
            "tokens": 1695,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 38,
            "duplicatedTokens": 472,
            "percentage": 23.75,
            "percentageTokens": 27.85,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/user/category-visits/route.ts": {
            "lines": 133,
            "tokens": 1160,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/seller/portfolio/route.ts": {
            "lines": 101,
            "tokens": 856,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 139,
            "percentage": 11.88,
            "percentageTokens": 16.24,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/seller/check/route.ts": {
            "lines": 27,
            "tokens": 289,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 62,
            "duplicatedTokens": 655,
            "percentage": 229.63,
            "percentageTokens": 226.64,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/search/services/route.ts": {
            "lines": 62,
            "tokens": 568,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/verify-direct/route.ts": {
            "lines": 133,
            "tokens": 1351,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 112,
            "percentage": 9.02,
            "percentageTokens": 8.29,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/verify/route.ts": {
            "lines": 124,
            "tokens": 1081,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 112,
            "percentage": 9.68,
            "percentageTokens": 10.36,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/prepare/route.ts": {
            "lines": 103,
            "tokens": 1046,
            "sources": 1,
            "clones": 8,
            "duplicatedLines": 99,
            "duplicatedTokens": 1025,
            "percentage": 96.12,
            "percentageTokens": 97.99,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/mock-payment/route.ts": {
            "lines": 69,
            "tokens": 674,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 39,
            "duplicatedTokens": 388,
            "percentage": 56.52,
            "percentageTokens": 57.57,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payments/direct-purchase/route.ts": {
            "lines": 246,
            "tokens": 2447,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 134,
            "percentage": 4.88,
            "percentageTokens": 5.48,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payment-requests/[id]/route.ts": {
            "lines": 87,
            "tokens": 888,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 110,
            "percentage": 13.79,
            "percentageTokens": 12.39,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/[id]/route.ts": {
            "lines": 73,
            "tokens": 757,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 15,
            "duplicatedTokens": 180,
            "percentage": 20.55,
            "percentageTokens": 23.78,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/seller/route.ts": {
            "lines": 70,
            "tokens": 662,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 29,
            "duplicatedTokens": 247,
            "percentage": 41.43,
            "percentageTokens": 37.31,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/orders/buyer/route.ts": {
            "lines": 41,
            "tokens": 372,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 29,
            "duplicatedTokens": 247,
            "percentage": 70.73,
            "percentageTokens": 66.4,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/notifications/read-all/route.ts": {
            "lines": 35,
            "tokens": 360,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 37,
            "duplicatedTokens": 346,
            "percentage": 105.71,
            "percentageTokens": 96.11,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/notifications/count/route.ts": {
            "lines": 35,
            "tokens": 376,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 121,
            "percentage": 37.14,
            "percentageTokens": 32.18,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/nice/verify/route.ts": {
            "lines": 146,
            "tokens": 104,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/mypage/recent-activities/route.ts": {
            "lines": 152,
            "tokens": 1694,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 219,
            "percentage": 14.47,
            "percentageTokens": 12.93,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/mypage/hub-stats/route.ts": {
            "lines": 73,
            "tokens": 766,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 14,
            "duplicatedTokens": 148,
            "percentage": 19.18,
            "percentageTokens": 19.32,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/helper/location/route.ts": {
            "lines": 177,
            "tokens": 1810,
            "sources": 1,
            "clones": 6,
            "duplicatedLines": 72,
            "duplicatedTokens": 737,
            "percentage": 40.68,
            "percentageTokens": 40.72,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/helper/check/route.ts": {
            "lines": 27,
            "tokens": 289,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 14,
            "duplicatedTokens": 155,
            "percentage": 51.85,
            "percentageTokens": 53.63,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/experts/nearby/route.ts": {
            "lines": 72,
            "tokens": 704,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 20,
            "duplicatedTokens": 164,
            "percentage": 27.78,
            "percentageTokens": 23.3,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/errands/[id]/route.ts": {
            "lines": 350,
            "tokens": 3409,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 24,
            "duplicatedTokens": 226,
            "percentage": 6.86,
            "percentageTokens": 6.63,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/errands/nearby-helpers/route.ts": {
            "lines": 139,
            "tokens": 1418,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 155,
            "percentage": 8.63,
            "percentageTokens": 10.93,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/debug/rpc-test/route.ts": {
            "lines": 63,
            "tokens": 576,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 111,
            "percentage": 19.05,
            "percentageTokens": 19.27,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/debug/personalized/route.ts": {
            "lines": 164,
            "tokens": 1467,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 23,
            "duplicatedTokens": 210,
            "percentage": 14.02,
            "percentageTokens": 14.31,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/debug/category-visits/route.ts": {
            "lines": 43,
            "tokens": 420,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/cron/auto-confirm/route.ts": {
            "lines": 116,
            "tokens": 1169,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/cron/advertising/route.ts": {
            "lines": 74,
            "tokens": 653,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/unread-count/route.ts": {
            "lines": 55,
            "tokens": 639,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 237,
            "percentage": 40,
            "percentageTokens": 37.09,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/search/route.ts": {
            "lines": 48,
            "tokens": 516,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 24,
            "duplicatedTokens": 224,
            "percentage": 50,
            "percentageTokens": 43.41,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/rooms/route.ts": {
            "lines": 347,
            "tokens": 3634,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 22,
            "duplicatedTokens": 235,
            "percentage": 6.34,
            "percentageTokens": 6.47,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/messages/route.ts": {
            "lines": 201,
            "tokens": 1690,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 25,
            "duplicatedTokens": 247,
            "percentage": 12.44,
            "percentageTokens": 14.62,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/chat/favorites/route.ts": {
            "lines": 51,
            "tokens": 551,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/categories/service-type/route.ts": {
            "lines": 73,
            "tokens": 680,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/categories/service-counts/route.ts": {
            "lines": 69,
            "tokens": 684,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/auth/verify-identity/route.ts": {
            "lines": 128,
            "tokens": 1334,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 26,
            "duplicatedTokens": 267,
            "percentage": 20.31,
            "percentageTokens": 20.01,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/auth/check-email/route.ts": {
            "lines": 48,
            "tokens": 471,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/analytics/trending-categories/route.ts": {
            "lines": 170,
            "tokens": 1728,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/analytics/track/route.ts": {
            "lines": 108,
            "tokens": 1002,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/migrate-location/route.ts": {
            "lines": 244,
            "tokens": 639,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/categories/route.ts": {
            "lines": 203,
            "tokens": 2001,
            "sources": 1,
            "clones": 5,
            "duplicatedLines": 62,
            "duplicatedTokens": 677,
            "percentage": 30.54,
            "percentageTokens": 33.83,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/analytics/route.ts": {
            "lines": 290,
            "tokens": 2969,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 23,
            "duplicatedTokens": 294,
            "percentage": 7.93,
            "percentageTokens": 9.9,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/admin/advertising/route.ts": {
            "lines": 223,
            "tokens": 2122,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 37,
            "duplicatedTokens": 404,
            "percentage": 16.59,
            "percentageTokens": 19.04,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/address/search/route.ts": {
            "lines": 184,
            "tokens": 1698,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/address/reverse-geocode/route.ts": {
            "lines": 58,
            "tokens": 604,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/address/geocode/route.ts": {
            "lines": 68,
            "tokens": 684,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/address/directions/route.ts": {
            "lines": 104,
            "tokens": 1042,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/transaction.test.ts": {
            "lines": 787,
            "tokens": 7156,
            "sources": 1,
            "clones": 18,
            "duplicatedLines": 276,
            "duplicatedTokens": 2736,
            "percentage": 35.07,
            "percentageTokens": 38.23,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/template-generator.test.ts": {
            "lines": 339,
            "tokens": 3116,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/rate-limit.test.ts": {
            "lines": 419,
            "tokens": 3821,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/notifications.test.ts": {
            "lines": 255,
            "tokens": 2470,
            "sources": 1,
            "clones": 15,
            "duplicatedLines": 171,
            "duplicatedTokens": 1980,
            "percentage": 67.06,
            "percentageTokens": 80.16,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/logger.test.ts": {
            "lines": 736,
            "tokens": 6795,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 50,
            "duplicatedTokens": 484,
            "percentage": 6.79,
            "percentageTokens": 7.12,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/error.test.ts": {
            "lines": 83,
            "tokens": 865,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/constants.test.ts": {
            "lines": 98,
            "tokens": 1139,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/lib/categories.test.ts": {
            "lines": 208,
            "tokens": 2276,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 33,
            "duplicatedTokens": 374,
            "percentage": 15.87,
            "percentageTokens": 16.43,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/hooks/useYoutubeThumbnail.test.ts": {
            "lines": 136,
            "tokens": 1501,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/hooks/useRateLimiting.test.ts": {
            "lines": 102,
            "tokens": 1046,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 24,
            "duplicatedTokens": 232,
            "percentage": 23.53,
            "percentageTokens": 22.18,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/hooks/usePasswordValidation.test.ts": {
            "lines": 161,
            "tokens": 1694,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/unit/hooks/useLoadingStates.test.ts": {
            "lines": 172,
            "tokens": 1846,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/e2e/services/service-search.spec.ts": {
            "lines": 97,
            "tokens": 768,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/e2e/mypage/mypage-navigation.spec.ts": {
            "lines": 112,
            "tokens": 1061,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/e2e/auth/auth.setup.ts": {
            "lines": 20,
            "tokens": 179,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/e2e/auth/admin-login.spec.ts": {
            "lines": 68,
            "tokens": 662,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/services.ts": {
            "lines": 516,
            "tokens": 4483,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 40,
            "duplicatedTokens": 362,
            "percentage": 7.75,
            "percentageTokens": 8.07,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/service-enrichment-helpers.ts": {
            "lines": 129,
            "tokens": 1217,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 112,
            "percentage": 10.08,
            "percentageTokens": 9.2,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/search.ts": {
            "lines": 433,
            "tokens": 3694,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 30,
            "duplicatedTokens": 315,
            "percentage": 6.93,
            "percentageTokens": 8.53,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/reviews.ts": {
            "lines": 75,
            "tokens": 446,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/quotes.ts": {
            "lines": 65,
            "tokens": 471,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/personalized-services.ts": {
            "lines": 415,
            "tokens": 3590,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 117,
            "percentage": 3.13,
            "percentageTokens": 3.26,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/orders.ts": {
            "lines": 96,
            "tokens": 808,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 27,
            "duplicatedTokens": 250,
            "percentage": 28.13,
            "percentageTokens": 30.94,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/messages.ts": {
            "lines": 183,
            "tokens": 1555,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/earnings.ts": {
            "lines": 216,
            "tokens": 1743,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/dashboard.ts": {
            "lines": 263,
            "tokens": 1724,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/coupons.ts": {
            "lines": 104,
            "tokens": 702,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/category-visits.ts": {
            "lines": 149,
            "tokens": 1112,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/queries/admin.ts": {
            "lines": 862,
            "tokens": 8678,
            "sources": 1,
            "clones": 4,
            "duplicatedLines": 48,
            "duplicatedTokens": 444,
            "percentage": 5.57,
            "percentageTokens": 5.12,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/mutations/reviews.ts": {
            "lines": 84,
            "tokens": 760,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/mutations/orders.ts": {
            "lines": 68,
            "tokens": 624,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/auth/callback/route.ts": {
            "lines": 32,
            "tokens": 331,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/weather/route.ts": {
            "lines": 208,
            "tokens": 2296,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/upload/route.ts": {
            "lines": 105,
            "tokens": 1052,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 11,
            "duplicatedTokens": 103,
            "percentage": 10.48,
            "percentageTokens": 9.79,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/sentry-test/route.ts": {
            "lines": 14,
            "tokens": 34,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/rollbar-test/route.ts": {
            "lines": 25,
            "tokens": 227,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/portfolio/route.ts": {
            "lines": 57,
            "tokens": 611,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 21,
            "duplicatedTokens": 198,
            "percentage": 36.84,
            "percentageTokens": 32.41,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/payment-requests/route.ts": {
            "lines": 148,
            "tokens": 1679,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 28,
            "duplicatedTokens": 305,
            "percentage": 18.92,
            "percentageTokens": 18.17,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/notifications/route.ts": {
            "lines": 47,
            "tokens": 478,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 119,
            "percentage": 27.66,
            "percentageTokens": 24.9,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/helper/route.ts": {
            "lines": 216,
            "tokens": 2223,
            "sources": 1,
            "clones": 3,
            "duplicatedLines": 36,
            "duplicatedTokens": 375,
            "percentage": 16.67,
            "percentageTokens": 16.87,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/api/errands/route.ts": {
            "lines": 582,
            "tokens": 5931,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 10,
            "duplicatedTokens": 104,
            "percentage": 1.72,
            "percentageTokens": 1.75,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/lib/error.test.ts": {
            "lines": 38,
            "tokens": 449,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/validation/input.ts": {
            "lines": 65,
            "tokens": 396,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/utils/nickname-generator.ts": {
            "lines": 147,
            "tokens": 702,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/utils/crypto-shuffle.ts": {
            "lines": 36,
            "tokens": 322,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/user/settingsData.ts": {
            "lines": 31,
            "tokens": 280,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/singleton.ts": {
            "lines": 147,
            "tokens": 1108,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/server.ts": {
            "lines": 16,
            "tokens": 73,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/supabase/client.ts": {
            "lines": 8,
            "tokens": 41,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/services/service-helpers.ts": {
            "lines": 87,
            "tokens": 965,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 17,
            "duplicatedTokens": 198,
            "percentage": 19.54,
            "percentageTokens": 20.52,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/services/advertising-helpers.ts": {
            "lines": 17,
            "tokens": 138,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/seller/profileData.ts": {
            "lines": 46,
            "tokens": 396,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/seller/portfolioData.ts": {
            "lines": 74,
            "tokens": 744,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/seller/page-auth.ts": {
            "lines": 44,
            "tokens": 337,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/seller/earningsData.ts": {
            "lines": 32,
            "tokens": 286,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/rollbar/server.ts": {
            "lines": 21,
            "tokens": 190,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/prefetch/buyerPrefetch.ts": {
            "lines": 28,
            "tokens": 335,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/portone/identity.ts": {
            "lines": 31,
            "tokens": 268,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 104,
            "percentage": 41.94,
            "percentageTokens": 38.81,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/payment/portone.ts": {
            "lines": 143,
            "tokens": 1049,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/orders/statusHelpers.ts": {
            "lines": 86,
            "tokens": 686,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/orders/status.ts": {
            "lines": 42,
            "tokens": 244,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/location/address-api.ts": {
            "lines": 209,
            "tokens": 1678,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/errands/helpers.ts": {
            "lines": 30,
            "tokens": 319,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 113,
            "percentage": 43.33,
            "percentageTokens": 35.42,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/errands/category.ts": {
            "lines": 20,
            "tokens": 136,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 113,
            "percentage": 65,
            "percentageTokens": 83.09,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/constants/categories.ts": {
            "lines": 26,
            "tokens": 131,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/chat/timeline.ts": {
            "lines": 28,
            "tokens": 309,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/auth/config.ts": {
            "lines": 87,
            "tokens": 478,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/verification-common.ts": {
            "lines": 46,
            "tokens": 408,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/validation.ts": {
            "lines": 18,
            "tokens": 141,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/payment-verify.ts": {
            "lines": 106,
            "tokens": 977,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 136,
            "percentage": 12.26,
            "percentageTokens": 13.92,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/ownership.ts": {
            "lines": 203,
            "tokens": 1626,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 26,
            "duplicatedTokens": 224,
            "percentage": 12.81,
            "percentageTokens": 13.78,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/order-loader.ts": {
            "lines": 44,
            "tokens": 369,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/error-handler.ts": {
            "lines": 80,
            "tokens": 467,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/errands-common.ts": {
            "lines": 54,
            "tokens": 482,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 26,
            "duplicatedTokens": 282,
            "percentage": 48.15,
            "percentageTokens": 58.51,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/chat-common.ts": {
            "lines": 57,
            "tokens": 503,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 13,
            "duplicatedTokens": 146,
            "percentage": 22.81,
            "percentageTokens": 29.03,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/auth.ts": {
            "lines": 133,
            "tokens": 891,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 133,
            "duplicatedTokens": 891,
            "percentage": 100,
            "percentageTokens": 100,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/auth-middleware.ts": {
            "lines": 59,
            "tokens": 377,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 11,
            "duplicatedTokens": 114,
            "percentage": 18.64,
            "percentageTokens": 30.24,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/api/auth-backup.ts": {
            "lines": 133,
            "tokens": 891,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 133,
            "duplicatedTokens": 891,
            "percentage": 100,
            "percentageTokens": 100,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/admin/page-auth.ts": {
            "lines": 45,
            "tokens": 341,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/admin/auth.ts": {
            "lines": 36,
            "tokens": 358,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/__tests__/setup.ts": {
            "lines": 54,
            "tokens": 513,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/utils/validation.ts": {
            "lines": 95,
            "tokens": 683,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/utils/orderHelpers.ts": {
            "lines": 95,
            "tokens": 662,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/utils/orderCountHelpers.ts": {
            "lines": 43,
            "tokens": 338,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/utils/orderCountApi.ts": {
            "lines": 47,
            "tokens": 482,
            "sources": 1,
            "clones": 1,
            "duplicatedLines": 12,
            "duplicatedTokens": 116,
            "percentage": 25.53,
            "percentageTokens": 24.07,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/utils/format.ts": {
            "lines": 195,
            "tokens": 1571,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/service-form.ts": {
            "lines": 73,
            "tokens": 497,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/package.ts": {
            "lines": 221,
            "tokens": 1875,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/index.ts": {
            "lines": 227,
            "tokens": 1765,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/errand.ts": {
            "lines": 351,
            "tokens": 2975,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/daum-postcode.d.ts": {
            "lines": 40,
            "tokens": 360,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/common.ts": {
            "lines": 333,
            "tokens": 2498,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/chat.ts": {
            "lines": 27,
            "tokens": 228,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/advertising.ts": {
            "lines": 145,
            "tokens": 1239,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/types/admin.ts": {
            "lines": 594,
            "tokens": 4016,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/transaction.ts": {
            "lines": 188,
            "tokens": 1694,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/template-generator.ts": {
            "lines": 322,
            "tokens": 2912,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/serviceWorker.ts": {
            "lines": 15,
            "tokens": 148,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/rate-limit.ts": {
            "lines": 101,
            "tokens": 603,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/notifications.ts": {
            "lines": 124,
            "tokens": 1032,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/logger.ts": {
            "lines": 161,
            "tokens": 1332,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/geo.ts": {
            "lines": 20,
            "tokens": 269,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/error.ts": {
            "lines": 17,
            "tokens": 166,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/errand-pricing.ts": {
            "lines": 284,
            "tokens": 2435,
            "sources": 1,
            "clones": 2,
            "duplicatedLines": 20,
            "duplicatedTokens": 236,
            "percentage": 7.04,
            "percentageTokens": 9.69,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/constants.ts": {
            "lines": 287,
            "tokens": 2372,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/categories.ts": {
            "lines": 269,
            "tokens": 2258,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/advertising.ts": {
            "lines": 817,
            "tokens": 6627,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/lib/advertising-cron.ts": {
            "lines": 301,
            "tokens": 2557,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/useYoutubeThumbnail.ts": {
            "lines": 115,
            "tokens": 656,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/useRateLimiting.ts": {
            "lines": 67,
            "tokens": 461,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/usePaymentState.ts": {
            "lines": 64,
            "tokens": 547,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/usePasswordValidation.ts": {
            "lines": 43,
            "tokens": 292,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/useLoadingStates.ts": {
            "lines": 73,
            "tokens": 429,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/useHelperLocationTracking.ts": {
            "lines": 354,
            "tokens": 3095,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/hooks/useErrandPricing.ts": {
            "lines": 235,
            "tokens": 2129,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/sitemap.ts": {
            "lines": 19,
            "tokens": 191,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          },
          "src/app/robots.ts": {
            "lines": 13,
            "tokens": 122,
            "sources": 1,
            "clones": 0,
            "duplicatedLines": 0,
            "duplicatedTokens": 0,
            "percentage": 0,
            "percentageTokens": 0,
            "newDuplicatedLines": 0,
            "newClones": 0
          }
        },
        "total": {
          "lines": 41824,
          "tokens": 391255,
          "sources": 259,
          "clones": 393,
          "duplicatedLines": 5671,
          "duplicatedTokens": 55664,
          "percentage": 13.56,
          "percentageTokens": 14.23,
          "newDuplicatedLines": 0,
          "newClones": 0
        }
      }
    },
    "total": {
      "lines": 41824,
      "tokens": 391255,
      "sources": 259,
      "clones": 393,
      "duplicatedLines": 5671,
      "duplicatedTokens": 55664,
      "percentage": 13.56,
      "percentageTokens": 14.23,
      "newDuplicatedLines": 0,
      "newClones": 0
    }
  },
  "duplicates": [
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "(request: NextRequest, { params }: RouteParams) {\r\n  try {\r\n    const { id, appId } = await params;\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\applications\\[appId]\\route.ts",
        "start": 174,
        "end": 187,
        "startLoc": {
          "line": 174,
          "column": 7,
          "position": 1683
        },
        "endLoc": {
          "line": 187,
          "column": 13,
          "position": 1830
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\applications\\[appId]\\route.ts",
        "start": 85,
        "end": 98,
        "startLoc": {
          "line": 85,
          "column": 6,
          "position": 674
        },
        "endLoc": {
          "line": 98,
          "column": 25,
          "position": 821
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "], error: null }),\r\n      };\r\n\r\n      vi.mocked(createServerClient).mockResolvedValue({\r\n        from: vi.fn((table) => {\r\n          if (table === 'services') return mockServiceQuery;\r\n          if (table === 'profiles') return mockUserQuery;\r\n          return mockServiceQuery;\r\n        }),\r\n      } as unknown as Awaited<ReturnType<typeof createServerClient>>);\r\n\r\n      const result = await getServiceById('service-1');\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result.seller.user).toBeUndefined",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 209,
        "end": 223,
        "startLoc": {
          "line": 209,
          "column": 2,
          "position": 2189
        },
        "endLoc": {
          "line": 223,
          "column": 14,
          "position": 2349
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 166,
        "end": 180,
        "startLoc": {
          "line": 166,
          "column": 9,
          "position": 1757
        },
        "endLoc": {
          "line": 180,
          "column": 8,
          "position": 1917
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", error: null });\r\n        }\r\n        return mockQuery;\r\n      });\r\n\r\n      vi.mocked(createServerClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createServerClient>>);\r\n\r\n      const result = await getSellerServicesCount('seller-123', 'active');\r\n\r\n      expect(result).toBe(0",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 277,
        "end": 288,
        "startLoc": {
          "line": 277,
          "column": 5,
          "position": 2961
        },
        "endLoc": {
          "line": 288,
          "column": 2,
          "position": 3075
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 254,
        "end": 265,
        "startLoc": {
          "line": 254,
          "column": 2,
          "position": 2709
        },
        "endLoc": {
          "line": 265,
          "column": 2,
          "position": 2823
        }
      }
    },
    {
      "format": "typescript",
      "lines": 46,
      "fragment": ";\r\n\r\n      const mockQueries = {\r\n        categories: {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: mockCategory, error: null }),\r\n        },\r\n        service_categories: {\r\n          select: vi.fn().mockReturnThis(),\r\n          in: vi.fn().mockResolvedValue({ data: mockServiceLinks, error: null }),\r\n        },\r\n        advertising_subscriptions: {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n        },\r\n        services: {\r\n          select: vi.fn().mockReturnThis(),\r\n          in: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          order: vi.fn().mockResolvedValue({ data: mockServices, error: null }),\r\n        },\r\n        reviews: {\r\n          select: vi.fn().mockReturnThis(),\r\n          in: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n        },\r\n        profiles: {\r\n          select: vi.fn().mockReturnThis(),\r\n          in: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n        },\r\n      };\r\n\r\n      vi.mocked(createServerClient).mockResolvedValue({\r\n        from: vi.fn((table) => {\r\n          if (table === 'categories') return mockQueries.categories;\r\n          if (table === 'service_categories') return mockQueries.service_categories;\r\n          if (table === 'advertising_subscriptions') return mockQueries.advertising_subscriptions;\r\n          if (table === 'services') return mockQueries.services;\r\n          if (table === 'reviews') return mockQueries.reviews;\r\n          if (table === 'profiles') return mockQueries.profiles;\r\n          return mockQueries.categories;\r\n        }),\r\n      } as unknown as Awaited<ReturnType<typeof createServerClient>>);\r\n\r\n      // Page 1 should have 28 items",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 447,
        "end": 492,
        "startLoc": {
          "line": 447,
          "column": 2,
          "position": 5002
        },
        "endLoc": {
          "line": 492,
          "column": 31,
          "position": 5622
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 334,
        "end": 379,
        "startLoc": {
          "line": 334,
          "column": 2,
          "position": 3553
        },
        "endLoc": {
          "line": 379,
          "column": 6,
          "position": 4173
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ",\r\n            user_id: 'user-1',\r\n            is_verified: true,\r\n          },\r\n          service_categories: [],\r\n        },\r\n      ];\r\n\r\n      const mockQueries = {\r\n        categories: {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          maybeSingle",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 519,
        "end": 531,
        "startLoc": {
          "line": 519,
          "column": 11,
          "position": 5913
        },
        "endLoc": {
          "line": 531,
          "column": 12,
          "position": 6008
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 328,
        "end": 340,
        "startLoc": {
          "line": 328,
          "column": 13,
          "position": 3513
        },
        "endLoc": {
          "line": 340,
          "column": 7,
          "position": 3608
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\r\n          seller: {\r\n            id: 'seller-1',\r\n            business_name: 'Business',\r\n            user_id: 'user-1',\r\n            is_verified: true,\r\n          },\r\n          service_categories: [],\r\n        },\r\n      ];\r\n\r\n      const mockQueries = {\r\n        categories: {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          maybeSingle: vi.fn().mockResolvedValue({ data: null",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 574,
        "end": 589,
        "startLoc": {
          "line": 574,
          "column": 9,
          "position": 6555
        },
        "endLoc": {
          "line": 589,
          "column": 5,
          "position": 6689
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 516,
        "end": 531,
        "startLoc": {
          "line": 516,
          "column": 2,
          "position": 5890
        },
        "endLoc": {
          "line": 531,
          "column": 15,
          "position": 6024
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ": vi.fn().mockReturnThis(),\r\n          order: vi.fn().mockReturnThis(),\r\n          limit: vi.fn().mockResolvedValue({ data: mockServices, error: null }),\r\n        },\r\n        reviews: {\r\n          select: vi.fn().mockReturnThis(),\r\n          in: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n        },\r\n      };\r\n\r\n      vi.mocked(createServerClient).mockResolvedValue({\r\n        from: vi.fn((table) => {\r\n          if (table === 'categories') return mockQueries.categories;\r\n          if (table === 'services'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 593,
        "end": 607,
        "startLoc": {
          "line": 593,
          "column": 3,
          "position": 6732
        },
        "endLoc": {
          "line": 607,
          "column": 11,
          "position": 6936
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 540,
        "end": 370,
        "startLoc": {
          "line": 540,
          "column": 4,
          "position": 6141
        },
        "endLoc": {
          "line": 370,
          "column": 21,
          "position": 4047
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "},\r\n      ];\r\n\r\n      const mockQueries = {\r\n        categories: {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          maybeSingle: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        },\r\n        services: {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          order: vi.fn().mockResolvedValue",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 664,
        "end": 676,
        "startLoc": {
          "line": 664,
          "column": 2,
          "position": 7539
        },
        "endLoc": {
          "line": 676,
          "column": 18,
          "position": 7683
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 582,
        "end": 594,
        "startLoc": {
          "line": 582,
          "column": 9,
          "position": 6612
        },
        "endLoc": {
          "line": 594,
          "column": 15,
          "position": 6756
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", error: null }),\r\n        },\r\n      };\r\n\r\n      vi.mocked(createServerClient).mockResolvedValue({\r\n        from: vi.fn((table) => {\r\n          if (table === 'categories') return mockQueries.categories;\r\n          if (table === 'services') return mockQueries.services;\r\n          if (table === 'reviews') return mockQueries.reviews;\r\n          return mockQueries.services;\r\n        }),\r\n      } as unknown as Awaited<ReturnType<typeof createServerClient>>);\r\n\r\n      const result = await getActiveServices();\r\n\r\n      expect(Array",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 681,
        "end": 696,
        "startLoc": {
          "line": 681,
          "column": 12,
          "position": 7765
        },
        "endLoc": {
          "line": 696,
          "column": 6,
          "position": 7934
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\services.test.ts",
        "start": 600,
        "end": 615,
        "startLoc": {
          "line": 600,
          "column": 2,
          "position": 6855
        },
        "endLoc": {
          "line": 615,
          "column": 7,
          "position": 7024
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "}],\r\n        },\r\n      ];\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: mockCategoryClicks, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(mockQuery);\r\n\r\n      const result = await getRecommendedSearchTerms()",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 219,
        "end": 231,
        "startLoc": {
          "line": 219,
          "column": 2,
          "position": 2174
        },
        "endLoc": {
          "line": 231,
          "column": 2,
          "position": 2295
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 161,
        "end": 173,
        "startLoc": {
          "line": 161,
          "column": 2,
          "position": 1544
        },
        "endLoc": {
          "line": 173,
          "column": 3,
          "position": 1665
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ";\r\n\r\n// Mock Supabase client\r\nconst mockSupabase = {\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\reviews.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 33,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 9,
          "position": 205
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 2,
        "end": 21,
        "startLoc": {
          "line": 2,
          "column": 32,
          "position": 40
        },
        "endLoc": {
          "line": 21,
          "column": 51,
          "position": 194
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "},\r\n      ];\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: mockReviews, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(mockQuery);\r\n\r\n      const result = await getSellerReviews",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\reviews.test.ts",
        "start": 84,
        "end": 95,
        "startLoc": {
          "line": 84,
          "column": 2,
          "position": 893
        },
        "endLoc": {
          "line": 95,
          "column": 17,
          "position": 1006
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\reviews.test.ts",
        "start": 34,
        "end": 45,
        "startLoc": {
          "line": 34,
          "column": 2,
          "position": 342
        },
        "endLoc": {
          "line": 45,
          "column": 16,
          "position": 455
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n    });\r\n\r\n    it('should throw error on database failure', async () => {\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      await expect(getQuoteResponses",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\quotes.test.ts",
        "start": 147,
        "end": 159,
        "startLoc": {
          "line": 147,
          "column": 18,
          "position": 1545
        },
        "endLoc": {
          "line": 159,
          "column": 18,
          "position": 1678
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\quotes.test.ts",
        "start": 49,
        "end": 61,
        "startLoc": {
          "line": 49,
          "column": 2,
          "position": 498
        },
        "endLoc": {
          "line": 61,
          "column": 15,
          "position": 631
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "});\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        auth: mockAuthQuery,\r\n        rpc: mockRpc,\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toEqual([]);\r\n    }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 67,
        "end": 77,
        "startLoc": {
          "line": 67,
          "column": 2,
          "position": 803
        },
        "endLoc": {
          "line": 77,
          "column": 2,
          "position": 894
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 42,
        "end": 52,
        "startLoc": {
          "line": 42,
          "column": 2,
          "position": 519
        },
        "endLoc": {
          "line": 52,
          "column": 7,
          "position": 610
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\r\n        parent_id: 'cat-1',\r\n      };\r\n\r\n      const mockTopLevelCategory = {\r\n        id: 'cat-1',\r\n        name: 'Top Level',\r\n        slug: 'top-level',\r\n        level: 1,\r\n        parent_id: null,\r\n      };\r\n\r\n      const mockLevel2Categories = [{ id: 'cat-2' }];\r\n      const mockLevel3Categories = [{ id: 'cat-3' }];\r\n      const mockAdvertising: any[] = [];\r\n      const mockServices:",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 261,
        "end": 276,
        "startLoc": {
          "line": 261,
          "column": 2,
          "position": 2701
        },
        "endLoc": {
          "line": 276,
          "column": 2,
          "position": 2837
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 100,
        "end": 117,
        "startLoc": {
          "line": 100,
          "column": 8,
          "position": 1073
        },
        "endLoc": {
          "line": 117,
          "column": 2,
          "position": 1214
        }
      }
    },
    {
      "format": "typescript",
      "lines": 28,
      "fragment": "return {\r\n                select: vi.fn().mockReturnThis(),\r\n                in: vi.fn().mockResolvedValue({\r\n                  data: mockLevel3Categories,\r\n                  error: null,\r\n                }),\r\n              };\r\n            }\r\n          }\r\n\r\n          if (table === 'advertising_subscriptions') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockResolvedValue({ data: mockAdvertising, error: null }),\r\n            };\r\n          }\r\n\r\n          if (table === 'services') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              in: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockReturnThis(),\r\n              order: vi.fn().mockReturnThis(),\r\n              limit: vi.fn().mockResolvedValue({ data: mockServices, error: null }),\r\n            };\r\n          }\r\n\r\n          return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 312,
        "end": 339,
        "startLoc": {
          "line": 312,
          "column": 15,
          "position": 3286
        },
        "endLoc": {
          "line": 339,
          "column": 7,
          "position": 3562
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 180,
        "end": 207,
        "startLoc": {
          "line": 180,
          "column": 15,
          "position": 1845
        },
        "endLoc": {
          "line": 207,
          "column": 3,
          "position": 2121
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ";\r\n\r\n      vi.mocked(createClient).mockResolvedValue(\r\n        createMockQueries() as unknown as Awaited<ReturnType<typeof createClient>>\r\n      );\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toBeDefined();\r\n      expect(Array.isArray(result)).toBe(true);\r\n    }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 345,
        "end": 355,
        "startLoc": {
          "line": 345,
          "column": 2,
          "position": 3643
        },
        "endLoc": {
          "line": 355,
          "column": 2,
          "position": 3736
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 229,
        "end": 239,
        "startLoc": {
          "line": 229,
          "column": 2,
          "position": 2394
        },
        "endLoc": {
          "line": 239,
          "column": 7,
          "position": 2487
        }
      }
    },
    {
      "format": "typescript",
      "lines": 30,
      "fragment": ",\r\n        level: 1,\r\n        parent_id: null,\r\n      };\r\n\r\n      const mockLevel2Categories = [{ id: 'cat-2' }];\r\n      const mockLevel3Categories = [{ id: 'cat-3' }];\r\n      const mockAdvertising: any[] = [];\r\n      const mockServices: any[] = [];\r\n\r\n      let categoryCallCount = 0;\r\n\r\n      const createMockQueries = () => ({\r\n        auth: {\r\n          getUser: vi.fn().mockResolvedValue({ data: { user: mockUser }, error: null }),\r\n        },\r\n        rpc: vi.fn().mockResolvedValue({ data: mockTopCategories, error: null }),\r\n        from: vi.fn((table: string) => {\r\n          if (table === 'categories') {\r\n            categoryCallCount++;\r\n            if (categoryCallCount === 1) {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                eq: vi.fn().mockReturnThis(),\r\n                single: vi.fn().mockResolvedValue({ data: mockCategoryInfo, error: null }),\r\n              };\r\n            } else if (categoryCallCount === 2) {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                eq: vi.fn().mockResolvedValue",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 372,
        "end": 401,
        "startLoc": {
          "line": 372,
          "column": 15,
          "position": 3874
        },
        "endLoc": {
          "line": 401,
          "column": 18,
          "position": 4261
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 268,
        "end": 297,
        "startLoc": {
          "line": 268,
          "column": 12,
          "position": 2750
        },
        "endLoc": {
          "line": 297,
          "column": 15,
          "position": 3137
        }
      }
    },
    {
      "format": "typescript",
      "lines": 47,
      "fragment": ") {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                in: vi.fn().mockResolvedValue({\r\n                  data: mockLevel3Categories,\r\n                  error: null,\r\n                }),\r\n              };\r\n            }\r\n          }\r\n\r\n          if (table === 'advertising_subscriptions') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockResolvedValue({ data: mockAdvertising, error: null }),\r\n            };\r\n          }\r\n\r\n          if (table === 'services') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              in: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockReturnThis(),\r\n              order: vi.fn().mockReturnThis(),\r\n              limit: vi.fn().mockResolvedValue({ data: mockServices, error: null }),\r\n            };\r\n          }\r\n\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n          };\r\n        }),\r\n      });\r\n\r\n      vi.mocked(createClient).mockResolvedValue(\r\n        createMockQueries() as unknown as Awaited<ReturnType<typeof createClient>>\r\n      );\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toBeDefined();\r\n      expect(Array.isArray(result)).toBe(true);\r\n    });\r\n\r\n    it('should handle services with advertising'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 406,
        "end": 452,
        "startLoc": {
          "line": 406,
          "column": 2,
          "position": 4306
        },
        "endLoc": {
          "line": 452,
          "column": 42,
          "position": 4772
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 311,
        "end": 357,
        "startLoc": {
          "line": 311,
          "column": 2,
          "position": 3280
        },
        "endLoc": {
          "line": 357,
          "column": 59,
          "position": 3746
        }
      }
    },
    {
      "format": "typescript",
      "lines": 22,
      "fragment": ": any[] = [];\r\n\r\n      let categoryCallCount = 0;\r\n\r\n      const createMockQueries = () => ({\r\n        auth: {\r\n          getUser: vi.fn().mockResolvedValue({ data: { user: mockUser }, error: null }),\r\n        },\r\n        rpc: vi.fn().mockResolvedValue({ data: mockTopCategories, error: null }),\r\n        from: vi.fn((table: string) => {\r\n          if (table === 'categories') {\r\n            categoryCallCount++;\r\n            if (categoryCallCount === 1) {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                eq: vi.fn().mockReturnThis(),\r\n                single: vi.fn().mockResolvedValue({ data: mockCategoryInfo, error: null }),\r\n              };\r\n            } else if (categoryCallCount === 2) {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                eq: vi.fn().mockResolvedValue({ data: [",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 497,
        "end": 518,
        "startLoc": {
          "line": 497,
          "column": 12,
          "position": 5175
        },
        "endLoc": {
          "line": 518,
          "column": 2,
          "position": 5482
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 276,
        "end": 402,
        "startLoc": {
          "line": 276,
          "column": 13,
          "position": 2837
        },
        "endLoc": {
          "line": 402,
          "column": 21,
          "position": 4270
        }
      }
    },
    {
      "format": "typescript",
      "lines": 46,
      "fragment": "}),\r\n              };\r\n            }\r\n          }\r\n\r\n          if (table === 'advertising_subscriptions') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockResolvedValue({ data: mockAdvertising, error: null }),\r\n            };\r\n          }\r\n\r\n          if (table === 'services') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              in: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockReturnThis(),\r\n              order: vi.fn().mockReturnThis(),\r\n              limit: vi.fn().mockResolvedValue({ data: mockServices, error: null }),\r\n            };\r\n          }\r\n\r\n          if (table === 'reviews') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              in: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockResolvedValue({ data: mockReviews, error: null }),\r\n            };\r\n          }\r\n\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n          };\r\n        }),\r\n      });\r\n\r\n      vi.mocked(createClient).mockResolvedValue(\r\n        createMockQueries() as unknown as Awaited<ReturnType<typeof createClient>>\r\n      );\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 518,
        "end": 563,
        "startLoc": {
          "line": 518,
          "column": 2,
          "position": 5491
        },
        "endLoc": {
          "line": 563,
          "column": 7,
          "position": 5965
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 185,
        "end": 354,
        "startLoc": {
          "line": 185,
          "column": 17,
          "position": 1898
        },
        "endLoc": {
          "line": 354,
          "column": 6,
          "position": 3720
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        auth: mockAuthQuery,\r\n        rpc: mockRpc,\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toEqual([]);\r\n    });\r\n\r\n    it('should return empty services when category info not found'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 573,
        "end": 585,
        "startLoc": {
          "line": 573,
          "column": 2,
          "position": 6107
        },
        "endLoc": {
          "line": 585,
          "column": 60,
          "position": 6207
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 42,
        "end": 79,
        "startLoc": {
          "line": 42,
          "column": 2,
          "position": 520
        },
        "endLoc": {
          "line": 79,
          "column": 59,
          "position": 904
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ", error: null }),\r\n            };\r\n          }\r\n\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n          };\r\n        }),\r\n      });\r\n\r\n      vi.mocked(createClient).mockResolvedValue(\r\n        createMockQueries() as unknown as Awaited<ReturnType<typeof createClient>>\r\n      );\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result.",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 607,
        "end": 626,
        "startLoc": {
          "line": 607,
          "column": 5,
          "position": 6489
        },
        "endLoc": {
          "line": 626,
          "column": 2,
          "position": 6672
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 211,
        "end": 563,
        "startLoc": {
          "line": 211,
          "column": 12,
          "position": 2190
        },
        "endLoc": {
          "line": 563,
          "column": 2,
          "position": 5966
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": ", async () => {\r\n      const mockUser = { id: 'user-123', email: 'user@test.com' };\r\n\r\n      const mockTopCategories = [\r\n        {\r\n          category_id: 'cat-1',\r\n          category_name: 'Category',\r\n          category_slug: 'category',\r\n          visit_count: 5,\r\n        },\r\n      ];\r\n\r\n      const mockCategoryInfo = {\r\n        id: 'cat-1',\r\n        name: 'Category',\r\n        slug: 'category',\r\n        level: 1,\r\n        parent_id: null,\r\n      };\r\n\r\n      const mockServices",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 630,
        "end": 650,
        "startLoc": {
          "line": 630,
          "column": 56,
          "position": 6714
        },
        "endLoc": {
          "line": 650,
          "column": 13,
          "position": 6870
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 452,
        "end": 472,
        "startLoc": {
          "line": 452,
          "column": 42,
          "position": 4773
        },
        "endLoc": {
          "line": 472,
          "column": 16,
          "position": 4929
        }
      }
    },
    {
      "format": "typescript",
      "lines": 30,
      "fragment": "];\r\n\r\n      let categoryCallCount = 0;\r\n\r\n      const createMockQueries = () => ({\r\n        auth: {\r\n          getUser: vi.fn().mockResolvedValue({ data: { user: mockUser }, error: null }),\r\n        },\r\n        rpc: vi.fn().mockResolvedValue({ data: mockTopCategories, error: null }),\r\n        from: vi.fn((table: string) => {\r\n          if (table === 'categories') {\r\n            categoryCallCount++;\r\n            if (categoryCallCount === 1) {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                eq: vi.fn().mockReturnThis(),\r\n                single: vi.fn().mockResolvedValue({ data: mockCategoryInfo, error: null }),\r\n              };\r\n            } else if (categoryCallCount === 2) {\r\n              return {\r\n                select: vi.fn().mockReturnThis(),\r\n                eq: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n              };\r\n            }\r\n          }\r\n\r\n          if (table === 'advertising_subscriptions') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockResolvedValue({ data: [",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 667,
        "end": 696,
        "startLoc": {
          "line": 667,
          "column": 7,
          "position": 7052
        },
        "endLoc": {
          "line": 696,
          "column": 2,
          "position": 7432
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 276,
        "end": 526,
        "startLoc": {
          "line": 276,
          "column": 2,
          "position": 2846
        },
        "endLoc": {
          "line": 526,
          "column": 16,
          "position": 5564
        }
      }
    },
    {
      "format": "typescript",
      "lines": 38,
      "fragment": ", error: null }),\r\n            };\r\n          }\r\n\r\n          if (table === 'services') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              in: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockReturnThis(),\r\n              order: vi.fn().mockReturnThis(),\r\n              limit: vi.fn().mockResolvedValue({ data: mockServices, error: null }),\r\n            };\r\n          }\r\n\r\n          if (table === 'reviews') {\r\n            return {\r\n              select: vi.fn().mockReturnThis(),\r\n              in: vi.fn().mockReturnThis(),\r\n              eq: vi.fn().mockResolvedValue({ data: mockReviews, error: null }),\r\n            };\r\n          }\r\n\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n          };\r\n        }),\r\n      });\r\n\r\n      vi.mocked(createClient).mockResolvedValue(\r\n        createMockQueries() as unknown as Awaited<ReturnType<typeof createClient>>\r\n      );\r\n\r\n      const result = await getPersonalizedServicesByInterest();\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result[0].services[",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 696,
        "end": 733,
        "startLoc": {
          "line": 696,
          "column": 2,
          "position": 7434
        },
        "endLoc": {
          "line": 733,
          "column": 2,
          "position": 7840
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 193,
        "end": 563,
        "startLoc": {
          "line": 193,
          "column": 16,
          "position": 1972
        },
        "endLoc": {
          "line": 563,
          "column": 2,
          "position": 5971
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n    });\r\n\r\n    it('should throw error when query fails', async () => {\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: null, error: new Error('Query failed') }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(mockQuery);\r\n\r\n      await expect(getBuyerOrders",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\orders.test.ts",
        "start": 65,
        "end": 77,
        "startLoc": {
          "line": 65,
          "column": 11,
          "position": 669
        },
        "endLoc": {
          "line": 77,
          "column": 15,
          "position": 800
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\reviews.test.ts",
        "start": 99,
        "end": 111,
        "startLoc": {
          "line": 99,
          "column": 12,
          "position": 1057
        },
        "endLoc": {
          "line": 111,
          "column": 17,
          "position": 1188
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "];\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: mockOrders, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(mockQuery);\r\n\r\n      const result = await getSellerOrders",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\orders.test.ts",
        "start": 83,
        "end": 93,
        "startLoc": {
          "line": 83,
          "column": 2,
          "position": 887
        },
        "endLoc": {
          "line": 93,
          "column": 16,
          "position": 995
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\orders.test.ts",
        "start": 29,
        "end": 39,
        "startLoc": {
          "line": 29,
          "column": 7,
          "position": 273
        },
        "endLoc": {
          "line": 39,
          "column": 15,
          "position": 381
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "}),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getBuyerDashboardStats('buyer-123');\r\n\r\n      expect(result.inProgressOrders).toBe(0);\r\n      expect(result.deliveredOrders).toBe(0);\r\n      expect(result.pendingReviews).toBe(0);\r\n      expect(result.monthlyPurchases).toBe(0);\r\n    });\r\n\r\n    it('should calculate monthly purchases correctly'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 90,
        "end": 105,
        "startLoc": {
          "line": 90,
          "column": 2,
          "position": 910
        },
        "endLoc": {
          "line": 105,
          "column": 47,
          "position": 1065
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 52,
        "end": 85,
        "startLoc": {
          "line": 52,
          "column": 2,
          "position": 449
        },
        "endLoc": {
          "line": 85,
          "column": 43,
          "position": 826
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "},\r\n      ];\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: mockOrders, error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getBuyerDashboardStats('buyer-123');\r\n\r\n      expect(result.monthlyPurchases",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 125,
        "end": 139,
        "startLoc": {
          "line": 125,
          "column": 9,
          "position": 1247
        },
        "endLoc": {
          "line": 139,
          "column": 17,
          "position": 1398
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 47,
        "end": 61,
        "startLoc": {
          "line": 47,
          "column": 9,
          "position": 387
        },
        "endLoc": {
          "line": 61,
          "column": 17,
          "position": 538
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "}),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getBuyerRecentOrders('buyer-123');\r\n\r\n      expect(result).toEqual([]);\r\n    });\r\n\r\n    it('should respect the limit parameter'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 208,
        "end": 220,
        "startLoc": {
          "line": 208,
          "column": 2,
          "position": 2173
        },
        "endLoc": {
          "line": 220,
          "column": 37,
          "position": 2282
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 188,
        "end": 200,
        "startLoc": {
          "line": 188,
          "column": 2,
          "position": 1932
        },
        "endLoc": {
          "line": 200,
          "column": 34,
          "position": 2041
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", async () => {\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        in: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      await",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 220,
        "end": 233,
        "startLoc": {
          "line": 220,
          "column": 37,
          "position": 2283
        },
        "endLoc": {
          "line": 233,
          "column": 6,
          "position": 2462
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 182,
        "end": 77,
        "startLoc": {
          "line": 182,
          "column": 49,
          "position": 1820
        },
        "endLoc": {
          "line": 77,
          "column": 6,
          "position": 738
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "}),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getBuyerRecentFavorites('buyer-123');\r\n\r\n      expect(result).toEqual([]);\r\n    });\r\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 297,
        "end": 308,
        "startLoc": {
          "line": 297,
          "column": 2,
          "position": 3186
        },
        "endLoc": {
          "line": 308,
          "column": 2,
          "position": 3291
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 278,
        "end": 290,
        "startLoc": {
          "line": 278,
          "column": 2,
          "position": 2961
        },
        "endLoc": {
          "line": 290,
          "column": 3,
          "position": 3068
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "},\r\n      ];\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: mockOrders, error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getSellerDashboardStats",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 349,
        "end": 361,
        "startLoc": {
          "line": 349,
          "column": 9,
          "position": 3669
        },
        "endLoc": {
          "line": 361,
          "column": 24,
          "position": 3806
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 47,
        "end": 59,
        "startLoc": {
          "line": 47,
          "column": 9,
          "position": 387
        },
        "endLoc": {
          "line": 59,
          "column": 23,
          "position": 524
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "});\r\n\r\n    it('should return zero stats when no orders exist', async () => {\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getSellerDashboardStats",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 368,
        "end": 380,
        "startLoc": {
          "line": 368,
          "column": 5,
          "position": 3893
        },
        "endLoc": {
          "line": 380,
          "column": 24,
          "position": 4043
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 65,
        "end": 77,
        "startLoc": {
          "line": 65,
          "column": 5,
          "position": 596
        },
        "endLoc": {
          "line": 77,
          "column": 23,
          "position": 746
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "};\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: null, error: mockError }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getSellerDashboardStats",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 390,
        "end": 401,
        "startLoc": {
          "line": 390,
          "column": 2,
          "position": 4165
        },
        "endLoc": {
          "line": 401,
          "column": 24,
          "position": 4297
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 86,
        "end": 97,
        "startLoc": {
          "line": 86,
          "column": 2,
          "position": 853
        },
        "endLoc": {
          "line": 97,
          "column": 23,
          "position": 985
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "}),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getSellerDashboardStats('seller-123');\r\n\r\n      expect(result.newOrders).toBe(0);\r\n      expect(result.inProgressOrders).toBe(0);\r\n      expect(result.deliveredOrders).toBe(0);\r\n      expect(result.completedOrders).toBe(0);\r\n      expect(result.monthlyRevenue).toBe(0);\r\n    });\r\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 394,
        "end": 409,
        "startLoc": {
          "line": 394,
          "column": 2,
          "position": 4222
        },
        "endLoc": {
          "line": 409,
          "column": 2,
          "position": 4388
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 354,
        "end": 389,
        "startLoc": {
          "line": 354,
          "column": 2,
          "position": 3731
        },
        "endLoc": {
          "line": 389,
          "column": 3,
          "position": 4136
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ",\r\n            profile_image: 'profile.jpg',\r\n          },\r\n        },\r\n      ];\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        in: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: mockData, error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      const result = await getSellerRecentOrders",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 425,
        "end": 443,
        "startLoc": {
          "line": 425,
          "column": 13,
          "position": 4519
        },
        "endLoc": {
          "line": 443,
          "column": 22,
          "position": 4721
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 157,
        "end": 175,
        "startLoc": {
          "line": 157,
          "column": 14,
          "position": 1546
        },
        "endLoc": {
          "line": 175,
          "column": 21,
          "position": 1748
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", async () => {\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        in: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      await getSellerRecentOrders",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 450,
        "end": 463,
        "startLoc": {
          "line": 450,
          "column": 36,
          "position": 4798
        },
        "endLoc": {
          "line": 463,
          "column": 22,
          "position": 4979
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 182,
        "end": 233,
        "startLoc": {
          "line": 182,
          "column": 49,
          "position": 1820
        },
        "endLoc": {
          "line": 233,
          "column": 21,
          "position": 2464
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      const mockError = { message: 'Query failed' };\r\n\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        in: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: null, error: mockError }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      await",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 468,
        "end": 483,
        "startLoc": {
          "line": 468,
          "column": 38,
          "position": 5029
        },
        "endLoc": {
          "line": 483,
          "column": 6,
          "position": 5227
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 200,
        "end": 97,
        "startLoc": {
          "line": 200,
          "column": 34,
          "position": 2042
        },
        "endLoc": {
          "line": 97,
          "column": 6,
          "position": 977
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ");\r\n    });\r\n\r\n    it('should respect the limit parameter', async () => {\r\n      const mockQuery = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        in: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n      };\r\n\r\n      vi.mocked(createClient).mockResolvedValue({\r\n        from: vi.fn(() => mockQuery),\r\n      } as unknown as Awaited<ReturnType<typeof createClient>>);\r\n\r\n      await getSellerRecentOrders('seller-123', 10",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 483,
        "end": 499,
        "startLoc": {
          "line": 483,
          "column": 10,
          "position": 5242
        },
        "endLoc": {
          "line": 499,
          "column": 3,
          "position": 5444
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\dashboard.test.ts",
        "start": 217,
        "end": 463,
        "startLoc": {
          "line": 217,
          "column": 2,
          "position": 2267
        },
        "endLoc": {
          "line": 463,
          "column": 2,
          "position": 4984
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ";\r\n\r\n    const mockBuilder: MockQueryBuilder = {\r\n      select: vi.fn(function (this: MockQueryBuilder) {\r\n        return this;\r\n      }),\r\n      eq: vi.fn(function (this: MockQueryBuilder) {\r\n        return this;\r\n      }),\r\n      gte: vi.fn(function (this: MockQueryBuilder) {\r\n        return this;\r\n      }),\r\n      order: vi.fn(() => Promise.resolve({ data: null",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\coupons.test.ts",
        "start": 50,
        "end": 62,
        "startLoc": {
          "line": 50,
          "column": 2,
          "position": 534
        },
        "endLoc": {
          "line": 62,
          "column": 5,
          "position": 673
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\coupons.test.ts",
        "start": 26,
        "end": 38,
        "startLoc": {
          "line": 26,
          "column": 2,
          "position": 254
        },
        "endLoc": {
          "line": 38,
          "column": 9,
          "position": 393
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "const mockBuilder: MockQueryBuilder = {\r\n      select: vi.fn(function (this: MockQueryBuilder) {\r\n        return this;\r\n      }),\r\n      eq: vi.fn(function (this: MockQueryBuilder) {\r\n        return this;\r\n      }),\r\n      gte: vi.fn(function (this: MockQueryBuilder) {\r\n        return this;\r\n      }),\r\n      order: vi.fn(() => Promise.resolve({ data: [",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\coupons.test.ts",
        "start": 73,
        "end": 83,
        "startLoc": {
          "line": 73,
          "column": 5,
          "position": 791
        },
        "endLoc": {
          "line": 83,
          "column": 2,
          "position": 924
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\coupons.test.ts",
        "start": 28,
        "end": 38,
        "startLoc": {
          "line": 28,
          "column": 5,
          "position": 260
        },
        "endLoc": {
          "line": 38,
          "column": 9,
          "position": 393
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        gte: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: mockVisits, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await getRecentVisitedCategories(5",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\category-visits.test.ts",
        "start": 135,
        "end": 146,
        "startLoc": {
          "line": 135,
          "column": 2,
          "position": 1372
        },
        "endLoc": {
          "line": 146,
          "column": 2,
          "position": 1498
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\category-visits.test.ts",
        "start": 90,
        "end": 76,
        "startLoc": {
          "line": 90,
          "column": 2,
          "position": 844
        },
        "endLoc": {
          "line": 76,
          "column": 2,
          "position": 685
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "};\r\n\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockReview, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      const result = await createReviewReply",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\reviews.test.ts",
        "start": 164,
        "end": 175,
        "startLoc": {
          "line": 164,
          "column": 7,
          "position": 1694
        },
        "endLoc": {
          "line": 175,
          "column": 18,
          "position": 1818
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\reviews.test.ts",
        "start": 81,
        "end": 92,
        "startLoc": {
          "line": 81,
          "column": 2,
          "position": 792
        },
        "endLoc": {
          "line": 92,
          "column": 13,
          "position": 916
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "};\r\n\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      const result = await requestRevision",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 62,
        "end": 73,
        "startLoc": {
          "line": 62,
          "column": 2,
          "position": 639
        },
        "endLoc": {
          "line": 73,
          "column": 16,
          "position": 763
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\reviews.test.ts",
        "start": 81,
        "end": 36,
        "startLoc": {
          "line": 81,
          "column": 2,
          "position": 792
        },
        "endLoc": {
          "line": 36,
          "column": 13,
          "position": 348
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\r\n        })\r\n      );\r\n    });\r\n\r\n    it('should throw error on database failure', async () => {\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      await expect(requestRevision",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 80,
        "end": 95,
        "startLoc": {
          "line": 80,
          "column": 24,
          "position": 831
        },
        "endLoc": {
          "line": 95,
          "column": 16,
          "position": 989
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 41,
        "end": 56,
        "startLoc": {
          "line": 41,
          "column": 12,
          "position": 397
        },
        "endLoc": {
          "line": 56,
          "column": 13,
          "position": 555
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "};\r\n\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      const result = await cancelOrder",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 101,
        "end": 112,
        "startLoc": {
          "line": 101,
          "column": 2,
          "position": 1076
        },
        "endLoc": {
          "line": 112,
          "column": 12,
          "position": 1200
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\reviews.test.ts",
        "start": 81,
        "end": 36,
        "startLoc": {
          "line": 81,
          "column": 2,
          "position": 792
        },
        "endLoc": {
          "line": 36,
          "column": 13,
          "position": 348
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\r\n    });\r\n\r\n    it('should throw error on database failure', async () => {\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      await expect(cancelOrder",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 115,
        "end": 128,
        "startLoc": {
          "line": 115,
          "column": 15,
          "position": 1238
        },
        "endLoc": {
          "line": 128,
          "column": 12,
          "position": 1387
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 43,
        "end": 56,
        "startLoc": {
          "line": 43,
          "column": 7,
          "position": 406
        },
        "endLoc": {
          "line": 56,
          "column": 13,
          "position": 555
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "};\r\n\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      const result = await updateOrderStatus",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 134,
        "end": 145,
        "startLoc": {
          "line": 134,
          "column": 2,
          "position": 1468
        },
        "endLoc": {
          "line": 145,
          "column": 18,
          "position": 1592
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\reviews.test.ts",
        "start": 81,
        "end": 36,
        "startLoc": {
          "line": 81,
          "column": 2,
          "position": 792
        },
        "endLoc": {
          "line": 36,
          "column": 13,
          "position": 348
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\r\n    });\r\n\r\n    it('should throw error on database failure', async () => {\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      await expect(updateOrderStatus",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 148,
        "end": 161,
        "startLoc": {
          "line": 148,
          "column": 2,
          "position": 1637
        },
        "endLoc": {
          "line": 161,
          "column": 18,
          "position": 1786
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\mutations\\orders.test.ts",
        "start": 43,
        "end": 56,
        "startLoc": {
          "line": 43,
          "column": 7,
          "position": 406
        },
        "endLoc": {
          "line": 56,
          "column": 13,
          "position": 555
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\r\n  try {\r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Authentication failed' }, { status: 401 });\r\n    }\r\n\r\n    const { id: portfolioId } = await params;\r\n    const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\seller\\portfolio\\[id]\\route.ts",
        "start": 47,
        "end": 60,
        "startLoc": {
          "line": 47,
          "column": 4,
          "position": 527
        },
        "endLoc": {
          "line": 60,
          "column": 6,
          "position": 704
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\portfolio\\[id]\\route.ts",
        "start": 8,
        "end": 25,
        "startLoc": {
          "line": 8,
          "column": 7,
          "position": 85
        },
        "endLoc": {
          "line": 25,
          "column": 16,
          "position": 271
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "const { data: seller } = await serviceSupabase\n      .from('sellers')\n      .select('id')\n      .eq('user_id', user.id)\n      .single();\n\n    if (!seller) {\n      return NextResponse.json({ error: 'Seller not found' }, { status: 404 });\n    }\n\n    // Upload receipt image if provided",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\seller\\advertising\\bank-transfer\\route.ts",
        "start": 50,
        "end": 60,
        "startLoc": {
          "line": 50,
          "column": 5,
          "position": 547
        },
        "endLoc": {
          "line": 60,
          "column": 36,
          "position": 641
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\advertising\\dashboard\\route.ts",
        "start": 20,
        "end": 30,
        "startLoc": {
          "line": 20,
          "column": 5,
          "position": 204
        },
        "endLoc": {
          "line": 30,
          "column": 24,
          "position": 308
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "(paymentId: string) {\r\n  const apiSecret = process.env.PORTONE_API_SECRET;\r\n  if (!apiSecret) {\r\n    throw new Error('PortOne API Secret  ');\r\n  }\r\n\r\n  const response = await fetch(`https://api.portone.io/payments/${encodeURIComponent(paymentId)}`, {\r\n    method: 'GET',\r\n    headers: {\r\n      Authorization: `PortOne ${apiSecret}`,\r\n    }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\advertising\\verify\\route.ts",
        "start": 7,
        "end": 17,
        "startLoc": {
          "line": 7,
          "column": 18,
          "position": 71
        },
        "endLoc": {
          "line": 17,
          "column": 2,
          "position": 177
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\webhook\\portone\\payment\\route.ts",
        "start": 12,
        "end": 22,
        "startLoc": {
          "line": 12,
          "column": 15,
          "position": 93
        },
        "endLoc": {
          "line": 22,
          "column": 15,
          "position": 199
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ") {\r\n  try {\r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Authentication failed' }, { status: 401 });\r\n    }\r\n\r\n    const body",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\advertising\\verify\\route.ts",
        "start": 30,
        "end": 42,
        "startLoc": {
          "line": 30,
          "column": 12,
          "position": 302
        },
        "endLoc": {
          "line": 42,
          "column": 5,
          "position": 429
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\portfolio\\[id]\\route.ts",
        "start": 11,
        "end": 23,
        "startLoc": {
          "line": 11,
          "column": 1,
          "position": 124
        },
        "endLoc": {
          "line": 23,
          "column": 2,
          "position": 251
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "export async function POST(request: NextRequest) {\r\n  try {\r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) return authResult.error;\r\n\r\n    const { supabase, user } = authResult;\r\n    if (!supabase || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { service_id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\advertising\\prepare\\route.ts",
        "start": 5,
        "end": 16,
        "startLoc": {
          "line": 5,
          "column": 1,
          "position": 47
        },
        "endLoc": {
          "line": 16,
          "column": 11,
          "position": 196
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 19,
        "startLoc": {
          "line": 8,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 19,
          "column": 9,
          "position": 186
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Authentication failed' }, { status: 401 });\r\n    }\r\n\r\n    const { status",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\status\\route.ts",
        "start": 44,
        "end": 54,
        "startLoc": {
          "line": 44,
          "column": 21,
          "position": 367
        },
        "endLoc": {
          "line": 54,
          "column": 7,
          "position": 474
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\portfolio\\[id]\\route.ts",
        "start": 13,
        "end": 23,
        "startLoc": {
          "line": 13,
          "column": 2,
          "position": 146
        },
        "endLoc": {
          "line": 23,
          "column": 3,
          "position": 253
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "}, { status: 400 });\r\n    }\r\n\r\n    //     \r\n    const { data: order, error: fetchError } = await supabase\r\n      .from('orders')\r\n      .select('*')\r\n      .eq('id', id)\r\n      .single();\r\n\r\n    if (fetchError || !order) {\r\n      return NextResponse.json({ error: '   ' }, { status: 404 });\r\n    }\r\n\r\n    //    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\revision\\route.ts",
        "start": 20,
        "end": 34,
        "startLoc": {
          "line": 20,
          "column": 2,
          "position": 281
        },
        "endLoc": {
          "line": 34,
          "column": 17,
          "position": 419
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\status\\route.ts",
        "start": 72,
        "end": 86,
        "startLoc": {
          "line": 72,
          "column": 2,
          "position": 639
        },
        "endLoc": {
          "line": 86,
          "column": 9,
          "position": 777
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "const { data: order, error: fetchError } = await supabase\r\n      .from('orders')\r\n      .select('*')\r\n      .eq('id', id)\r\n      .single();\r\n\r\n    if (fetchError || !order) {\r\n      return NextResponse.json({ error: '   ' }, { status: 404 });\r\n    }\r\n\r\n    //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\confirm\\route.ts",
        "start": 38,
        "end": 48,
        "startLoc": {
          "line": 38,
          "column": 5,
          "position": 361
        },
        "endLoc": {
          "line": 48,
          "column": 13,
          "position": 473
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\status\\route.ts",
        "start": 76,
        "end": 86,
        "startLoc": {
          "line": 76,
          "column": 5,
          "position": 665
        },
        "endLoc": {
          "line": 86,
          "column": 9,
          "position": 777
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "});\r\n    }\r\n\r\n    //     \r\n    const { data: order, error: fetchError } = await supabase\r\n      .from('orders')\r\n      .select('*')\r\n      .eq('id', id)\r\n      .single();\r\n\r\n    if (fetchError || !order) {\r\n      return NextResponse.json({ error: '   ' }, { status: 404 });\r\n    }\r\n\r\n    //    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\complete-revision\\route.ts",
        "start": 18,
        "end": 32,
        "startLoc": {
          "line": 18,
          "column": 2,
          "position": 225
        },
        "endLoc": {
          "line": 32,
          "column": 17,
          "position": 353
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\status\\route.ts",
        "start": 72,
        "end": 86,
        "startLoc": {
          "line": 72,
          "column": 2,
          "position": 649
        },
        "endLoc": {
          "line": 86,
          "column": 9,
          "position": 777
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\r\n  try {\r\n    const { id } = await params;\r\n\r\n    //    Rate Limiting \r\n    const authResult = await requireAuthWithRateLimit(orderStatusRateLimit);\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Authentication failed' }, { status: 401 });\r\n    }\r\n\r\n    const { cancel_reason",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\cancel\\route.ts",
        "start": 50,
        "end": 65,
        "startLoc": {
          "line": 50,
          "column": 5,
          "position": 488
        },
        "endLoc": {
          "line": 65,
          "column": 14,
          "position": 673
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\status\\route.ts",
        "start": 39,
        "end": 23,
        "startLoc": {
          "line": 39,
          "column": 6,
          "position": 289
        },
        "endLoc": {
          "line": 23,
          "column": 3,
          "position": 253
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ")\r\n      .eq('id', id)\r\n      .single();\r\n\r\n    if (fetchError || !order) {\r\n      return NextResponse.json({ error: '   ' }, { status: 404 });\r\n    }\r\n\r\n    //   \r\n    if (order.buyer_id !== user.id) {\r\n      return NextResponse.json({ error: ' '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\cancel\\route.ts",
        "start": 75,
        "end": 85,
        "startLoc": {
          "line": 75,
          "column": 17,
          "position": 807
        },
        "endLoc": {
          "line": 85,
          "column": 11,
          "position": 915
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\confirm\\route.ts",
        "start": 40,
        "end": 50,
        "startLoc": {
          "line": 40,
          "column": 4,
          "position": 398
        },
        "endLoc": {
          "line": 50,
          "column": 22,
          "position": 506
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "export async function PATCH(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\n  try {\n    const { id } = await params;\n\n    //   \n    const authResult = await requireAuth();\n    if (!authResult.success) {\n      return authResult.error!;\n    }\n\n    const { user, supabase } = authResult;\n    if (!user || !supabase) {\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n\n    //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\notifications\\[id]\\read\\route.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 45
        },
        "endLoc": {
          "line": 21,
          "column": 12,
          "position": 217
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\complete-revision\\route.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 50
        },
        "endLoc": {
          "line": 21,
          "column": 17,
          "position": 237
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": "} = await params;\n    const supabase = await createClient();\n\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    //   profile.id \n    const { data: userProfile } = await supabase\n      .from('profiles')\n      .select('id')\n      .eq('user_id', user.id)\n      .single();\n\n    if",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\chat\\route.ts",
        "start": 64,
        "end": 82,
        "startLoc": {
          "line": 64,
          "column": 2,
          "position": 525
        },
        "endLoc": {
          "line": 82,
          "column": 3,
          "position": 680
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\applications\\[appId]\\route.ts",
        "start": 87,
        "end": 105,
        "startLoc": {
          "line": 87,
          "column": 2,
          "position": 710
        },
        "endLoc": {
          "line": 105,
          "column": 18,
          "position": 883
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "(request: NextRequest, { params }: RouteParams) {\n  try {\n    const { id } = await params;\n    const supabase = await createClient();\n\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\chat\\route.ts",
        "start": 160,
        "end": 173,
        "startLoc": {
          "line": 160,
          "column": 5,
          "position": 1394
        },
        "endLoc": {
          "line": 173,
          "column": 6,
          "position": 1525
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\chat\\route.ts",
        "start": 62,
        "end": 98,
        "startLoc": {
          "line": 62,
          "column": 4,
          "position": 494
        },
        "endLoc": {
          "line": 98,
          "column": 25,
          "position": 821
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "const { data: errand } = await supabase\n      .from('errands')\n      .select('requester_id, helper_id, status, title')\n      .eq('id', id)\n      .single();\n\n    if (!errand) {\n      return NextResponse.json({ error: '   ' }, { status: 404 });\n    }\n\n    const {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\chat\\route.ts",
        "start": 178,
        "end": 188,
        "startLoc": {
          "line": 178,
          "column": 5,
          "position": 1587
        },
        "endLoc": {
          "line": 188,
          "column": 2,
          "position": 1681
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\chat\\route.ts",
        "start": 87,
        "end": 97,
        "startLoc": {
          "line": 87,
          "column": 5,
          "position": 725
        },
        "endLoc": {
          "line": 97,
          "column": 12,
          "position": 819
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "();\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Authentication failed' }, { status: 401 });\r\n    }\r\n\r\n    //   profile.id ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\applications\\route.ts",
        "start": 69,
        "end": 79,
        "startLoc": {
          "line": 69,
          "column": 13,
          "position": 652
        },
        "endLoc": {
          "line": 79,
          "column": 25,
          "position": 756
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\portfolio\\[id]\\route.ts",
        "start": 13,
        "end": 23,
        "startLoc": {
          "line": 13,
          "column": 12,
          "position": 145
        },
        "endLoc": {
          "line": 23,
          "column": 6,
          "position": 249
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": "export async function POST(request: NextRequest, { params }: RouteParams) {\r\n  try {\r\n    const { id } = await params;\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    //   \r\n    const { data: helperProfile } = await supabase\r\n      .from('helper_profiles')\r\n      .select('*'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\applications\\route.ts",
        "start": 163,
        "end": 179,
        "startLoc": {
          "line": 163,
          "column": 1,
          "position": 1414
        },
        "endLoc": {
          "line": 179,
          "column": 4,
          "position": 1599
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\chat\\route.ts",
        "start": 160,
        "end": 190,
        "startLoc": {
          "line": 160,
          "column": 1,
          "position": 1387
        },
        "endLoc": {
          "line": 190,
          "column": 5,
          "position": 1864
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\n    if (!supabaseUrl || !supabaseServiceKey) {\r\n      return NextResponse.json({ error: '  ' }, { status: 500 });\r\n    }\r\n\r\n    const supabaseAdmin = createClient(supabaseUrl, supabaseServiceKey, {\r\n      auth: { autoRefreshToken: false, persistSession: false },\r\n    });\r\n\r\n    //    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\users\\[userId]\\route.ts",
        "start": 111,
        "end": 122,
        "startLoc": {
          "line": 111,
          "column": 5,
          "position": 1440
        },
        "endLoc": {
          "line": 122,
          "column": 17,
          "position": 1570
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\services\\[serviceId]\\route.ts",
        "start": 166,
        "end": 177,
        "startLoc": {
          "line": 166,
          "column": 5,
          "position": 1721
        },
        "endLoc": {
          "line": 177,
          "column": 15,
          "position": 1851
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "}\n\nexport async function GET() {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = await createClient();\n\n    // KST    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\analytics\\realtime\\route.ts",
        "start": 20,
        "end": 34,
        "startLoc": {
          "line": 20,
          "column": 1,
          "position": 211
        },
        "endLoc": {
          "line": 34,
          "column": 19,
          "position": 326
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\referrers\\route.ts",
        "start": 20,
        "end": 34,
        "startLoc": {
          "line": 20,
          "column": 1,
          "position": 161
        },
        "endLoc": {
          "line": 34,
          "column": 35,
          "position": 276
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ") {\r\n  try {\r\n    const adminCheck = await checkAdminAuth();\r\n    if (!adminCheck.isAdmin) {\r\n      return NextResponse.json(\r\n        { error: adminCheck.error },\r\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\r\n      );\r\n    }\r\n\r\n    const {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 43,
        "startLoc": {
          "line": 33,
          "column": 12,
          "position": 359
        },
        "endLoc": {
          "line": 43,
          "column": 2,
          "position": 460
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\referrers\\route.ts",
        "start": 22,
        "end": 32,
        "startLoc": {
          "line": 22,
          "column": 2,
          "position": 172
        },
        "endLoc": {
          "line": 32,
          "column": 9,
          "position": 263
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "export async function GET(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = await createClient();\n    const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\statistics\\route.ts",
        "start": 174,
        "end": 185,
        "startLoc": {
          "line": 174,
          "column": 1,
          "position": 1510
        },
        "endLoc": {
          "line": 185,
          "column": 6,
          "position": 1625
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 34,
        "startLoc": {
          "line": 33,
          "column": 1,
          "position": 347
        },
        "endLoc": {
          "line": 34,
          "column": 35,
          "position": 276
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "export async function GET(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = createServiceRoleClient",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\payments\\route.ts",
        "start": 9,
        "end": 19,
        "startLoc": {
          "line": 9,
          "column": 1,
          "position": 73
        },
        "endLoc": {
          "line": 19,
          "column": 24,
          "position": 180
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 32,
        "startLoc": {
          "line": 33,
          "column": 1,
          "position": 347
        },
        "endLoc": {
          "line": 32,
          "column": 6,
          "position": 267
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = createServiceRoleClient();\n    const body",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\payments\\route.ts",
        "start": 303,
        "end": 314,
        "startLoc": {
          "line": 303,
          "column": 6,
          "position": 2681
        },
        "endLoc": {
          "line": 314,
          "column": 5,
          "position": 2789
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 20,
        "startLoc": {
          "line": 33,
          "column": 4,
          "position": 354
        },
        "endLoc": {
          "line": 20,
          "column": 2,
          "position": 188
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function GET(request: NextRequest) {\r\n  try {\r\n    const adminCheck = await checkAdminAuth();\r\n    if (!adminCheck.isAdmin) {\r\n      return NextResponse.json(\r\n        { error: adminCheck.error },\r\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\r\n      );\r\n    }\r\n\r\n    const supabase = await createClient();\r\n    const { searchParams } = new URL(request.url);\r\n    const sellerId",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\credits\\route.ts",
        "start": 7,
        "end": 19,
        "startLoc": {
          "line": 7,
          "column": 1,
          "position": 64
        },
        "endLoc": {
          "line": 19,
          "column": 9,
          "position": 214
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 187,
        "startLoc": {
          "line": 33,
          "column": 1,
          "position": 347
        },
        "endLoc": {
          "line": 187,
          "column": 7,
          "position": 1649
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "(request: NextRequest) {\r\n  try {\r\n    const adminCheck = await checkAdminAuth();\r\n    if (!adminCheck.isAdmin) {\r\n      return NextResponse.json(\r\n        { error: adminCheck.error },\r\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\r\n      );\r\n    }\r\n\r\n    const supabase = await createClient();\r\n    const body",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\credits\\route.ts",
        "start": 86,
        "end": 97,
        "startLoc": {
          "line": 86,
          "column": 5,
          "position": 832
        },
        "endLoc": {
          "line": 97,
          "column": 5,
          "position": 953
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 185,
        "startLoc": {
          "line": 33,
          "column": 4,
          "position": 354
        },
        "endLoc": {
          "line": 185,
          "column": 2,
          "position": 1627
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function PATCH(request: NextRequest) {\r\n  try {\r\n    const adminCheck = await checkAdminAuth();\r\n    if (!adminCheck.isAdmin) {\r\n      return NextResponse.json(\r\n        { error: adminCheck.error },\r\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\r\n      );\r\n    }\r\n\r\n    const supabase = await createClient();\r\n    const body = await request.json();\r\n    const { sellerId, amount, description }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\credits\\route.ts",
        "start": 172,
        "end": 184,
        "startLoc": {
          "line": 172,
          "column": 1,
          "position": 1698
        },
        "endLoc": {
          "line": 184,
          "column": 2,
          "position": 1853
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\advertising\\payments\\route.ts",
        "start": 303,
        "end": 98,
        "startLoc": {
          "line": 303,
          "column": 1,
          "position": 2674
        },
        "endLoc": {
          "line": 98,
          "column": 2,
          "position": 979
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", () => {\r\n      // @ts-expect-error - Mocking server environment\r\n      delete global.window;\r\n\r\n      const client1 = SupabaseManager.getServiceRoleClient();\r\n      SupabaseManager.resetClients();\r\n      const client2 = SupabaseManager.getServiceRoleClient();\r\n\r\n      expect(client1).not.toBe(client2);\r\n    });\r\n\r\n    it('should not throw when called multiple times'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\auth\\singleton.test.ts",
        "start": 352,
        "end": 363,
        "startLoc": {
          "line": 352,
          "column": 30,
          "position": 3327
        },
        "endLoc": {
          "line": 363,
          "column": 46,
          "position": 3419
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\auth\\singleton.test.ts",
        "start": 322,
        "end": 333,
        "startLoc": {
          "line": 322,
          "column": 39,
          "position": 3059
        },
        "endLoc": {
          "line": 333,
          "column": 57,
          "position": 3151
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n    });\r\n\r\n    it('should call handler with user when authenticated', async () => {\r\n      const mockUser = { id: 'user-1', email: 'test@example.com' };\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: mockUser },\r\n        error: null,\r\n      });\r\n\r\n      const handler = vi.fn().mockResolvedValue(NextResponse.json({ authenticated",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\api\\auth-middleware.test.ts",
        "start": 92,
        "end": 102,
        "startLoc": {
          "line": 92,
          "column": 5,
          "position": 1030
        },
        "endLoc": {
          "line": 102,
          "column": 14,
          "position": 1146
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\api\\auth-middleware.test.ts",
        "start": 37,
        "end": 47,
        "startLoc": {
          "line": 37,
          "column": 2,
          "position": 394
        },
        "endLoc": {
          "line": 47,
          "column": 8,
          "position": 510
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Users Profile API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\users\\profile.test.ts",
        "start": 25,
        "end": 36,
        "startLoc": {
          "line": 25,
          "column": 18,
          "position": 274
        },
        "endLoc": {
          "line": 36,
          "column": 20,
          "position": 360
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 10,
        "end": 25,
        "startLoc": {
          "line": 10,
          "column": 2,
          "position": 110
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/users/profile', {\r\n        method: 'PATCH',\r\n        body: JSON.stringify({ name: 'New Name' }),\r\n      });\r\n\r\n      const response = await PATCH(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\users\\profile.test.ts",
        "start": 87,
        "end": 98,
        "startLoc": {
          "line": 87,
          "column": 5,
          "position": 916
        },
        "endLoc": {
          "line": 98,
          "column": 4,
          "position": 1025
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\users\\profile.test.ts",
        "start": 48,
        "end": 59,
        "startLoc": {
          "line": 48,
          "column": 2,
          "position": 501
        },
        "endLoc": {
          "line": 59,
          "column": 4,
          "position": 610
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "},\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/users/profile', {\r\n        method: 'PATCH',\r\n        body: JSON.stringify({ name: 'New Name' }),\r\n      });\r\n\r\n      const response = await PATCH(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\users\\profile.test.ts",
        "start": 139,
        "end": 150,
        "startLoc": {
          "line": 139,
          "column": 2,
          "position": 1429
        },
        "endLoc": {
          "line": 150,
          "column": 4,
          "position": 1539
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\users\\profile.test.ts",
        "start": 48,
        "end": 59,
        "startLoc": {
          "line": 48,
          "column": 2,
          "position": 500
        },
        "endLoc": {
          "line": 59,
          "column": 4,
          "position": 610
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Service Views API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 10,
        "end": 25,
        "startLoc": {
          "line": 10,
          "column": 3,
          "position": 96
        },
        "endLoc": {
          "line": 25,
          "column": 20,
          "position": 234
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 3,
          "position": 58
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-views', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 79,
        "end": 90,
        "startLoc": {
          "line": 79,
          "column": 12,
          "position": 808
        },
        "endLoc": {
          "line": 90,
          "column": 4,
          "position": 926
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 35,
        "end": 46,
        "startLoc": {
          "line": 35,
          "column": 2,
          "position": 347
        },
        "endLoc": {
          "line": 46,
          "column": 4,
          "position": 465
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(upsertChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-views', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 101,
        "end": 115,
        "startLoc": {
          "line": 101,
          "column": 2,
          "position": 1056
        },
        "endLoc": {
          "line": 115,
          "column": 4,
          "position": 1194
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 76,
        "end": 46,
        "startLoc": {
          "line": 76,
          "column": 2,
          "position": 788
        },
        "endLoc": {
          "line": 46,
          "column": 4,
          "position": 465
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-views', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(500);\r\n      expect(data.error).toBe('Internal server error'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 120,
        "end": 132,
        "startLoc": {
          "line": 120,
          "column": 2,
          "position": 1253
        },
        "endLoc": {
          "line": 132,
          "column": 24,
          "position": 1386
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 35,
        "end": 116,
        "startLoc": {
          "line": 35,
          "column": 2,
          "position": 347
        },
        "endLoc": {
          "line": 116,
          "column": 31,
          "position": 1209
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: [], error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 187,
        "end": 198,
        "startLoc": {
          "line": 187,
          "column": 2,
          "position": 2022
        },
        "endLoc": {
          "line": 198,
          "column": 6,
          "position": 2138
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\quotes.test.ts",
        "start": 75,
        "end": 102,
        "startLoc": {
          "line": 75,
          "column": 2,
          "position": 776
        },
        "endLoc": {
          "line": 102,
          "column": 6,
          "position": 1073
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 205,
        "end": 220,
        "startLoc": {
          "line": 205,
          "column": 31,
          "position": 2194
        },
        "endLoc": {
          "line": 220,
          "column": 6,
          "position": 2373
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 183,
        "end": 117,
        "startLoc": {
          "line": 183,
          "column": 33,
          "position": 1965
        },
        "endLoc": {
          "line": 117,
          "column": 6,
          "position": 1240
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-views');\r\n\r\n      const response = await GET(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 215,
        "end": 226,
        "startLoc": {
          "line": 215,
          "column": 2,
          "position": 2346
        },
        "endLoc": {
          "line": 226,
          "column": 4,
          "position": 2449
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 168,
        "end": 149,
        "startLoc": {
          "line": 168,
          "column": 2,
          "position": 1830
        },
        "endLoc": {
          "line": 149,
          "column": 4,
          "position": 1562
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Service Favorites API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 41,
          "position": 57
        },
        "endLoc": {
          "line": 25,
          "column": 24,
          "position": 237
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ", {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(401);\r\n      expect(data.error).toBe('Unauthorized');\r\n    });\r\n\r\n    it('should return 400 if serviceId is missing', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-favorites'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 37,
        "end": 56,
        "startLoc": {
          "line": 37,
          "column": 51,
          "position": 368
        },
        "endLoc": {
          "line": 56,
          "column": 51,
          "position": 573
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 37,
        "end": 56,
        "startLoc": {
          "line": 37,
          "column": 47,
          "position": 365
        },
        "endLoc": {
          "line": 56,
          "column": 47,
          "position": 570
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", {\r\n        method: 'POST',\r\n        body: JSON.stringify({}),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(400);\r\n      expect(data.error).toBe('Missing serviceId');\r\n    });\r\n\r\n    it('should add favorite successfully'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 56,
        "end": 69,
        "startLoc": {
          "line": 56,
          "column": 51,
          "position": 574
        },
        "endLoc": {
          "line": 69,
          "column": 35,
          "position": 699
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 56,
        "end": 69,
        "startLoc": {
          "line": 56,
          "column": 47,
          "position": 571
        },
        "endLoc": {
          "line": 69,
          "column": 41,
          "position": 696
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "});\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-favorites', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(201",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 98,
        "end": 109,
        "startLoc": {
          "line": 98,
          "column": 7,
          "position": 1022
        },
        "endLoc": {
          "line": 109,
          "column": 4,
          "position": 1141
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 35,
        "end": 46,
        "startLoc": {
          "line": 35,
          "column": 7,
          "position": 349
        },
        "endLoc": {
          "line": 46,
          "column": 4,
          "position": 465
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-favorites', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(200);\r\n      expect(data.message).toBe('Already favorited'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 123,
        "end": 135,
        "startLoc": {
          "line": 123,
          "column": 12,
          "position": 1291
        },
        "endLoc": {
          "line": 135,
          "column": 20,
          "position": 1424
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 35,
        "end": 91,
        "startLoc": {
          "line": 35,
          "column": 2,
          "position": 350
        },
        "endLoc": {
          "line": 91,
          "column": 36,
          "position": 941
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(401);\r\n      expect(data.error).toBe('Unauthorized');\r\n    });\r\n\r\n    it('should return 400 if serviceId is missing', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-favorites')",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 150,
        "end": 164,
        "startLoc": {
          "line": 150,
          "column": 7,
          "position": 1557
        },
        "endLoc": {
          "line": 164,
          "column": 2,
          "position": 1712
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 42,
        "end": 56,
        "startLoc": {
          "line": 42,
          "column": 5,
          "position": 416
        },
        "endLoc": {
          "line": 56,
          "column": 2,
          "position": 574
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "const selectChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: { wishlist_count: 5 } }),\r\n      };\r\n\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ error: null }),\r\n      };\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) return deleteChain",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 190,
        "end": 204,
        "startLoc": {
          "line": 190,
          "column": 7,
          "position": 1976
        },
        "endLoc": {
          "line": 204,
          "column": 12,
          "position": 2157
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 81,
        "end": 95,
        "startLoc": {
          "line": 81,
          "column": 7,
          "position": 812
        },
        "endLoc": {
          "line": 95,
          "column": 12,
          "position": 993
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "});\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/user/service-favorites?serviceId=service-1'\r\n      );\r\n\r\n      const response = await DELETE(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 207,
        "end": 217,
        "startLoc": {
          "line": 207,
          "column": 7,
          "position": 2186
        },
        "endLoc": {
          "line": 217,
          "column": 4,
          "position": 2276
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 144,
        "end": 154,
        "startLoc": {
          "line": 144,
          "column": 7,
          "position": 1516
        },
        "endLoc": {
          "line": 154,
          "column": 4,
          "position": 1606
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n\r\n      const response = await GET(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(401);\r\n      expect(data.error).toBe('Unauthorized');\r\n    });\r\n\r\n    it('should return favorites list'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 229,
        "end": 239,
        "startLoc": {
          "line": 229,
          "column": 51,
          "position": 2402
        },
        "endLoc": {
          "line": 239,
          "column": 31,
          "position": 2498
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 143,
        "end": 50,
        "startLoc": {
          "line": 143,
          "column": 47,
          "position": 1497
        },
        "endLoc": {
          "line": 50,
          "column": 44,
          "position": 496
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n\r\n      const response = await GET(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(200);\r\n      expect(data.data).toHaveLength(2);\r\n    });\r\n\r\n    it('should handle database error'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 258,
        "end": 268,
        "startLoc": {
          "line": 258,
          "column": 51,
          "position": 2757
        },
        "endLoc": {
          "line": 268,
          "column": 31,
          "position": 2853
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 173,
        "end": 183,
        "startLoc": {
          "line": 173,
          "column": 47,
          "position": 1868
        },
        "endLoc": {
          "line": 183,
          "column": 33,
          "position": 1964
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n    });\r\n\r\n    it('should handle database error', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 265,
        "end": 277,
        "startLoc": {
          "line": 265,
          "column": 2,
          "position": 2838
        },
        "endLoc": {
          "line": 277,
          "column": 18,
          "position": 2968
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 202,
        "end": 192,
        "startLoc": {
          "line": 202,
          "column": 3,
          "position": 2178
        },
        "endLoc": {
          "line": 192,
          "column": 15,
          "position": 2079
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/service-favorites');\r\n\r\n      const response = await GET(request);\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 277,
        "end": 288,
        "startLoc": {
          "line": 277,
          "column": 2,
          "position": 2990
        },
        "endLoc": {
          "line": 288,
          "column": 4,
          "position": 3093
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 253,
        "end": 235,
        "startLoc": {
          "line": 253,
          "column": 2,
          "position": 2719
        },
        "endLoc": {
          "line": 235,
          "column": 4,
          "position": 2467
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Category Visits API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 39,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 22,
          "position": 234
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "});\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/category-visits', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          categoryId: 'cat-1',\r\n          categoryName: 'Design',\r\n          categorySlug: 'design',\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 100,
        "end": 114,
        "startLoc": {
          "line": 100,
          "column": 7,
          "position": 1013
        },
        "endLoc": {
          "line": 114,
          "column": 4,
          "position": 1139
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 35,
        "end": 49,
        "startLoc": {
          "line": 35,
          "column": 7,
          "position": 346
        },
        "endLoc": {
          "line": 49,
          "column": 4,
          "position": 472
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ";\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/category-visits', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          categoryId: 'cat-1',\r\n          categoryName: 'Design',\r\n          categorySlug: 'design',\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(data.isUpdate",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 150,
        "end": 166,
        "startLoc": {
          "line": 150,
          "column": 12,
          "position": 1547
        },
        "endLoc": {
          "line": 166,
          "column": 9,
          "position": 1687
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 99,
        "end": 115,
        "startLoc": {
          "line": 99,
          "column": 12,
          "position": 1009
        },
        "endLoc": {
          "line": 115,
          "column": 8,
          "position": 1149
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ".status).toBe(200);\r\n      expect(data.data).toHaveLength(2);\r\n    });\r\n\r\n    it('should handle database error', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        gte",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 212,
        "end": 225,
        "startLoc": {
          "line": 212,
          "column": 9,
          "position": 2195
        },
        "endLoc": {
          "line": 225,
          "column": 4,
          "position": 2338
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-favorites.test.ts",
        "start": 264,
        "end": 192,
        "startLoc": {
          "line": 264,
          "column": 2,
          "position": 2816
        },
        "endLoc": {
          "line": 192,
          "column": 6,
          "position": 2070
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/user/category-visits');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 227,
        "end": 237,
        "startLoc": {
          "line": 227,
          "column": 2,
          "position": 2401
        },
        "endLoc": {
          "line": 237,
          "column": 4,
          "position": 2490
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\category-visits.test.ts",
        "start": 202,
        "end": 212,
        "startLoc": {
          "line": 202,
          "column": 2,
          "position": 2112
        },
        "endLoc": {
          "line": 212,
          "column": 4,
          "position": 2201
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ": vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Search Services API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\search\\services.test.ts",
        "start": 12,
        "end": 27,
        "startLoc": {
          "line": 12,
          "column": 6,
          "position": 160
        },
        "endLoc": {
          "line": 27,
          "column": 22,
          "position": 297
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 59
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Portfolio API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\portfolio\\portfolio.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 28,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 16,
          "position": 231
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\portfolio\\portfolio.test.ts",
        "start": 159,
        "end": 169,
        "startLoc": {
          "line": 159,
          "column": 29,
          "position": 1669
        },
        "endLoc": {
          "line": 169,
          "column": 7,
          "position": 1778
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\portfolio\\portfolio.test.ts",
        "start": 117,
        "end": 127,
        "startLoc": {
          "line": 117,
          "column": 39,
          "position": 1212
        },
        "endLoc": {
          "line": 127,
          "column": 30,
          "position": 1321
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: { seller_id: 'seller-1' } }),\r\n          };\r\n        } else if (callCount === 2) {\r\n          return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\portfolio\\portfolio.test.ts",
        "start": 165,
        "end": 175,
        "startLoc": {
          "line": 165,
          "column": 7,
          "position": 1732
        },
        "endLoc": {
          "line": 175,
          "column": 7,
          "position": 1870
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\portfolio\\portfolio.test.ts",
        "start": 90,
        "end": 134,
        "startLoc": {
          "line": 90,
          "column": 7,
          "position": 911
        },
        "endLoc": {
          "line": 134,
          "column": 39,
          "position": 1417
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe(' ');\n    });\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 98,
        "end": 115,
        "startLoc": {
          "line": 98,
          "column": 5,
          "position": 726
        },
        "endLoc": {
          "line": 115,
          "column": 2,
          "position": 858
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 77,
        "end": 95,
        "startLoc": {
          "line": 77,
          "column": 2,
          "position": 549
        },
        "endLoc": {
          "line": 95,
          "column": 3,
          "position": 682
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('  ');\n    });\n\n    it('should return 400 when order_id is not a valid UUID'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 186,
        "end": 197,
        "startLoc": {
          "line": 186,
          "column": 10,
          "position": 1401
        },
        "endLoc": {
          "line": 197,
          "column": 54,
          "position": 1483
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 171,
        "end": 182,
        "startLoc": {
          "line": 171,
          "column": 39,
          "position": 1269
        },
        "endLoc": {
          "line": 182,
          "column": 45,
          "position": 1351
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(404",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 232,
        "end": 246,
        "startLoc": {
          "line": 232,
          "column": 2,
          "position": 1792
        },
        "endLoc": {
          "line": 246,
          "column": 4,
          "position": 1900
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 77,
        "end": 91,
        "startLoc": {
          "line": 77,
          "column": 2,
          "position": 549
        },
        "endLoc": {
          "line": 91,
          "column": 4,
          "position": 657
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(403",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 262,
        "end": 277,
        "startLoc": {
          "line": 262,
          "column": 5,
          "position": 2042
        },
        "endLoc": {
          "line": 277,
          "column": 4,
          "position": 2155
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 231,
        "end": 91,
        "startLoc": {
          "line": 231,
          "column": 2,
          "position": 1787
        },
        "endLoc": {
          "line": 91,
          "column": 4,
          "position": 657
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ",\n          },\n          error: null,\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 291,
        "end": 308,
        "startLoc": {
          "line": 291,
          "column": 7,
          "position": 2286
        },
        "endLoc": {
          "line": 308,
          "column": 4,
          "position": 2410
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 260,
        "end": 91,
        "startLoc": {
          "line": 260,
          "column": 18,
          "position": 2031
        },
        "endLoc": {
          "line": 91,
          "column": 4,
          "position": 657
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ", async () => {\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: '123e4567-e89b-12d3-a456-426614174000',\n            buyer_id: 'user-123',\n            seller_id: 'seller-123',\n            total_amount: 10000,\n            status: 'in_progress'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 312,
        "end": 322,
        "startLoc": {
          "line": 312,
          "column": 53,
          "position": 2438
        },
        "endLoc": {
          "line": 322,
          "column": 14,
          "position": 2540
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 225,
        "end": 291,
        "startLoc": {
          "line": 225,
          "column": 44,
          "position": 1704
        },
        "endLoc": {
          "line": 291,
          "column": 7,
          "position": 2285
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": ",\n          },\n          error: null,\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('  ');\n    });\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 322,
        "end": 342,
        "startLoc": {
          "line": 322,
          "column": 14,
          "position": 2541
        },
        "endLoc": {
          "line": 342,
          "column": 2,
          "position": 2689
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 260,
        "end": 312,
        "startLoc": {
          "line": 260,
          "column": 18,
          "position": 2031
        },
        "endLoc": {
          "line": 312,
          "column": 3,
          "position": 2435
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ", error: null }),\n          };\n        }\n        return {\n          select: vi.fn().mockReturnThis(),\n          eq: vi.fn().mockReturnThis(),\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\n        };\n      });\n\n      mockSupabase",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 375,
        "end": 385,
        "startLoc": {
          "line": 375,
          "column": 2,
          "position": 2980
        },
        "endLoc": {
          "line": 385,
          "column": 13,
          "position": 3073
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 211,
        "end": 222,
        "startLoc": {
          "line": 211,
          "column": 12,
          "position": 2190
        },
        "endLoc": {
          "line": 222,
          "column": 7,
          "position": 2295
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 392,
        "end": 406,
        "startLoc": {
          "line": 392,
          "column": 6,
          "position": 3136
        },
        "endLoc": {
          "line": 406,
          "column": 4,
          "position": 3244
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 77,
        "end": 91,
        "startLoc": {
          "line": 77,
          "column": 2,
          "position": 549
        },
        "endLoc": {
          "line": 91,
          "column": 4,
          "position": 657
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 423,
        "end": 437,
        "startLoc": {
          "line": 423,
          "column": 5,
          "position": 3365
        },
        "endLoc": {
          "line": 437,
          "column": 4,
          "position": 3473
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 77,
        "end": 91,
        "startLoc": {
          "line": 77,
          "column": 2,
          "position": 549
        },
        "endLoc": {
          "line": 91,
          "column": 4,
          "position": 657
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", async () => {\n      const mockPayment = {\n        id: 'payment-123',\n        order_id: '123e4567-e89b-12d3-a456-426614174000',\n        amount: 10000,\n        payment_method: 'card',\n        payment_id: 'pay-123',\n        status: 'completed',\n      };\n\n      mockCreatePaymentWithIdempotency.mockResolvedValue({\n        data: mockPayment,\n        error: null,\n        isExisting: false",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 442,
        "end": 455,
        "startLoc": {
          "line": 442,
          "column": 44,
          "position": 3517
        },
        "endLoc": {
          "line": 455,
          "column": 6,
          "position": 3609
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 410,
        "end": 423,
        "startLoc": {
          "line": 410,
          "column": 75,
          "position": 3272
        },
        "endLoc": {
          "line": 423,
          "column": 5,
          "position": 3364
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "return {\n            select: vi.fn().mockReturnThis(),\n            eq: vi.fn().mockReturnThis(),\n            single: vi.fn().mockResolvedValue({\n              data: {\n                id: '123e4567-e89b-12d3-a456-426614174000',\n                buyer_id: 'user-123',\n                seller_id: 'seller-123',\n                total_amount: 10000,\n                status: 'pending_payment',\n              },\n              error: null,\n            }),\n            update: mockUpdate",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 465,
        "end": 478,
        "startLoc": {
          "line": 465,
          "column": 11,
          "position": 3709
        },
        "endLoc": {
          "line": 478,
          "column": 11,
          "position": 3818
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 356,
        "end": 369,
        "startLoc": {
          "line": 356,
          "column": 11,
          "position": 2801
        },
        "endLoc": {
          "line": 369,
          "column": 3,
          "position": 2910
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "}),\n          };\n        }\n        return {\n          select: vi.fn().mockReturnThis(),\n          eq: vi.fn().mockReturnThis(),\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\n        };\n      });\n\n      mockSupabase.from = mockFrom;\n\n      const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 478,
        "end": 490,
        "startLoc": {
          "line": 478,
          "column": 2,
          "position": 3829
        },
        "endLoc": {
          "line": 490,
          "column": 6,
          "position": 3926
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 211,
        "end": 386,
        "startLoc": {
          "line": 211,
          "column": 2,
          "position": 2197
        },
        "endLoc": {
          "line": 386,
          "column": 2,
          "position": 3083
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ";\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBe('   '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 488,
        "end": 502,
        "startLoc": {
          "line": 488,
          "column": 9,
          "position": 3922
        },
        "endLoc": {
          "line": 502,
          "column": 16,
          "position": 4039
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 78,
        "end": 407,
        "startLoc": {
          "line": 78,
          "column": 2,
          "position": 554
        },
        "endLoc": {
          "line": 407,
          "column": 14,
          "position": 3258
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ", async () => {\n      const mockPayment = {\n        id: 'payment-123',\n        order_id: '123e4567-e89b-12d3-a456-426614174000',\n        amount: 10000,\n        payment_method: 'card',\n        payment_id: 'pay-123',\n        status: 'completed',\n      };\n\n      mockCreatePaymentWithIdempotency.mockResolvedValue({\n        data: mockPayment,\n        error: null,\n        isExisting: false,\n      });\n\n      const mockFrom = vi.fn((tableName: string) => {\n        if (tableName === 'orders') {\n          return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 505,
        "end": 523,
        "startLoc": {
          "line": 505,
          "column": 61,
          "position": 4053
        },
        "endLoc": {
          "line": 523,
          "column": 7,
          "position": 4190
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 410,
        "end": 460,
        "startLoc": {
          "line": 410,
          "column": 75,
          "position": 3272
        },
        "endLoc": {
          "line": 460,
          "column": 6,
          "position": 3654
        }
      }
    },
    {
      "format": "typescript",
      "lines": 35,
      "fragment": ",\n      });\n\n      const mockFrom = vi.fn((tableName: string) => {\n        if (tableName === 'orders') {\n          return {\n            select: vi.fn().mockReturnThis(),\n            eq: vi.fn().mockReturnThis(),\n            single: vi.fn().mockResolvedValue({\n              data: {\n                id: '123e4567-e89b-12d3-a456-426614174000',\n                buyer_id: 'user-123',\n                seller_id: 'seller-123',\n                total_amount: 10000,\n                status: 'pending_payment',\n              },\n              error: null,\n            }),\n            update: vi.fn().mockReturnThis(),\n          };\n        }\n        if (tableName === 'payment_requests') {\n          return {\n            update: vi.fn().mockReturnThis(),\n            eq: vi.fn().mockResolvedValue({ data: {}, error: null }),\n          };\n        }\n        return {\n          select: vi.fn().mockReturnThis(),\n          eq: vi.fn().mockReturnThis(),\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\n        };\n      });\n\n      // Mock update response",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 518,
        "end": 552,
        "startLoc": {
          "line": 518,
          "column": 6,
          "position": 4146
        },
        "endLoc": {
          "line": 552,
          "column": 24,
          "position": 4462
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 351,
        "end": 222,
        "startLoc": {
          "line": 351,
          "column": 5,
          "position": 2757
        },
        "endLoc": {
          "line": 222,
          "column": 7,
          "position": 2295
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "});\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n      expect(data.order.id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 564,
        "end": 579,
        "startLoc": {
          "line": 564,
          "column": 7,
          "position": 4578
        },
        "endLoc": {
          "line": 579,
          "column": 3,
          "position": 4708
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 78,
        "end": 439,
        "startLoc": {
          "line": 78,
          "column": 7,
          "position": 552
        },
        "endLoc": {
          "line": 439,
          "column": 11,
          "position": 3498
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ", async () => {\n      const mockPayment = {\n        id: 'payment-123',\n        order_id: '123e4567-e89b-12d3-a456-426614174000',\n        amount: 10000,\n        payment_method: 'card',\n        payment_id: 'pay-123',\n        status: 'completed',\n      };\n\n      mockCreatePaymentWithIdempotency.mockResolvedValue({\n        data: mockPayment,\n        error: null,\n        isExisting: false,\n      });\n\n      const mockUpdatePaymentRequest",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 589,
        "end": 605,
        "startLoc": {
          "line": 589,
          "column": 75,
          "position": 4783
        },
        "endLoc": {
          "line": 605,
          "column": 25,
          "position": 4887
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 410,
        "end": 458,
        "startLoc": {
          "line": 410,
          "column": 75,
          "position": 3272
        },
        "endLoc": {
          "line": 458,
          "column": 9,
          "position": 3621
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": "});\n\n      const mockFrom = vi.fn((tableName: string) => {\n        if (tableName === 'orders') {\n          return {\n            select: vi.fn().mockReturnThis(),\n            eq: vi.fn().mockReturnThis(),\n            single: vi.fn().mockResolvedValue({\n              data: {\n                id: '123e4567-e89b-12d3-a456-426614174000',\n                buyer_id: 'user-123',\n                seller_id: 'seller-123',\n                total_amount: 10000,\n                status: 'pending_payment',\n              },\n              error: null,\n            }),\n            update: vi.fn().mockReturnValue",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 606,
        "end": 623,
        "startLoc": {
          "line": 606,
          "column": 2,
          "position": 4931
        },
        "endLoc": {
          "line": 623,
          "column": 16,
          "position": 5087
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 352,
        "end": 369,
        "startLoc": {
          "line": 352,
          "column": 7,
          "position": 2760
        },
        "endLoc": {
          "line": 369,
          "column": 15,
          "position": 2916
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": "}),\n          };\n        }\n        return {\n          select: vi.fn().mockReturnThis(),\n          eq: vi.fn().mockReturnThis(),\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\n        };\n      });\n\n      mockSupabase.from = mockFrom;\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n          payment_request_id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 632,
        "end": 649,
        "startLoc": {
          "line": 632,
          "column": 13,
          "position": 5162
        },
        "endLoc": {
          "line": 649,
          "column": 19,
          "position": 5306
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 211,
        "end": 495,
        "startLoc": {
          "line": 211,
          "column": 2,
          "position": 2197
        },
        "endLoc": {
          "line": 495,
          "column": 2,
          "position": 3973
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 666,
        "end": 680,
        "startLoc": {
          "line": 666,
          "column": 2,
          "position": 5436
        },
        "endLoc": {
          "line": 680,
          "column": 16,
          "position": 5554
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 78,
        "end": 407,
        "startLoc": {
          "line": 78,
          "column": 2,
          "position": 553
        },
        "endLoc": {
          "line": 407,
          "column": 14,
          "position": 3258
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "const mockPayment = {\n        id: 'payment-123',\n        order_id: '123e4567-e89b-12d3-a456-426614174000',\n        amount: 10000,\n        payment_method: 'card',\n        payment_id: 'pay-123',\n        status: 'completed',\n      };\n\n      mockCreatePaymentWithIdempotency.mockResolvedValue({\n        data: mockPayment,\n        error: null,\n        isExisting: false,\n      });\n\n      // Notification fails but payment should still succeed",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 690,
        "end": 705,
        "startLoc": {
          "line": 690,
          "column": 7,
          "position": 5634
        },
        "endLoc": {
          "line": 705,
          "column": 55,
          "position": 5724
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 443,
        "end": 458,
        "startLoc": {
          "line": 443,
          "column": 7,
          "position": 3529
        },
        "endLoc": {
          "line": 458,
          "column": 6,
          "position": 3619
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ");\n\n      const mockFrom = vi.fn((tableName: string) => {\n        if (tableName === 'orders') {\n          return {\n            select: vi.fn().mockReturnThis(),\n            eq: vi.fn().mockReturnThis(),\n            single: vi.fn().mockResolvedValue({\n              data: {\n                id: '123e4567-e89b-12d3-a456-426614174000',\n                buyer_id: 'user-123',\n                seller_id: 'seller-123',\n                total_amount: 10000,\n                status: 'pending_payment',\n              },\n              error: null,\n            }),\n            update: vi.fn().mockReturnValue({\n              eq: vi.fn().mockResolvedValue({ error: null }),\n            }),\n          };\n        }\n        return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 706,
        "end": 728,
        "startLoc": {
          "line": 706,
          "column": 2,
          "position": 5737
        },
        "endLoc": {
          "line": 728,
          "column": 7,
          "position": 5932
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 352,
        "end": 628,
        "startLoc": {
          "line": 352,
          "column": 2,
          "position": 2761
        },
        "endLoc": {
          "line": 628,
          "column": 3,
          "position": 5127
        }
      }
    },
    {
      "format": "typescript",
      "lines": 25,
      "fragment": ",\n            }),\n          };\n        }\n        return {\n          select: vi.fn().mockReturnThis(),\n          eq: vi.fn().mockReturnThis(),\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\n        };\n      });\n\n      mockSupabase.from = mockFrom;\n\n      const request = new NextRequest('http://localhost:3000/api/payments/verify', {\n        method: 'POST',\n        body: JSON.stringify({\n          payment_id: 'pay-123',\n          order_id: '123e4567-e89b-12d3-a456-426614174000',\n        }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      // Payment should still succeed even if notification fails",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 724,
        "end": 748,
        "startLoc": {
          "line": 724,
          "column": 2,
          "position": 5917
        },
        "endLoc": {
          "line": 748,
          "column": 59,
          "position": 6107
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 631,
        "end": 91,
        "startLoc": {
          "line": 631,
          "column": 21,
          "position": 5159
        },
        "endLoc": {
          "line": 91,
          "column": 7,
          "position": 648
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ": any;\r\n\r\n  beforeEach(async () => {\r\n    // Setup Supabase mock\r\n    mockSupabase = {\r\n      auth: {\r\n        getUser: vi.fn(),\r\n      },\r\n      from: vi.fn(),\r\n    };\r\n\r\n    mockCreateClient = vi.fn().mockResolvedValue(mockSupabase);\r\n\r\n    // Setup rate limit mock (success by default)\r\n    mockCheckRateLimit = vi.fn().mockResolvedValue({ success: true });\r\n\r\n    // Setup transaction mock\r\n    mockCreateOrderWithIdempotency",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 25,
        "end": 42,
        "startLoc": {
          "line": 25,
          "column": 31,
          "position": 168
        },
        "endLoc": {
          "line": 42,
          "column": 31,
          "position": 300
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 28,
        "end": 45,
        "startLoc": {
          "line": 28,
          "column": 26,
          "position": 168
        },
        "endLoc": {
          "line": 45,
          "column": 33,
          "position": 283
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n\r\n    // Apply mocks\r\n    const supabaseServer = await import('@/lib/supabase/server');\r\n    vi.mocked(supabaseServer.createClient).mockImplementation(mockCreateClient);\r\n\r\n    const rateLimit = await import('@/lib/rate-limit');\r\n    vi.mocked(rateLimit.checkRateLimit).mockImplementation(mockCheckRateLimit);\r\n\r\n    const transaction = await import('@/lib/transaction');\r\n    vi.mocked(transaction.createOrderWithIdempotency",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 42,
        "end": 52,
        "startLoc": {
          "line": 42,
          "column": 2,
          "position": 308
        },
        "endLoc": {
          "line": 52,
          "column": 27,
          "position": 411
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 48,
        "end": 58,
        "startLoc": {
          "line": 48,
          "column": 2,
          "position": 313
        },
        "endLoc": {
          "line": 58,
          "column": 29,
          "position": 406
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ",\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(401);\r\n      expect(data.error).toBe(' ');\r\n    });\r\n\r\n    it('should return 401 when user is null', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: null },\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 77,
        "end": 94,
        "startLoc": {
          "line": 77,
          "column": 6,
          "position": 612
        },
        "endLoc": {
          "line": 94,
          "column": 53,
          "position": 772
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 84,
        "end": 101,
        "startLoc": {
          "line": 84,
          "column": 39,
          "position": 602
        },
        "endLoc": {
          "line": 101,
          "column": 44,
          "position": 745
        }
      }
    },
    {
      "format": "typescript",
      "lines": 24,
      "fragment": ",\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(401);\r\n      expect(data.error).toBe(' ');\r\n    });\r\n  });\r\n\r\n  /**\r\n   * Rate Limiting Tests\r\n   */",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 91,
        "end": 114,
        "startLoc": {
          "line": 91,
          "column": 5,
          "position": 750
        },
        "endLoc": {
          "line": 114,
          "column": 6,
          "position": 923
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 68,
        "end": 119,
        "startLoc": {
          "line": 68,
          "column": 2,
          "position": 536
        },
        "endLoc": {
          "line": 119,
          "column": 6,
          "position": 864
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "describe('Rate Limiting', () => {\r\n    it('should return 429 when rate limit is exceeded', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-123' } },\r\n        error: null,\r\n      });\r\n\r\n      const rateLimitResponse = new Response(\r\n        JSON.stringify({\r\n          error: '   .    .',\r\n          limit: 10",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 115,
        "end": 125,
        "startLoc": {
          "line": 115,
          "column": 3,
          "position": 927
        },
        "endLoc": {
          "line": 125,
          "column": 3,
          "position": 1039
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 120,
        "end": 130,
        "startLoc": {
          "line": 120,
          "column": 3,
          "position": 867
        },
        "endLoc": {
          "line": 130,
          "column": 2,
          "position": 969
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n\r\n      expect",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 134,
        "end": 149,
        "startLoc": {
          "line": 134,
          "column": 18,
          "position": 1112
        },
        "endLoc": {
          "line": 149,
          "column": 7,
          "position": 1224
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 68,
        "end": 82,
        "startLoc": {
          "line": 68,
          "column": 2,
          "position": 536
        },
        "endLoc": {
          "line": 82,
          "column": 6,
          "position": 646
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('  ');\r\n    });\r\n\r\n    it('should return 400 when service_id is missing'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 170,
        "end": 181,
        "startLoc": {
          "line": 170,
          "column": 6,
          "position": 1410
        },
        "endLoc": {
          "line": 181,
          "column": 47,
          "position": 1503
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 171,
        "end": 182,
        "startLoc": {
          "line": 171,
          "column": 39,
          "position": 1269
        },
        "endLoc": {
          "line": 182,
          "column": 45,
          "position": 1351
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ",\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('  ');\r\n    });\r\n\r\n    it('should return 400 when title is missing'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 185,
        "end": 198,
        "startLoc": {
          "line": 185,
          "column": 13,
          "position": 1557
        },
        "endLoc": {
          "line": 198,
          "column": 42,
          "position": 1666
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 168,
        "end": 182,
        "startLoc": {
          "line": 168,
          "column": 14,
          "position": 1394
        },
        "endLoc": {
          "line": 182,
          "column": 45,
          "position": 1351
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ",\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('  ');\r\n    });\r\n\r\n    it('should return 400 when amount is missing'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 203,
        "end": 215,
        "startLoc": {
          "line": 203,
          "column": 14,
          "position": 1728
        },
        "endLoc": {
          "line": 215,
          "column": 43,
          "position": 1829
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 169,
        "end": 182,
        "startLoc": {
          "line": 169,
          "column": 15,
          "position": 1402
        },
        "endLoc": {
          "line": 182,
          "column": 45,
          "position": 1351
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('  ');\r\n    });\r\n\r\n    it('should return 400 when amount is less than 1000'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 221,
        "end": 232,
        "startLoc": {
          "line": 221,
          "column": 15,
          "position": 1899
        },
        "endLoc": {
          "line": 232,
          "column": 50,
          "position": 1992
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 171,
        "end": 182,
        "startLoc": {
          "line": 171,
          "column": 39,
          "position": 1269
        },
        "endLoc": {
          "line": 182,
          "column": 45,
          "position": 1351
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('   ');\r\n    });\r\n\r\n    it('should return 400 when amount is not a number'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 257,
        "end": 268,
        "startLoc": {
          "line": 257,
          "column": 10,
          "position": 2241
        },
        "endLoc": {
          "line": 268,
          "column": 48,
          "position": 2334
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 239,
        "end": 250,
        "startLoc": {
          "line": 239,
          "column": 4,
          "position": 2070
        },
        "endLoc": {
          "line": 250,
          "column": 58,
          "position": 2163
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('   ');\r\n    });\r\n\r\n    it('should return 400 when title is not a string'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 275,
        "end": 286,
        "startLoc": {
          "line": 275,
          "column": 10,
          "position": 2412
        },
        "endLoc": {
          "line": 286,
          "column": 47,
          "position": 2505
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 239,
        "end": 250,
        "startLoc": {
          "line": 239,
          "column": 4,
          "position": 2070
        },
        "endLoc": {
          "line": 250,
          "column": 58,
          "position": 2163
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('  ');\r\n    });\r\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 312,
        "end": 323,
        "startLoc": {
          "line": 312,
          "column": 10,
          "position": 2764
        },
        "endLoc": {
          "line": 323,
          "column": 2,
          "position": 2861
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 169,
        "end": 304,
        "startLoc": {
          "line": 169,
          "column": 15,
          "position": 1402
        },
        "endLoc": {
          "line": 304,
          "column": 3,
          "position": 2674
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ",\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(404",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 347,
        "end": 363,
        "startLoc": {
          "line": 347,
          "column": 11,
          "position": 3087
        },
        "endLoc": {
          "line": 363,
          "column": 4,
          "position": 3225
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 68,
        "end": 84,
        "startLoc": {
          "line": 68,
          "column": 2,
          "position": 536
        },
        "endLoc": {
          "line": 84,
          "column": 4,
          "position": 674
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ",\r\n            }),\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 375,
        "end": 388,
        "startLoc": {
          "line": 375,
          "column": 5,
          "position": 3385
        },
        "endLoc": {
          "line": 388,
          "column": 53,
          "position": 3508
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 631,
        "end": 490,
        "startLoc": {
          "line": 631,
          "column": 21,
          "position": 5159
        },
        "endLoc": {
          "line": 490,
          "column": 44,
          "position": 3936
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ";\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(403",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 386,
        "end": 401,
        "startLoc": {
          "line": 386,
          "column": 9,
          "position": 3492
        },
        "endLoc": {
          "line": 401,
          "column": 4,
          "position": 3624
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 69,
        "end": 84,
        "startLoc": {
          "line": 69,
          "column": 2,
          "position": 542
        },
        "endLoc": {
          "line": 84,
          "column": 4,
          "position": 674
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "},\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n    });\r\n\r\n    it('should return 404 when service is not found'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 422,
        "end": 437,
        "startLoc": {
          "line": 422,
          "column": 2,
          "position": 3844
        },
        "endLoc": {
          "line": 437,
          "column": 46,
          "position": 3974
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 374,
        "end": 388,
        "startLoc": {
          "line": 374,
          "column": 2,
          "position": 3376
        },
        "endLoc": {
          "line": 388,
          "column": 48,
          "position": 3091
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ", async () => {\r\n      const mockFrom = vi.fn((tableName: string) => {\r\n        if (tableName === 'sellers') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: { id: 'seller-123', user_id: 'seller-user-123' },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 437,
        "end": 449,
        "startLoc": {
          "line": 437,
          "column": 46,
          "position": 3975
        },
        "endLoc": {
          "line": 449,
          "column": 3,
          "position": 4122
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 367,
        "end": 427,
        "startLoc": {
          "line": 367,
          "column": 51,
          "position": 3257
        },
        "endLoc": {
          "line": 427,
          "column": 7,
          "position": 3872
        }
      }
    },
    {
      "format": "typescript",
      "lines": 28,
      "fragment": ",\r\n            }),\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(404);\r\n      expect(data.error).toBe('   '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 455,
        "end": 482,
        "startLoc": {
          "line": 455,
          "column": 2,
          "position": 4208
        },
        "endLoc": {
          "line": 482,
          "column": 17,
          "position": 4462
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 631,
        "end": 364,
        "startLoc": {
          "line": 631,
          "column": 21,
          "position": 5159
        },
        "endLoc": {
          "line": 364,
          "column": 17,
          "position": 3240
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ", async () => {\r\n      const mockFrom = vi.fn((tableName: string) => {\r\n        if (tableName === 'sellers') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: { id: 'seller-123', user_id: 'seller-user-123' },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if (tableName === 'services') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 485,
        "end": 502,
        "startLoc": {
          "line": 485,
          "column": 61,
          "position": 4479
        },
        "endLoc": {
          "line": 502,
          "column": 2,
          "position": 4696
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 367,
        "end": 454,
        "startLoc": {
          "line": 367,
          "column": 51,
          "position": 3257
        },
        "endLoc": {
          "line": 454,
          "column": 5,
          "position": 4192
        }
      }
    },
    {
      "format": "typescript",
      "lines": 28,
      "fragment": "},\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 508,
        "end": 535,
        "startLoc": {
          "line": 508,
          "column": 15,
          "position": 4740
        },
        "endLoc": {
          "line": 535,
          "column": 4,
          "position": 4988
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 374,
        "end": 84,
        "startLoc": {
          "line": 374,
          "column": 2,
          "position": 3376
        },
        "endLoc": {
          "line": 84,
          "column": 4,
          "position": 674
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 526,
        "end": 536,
        "startLoc": {
          "line": 526,
          "column": 11,
          "position": 4906
        },
        "endLoc": {
          "line": 536,
          "column": 16,
          "position": 5003
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 168,
        "end": 178,
        "startLoc": {
          "line": 168,
          "column": 11,
          "position": 1390
        },
        "endLoc": {
          "line": 178,
          "column": 17,
          "position": 1487
        }
      }
    },
    {
      "format": "typescript",
      "lines": 27,
      "fragment": ", () => {\r\n    beforeEach(() => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-123' } },\r\n        error: null,\r\n      });\r\n\r\n      const mockFrom = vi.fn((tableName: string) => {\r\n        if (tableName === 'sellers') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: { id: 'seller-123', user_id: 'seller-user-123' },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if (tableName === 'services') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: {\r\n                id: 'service-123',\r\n                title: 'Test Service',\r\n                price: 10000",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 543,
        "end": 569,
        "startLoc": {
          "line": 543,
          "column": 17,
          "position": 5030
        },
        "endLoc": {
          "line": 569,
          "column": 6,
          "position": 5329
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 347,
        "end": 505,
        "startLoc": {
          "line": 347,
          "column": 19,
          "position": 2701
        },
        "endLoc": {
          "line": 505,
          "column": 6,
          "position": 4719
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ": vi.fn().mockResolvedValue({ data: {}, error: null }),\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n    });\r\n\r\n    it('should return 500 when order creation fails'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 582,
        "end": 595,
        "startLoc": {
          "line": 582,
          "column": 7,
          "position": 5461
        },
        "endLoc": {
          "line": 595,
          "column": 46,
          "position": 5602
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 375,
        "end": 388,
        "startLoc": {
          "line": 375,
          "column": 3,
          "position": 2963
        },
        "endLoc": {
          "line": 388,
          "column": 48,
          "position": 3091
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ",\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 604,
        "end": 620,
        "startLoc": {
          "line": 604,
          "column": 6,
          "position": 5680
        },
        "endLoc": {
          "line": 620,
          "column": 4,
          "position": 5818
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 68,
        "end": 84,
        "startLoc": {
          "line": 68,
          "column": 2,
          "position": 536
        },
        "endLoc": {
          "line": 84,
          "column": 4,
          "position": 674
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ", async () => {\r\n      const mockOrder = {\r\n        id: 'order-123',\r\n        buyer_id: 'user-123',\r\n        seller_id: 'seller-user-123',\r\n        service_id: 'service-123',\r\n        amount: 10000,\r\n        total_amount: 10000,\r\n        status: 'pending_payment',\r\n        title: 'Test Service',\r\n      };\r\n\r\n      mockCreateOrderWithIdempotency.mockResolvedValue({\r\n        data: mockOrder,\r\n        error: null,\r\n        isExisting: false,\r\n      });\r\n\r\n      const mockInsert",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 665,
        "end": 683,
        "startLoc": {
          "line": 665,
          "column": 47,
          "position": 6211
        },
        "endLoc": {
          "line": 683,
          "column": 11,
          "position": 6347
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 624,
        "end": 642,
        "startLoc": {
          "line": 624,
          "column": 60,
          "position": 5850
        },
        "endLoc": {
          "line": 642,
          "column": 8,
          "position": 5986
        }
      }
    },
    {
      "format": "typescript",
      "lines": 34,
      "fragment": "});\r\n      const mockFrom = vi.fn((tableName: string) => {\r\n        if (tableName === 'sellers') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: { id: 'seller-123', user_id: 'seller-user-123' },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if (tableName === 'services') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: {\r\n                id: 'service-123',\r\n                title: 'Test Service',\r\n                price: 10000,\r\n                delivery_days: 7,\r\n                revision_count: 2,\r\n              },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if (tableName === 'chat_rooms') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            maybeSingle: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n            insert: mockInsert",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 683,
        "end": 716,
        "startLoc": {
          "line": 683,
          "column": 2,
          "position": 6373
        },
        "endLoc": {
          "line": 716,
          "column": 11,
          "position": 6740
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 414,
        "end": 582,
        "startLoc": {
          "line": 414,
          "column": 7,
          "position": 3730
        },
        "endLoc": {
          "line": 582,
          "column": 3,
          "position": 5463
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ",\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      await",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 716,
        "end": 738,
        "startLoc": {
          "line": 716,
          "column": 11,
          "position": 6741
        },
        "endLoc": {
          "line": 738,
          "column": 6,
          "position": 6930
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\personalized-services.test.ts",
        "start": 211,
        "end": 398,
        "startLoc": {
          "line": 211,
          "column": 2,
          "position": 2199
        },
        "endLoc": {
          "line": 398,
          "column": 6,
          "position": 3580
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ", async () => {\r\n      const mockOrder = {\r\n        id: 'order-123',\r\n        buyer_id: 'user-123',\r\n        seller_id: 'seller-user-123',\r\n        service_id: 'service-123',\r\n        amount: 10000,\r\n        total_amount: 10000,\r\n        status: 'pending_payment',\r\n        title: 'Test Service',\r\n      };\r\n\r\n      mockCreateOrderWithIdempotency.mockResolvedValue({\r\n        data: mockOrder,\r\n        error: null,\r\n        isExisting: false,\r\n      });\r\n\r\n      const mockInsert = vi.fn();",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 743,
        "end": 761,
        "startLoc": {
          "line": 743,
          "column": 61,
          "position": 6965
        },
        "endLoc": {
          "line": 761,
          "column": 2,
          "position": 7110
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 624,
        "end": 683,
        "startLoc": {
          "line": 624,
          "column": 60,
          "position": 5850
        },
        "endLoc": {
          "line": 683,
          "column": 2,
          "position": 6356
        }
      }
    },
    {
      "format": "typescript",
      "lines": 34,
      "fragment": ");\r\n      const mockFrom = vi.fn((tableName: string) => {\r\n        if (tableName === 'sellers') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: { id: 'seller-123', user_id: 'seller-user-123' },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if (tableName === 'services') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({\r\n              data: {\r\n                id: 'service-123',\r\n                title: 'Test Service',\r\n                price: 10000,\r\n                delivery_days: 7,\r\n                revision_count: 2,\r\n              },\r\n              error: null,\r\n            }),\r\n          };\r\n        }\r\n        if (tableName === 'chat_rooms') {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            maybeSingle: vi.fn().mockResolvedValue({\r\n              data: {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 761,
        "end": 794,
        "startLoc": {
          "line": 761,
          "column": 2,
          "position": 7109
        },
        "endLoc": {
          "line": 794,
          "column": 2,
          "position": 7460
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 414,
        "end": 581,
        "startLoc": {
          "line": 414,
          "column": 2,
          "position": 3731
        },
        "endLoc": {
          "line": 581,
          "column": 5,
          "position": 5446
        }
      }
    },
    {
      "format": "typescript",
      "lines": 26,
      "fragment": "}),\r\n            insert: mockInsert,\r\n          };\r\n        }\r\n        return {\r\n          select: vi.fn().mockReturnThis(),\r\n          eq: vi.fn().mockReturnThis(),\r\n          single: vi.fn().mockResolvedValue({ data: null, error: null }),\r\n        };\r\n      });\r\n\r\n      mockSupabase.from = mockFrom;\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      await POST(request);\r\n\r\n      expect(mockInsert).not",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 796,
        "end": 821,
        "startLoc": {
          "line": 796,
          "column": 13,
          "position": 7480
        },
        "endLoc": {
          "line": 821,
          "column": 4,
          "position": 7696
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 715,
        "end": 740,
        "startLoc": {
          "line": 715,
          "column": 2,
          "position": 6731
        },
        "endLoc": {
          "line": 740,
          "column": 17,
          "position": 6947
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/payments/direct-purchase', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          seller_id: 'seller-123',\r\n          service_id: 'service-123',\r\n          title: 'Test Service',\r\n          amount: 10000,\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 830,
        "end": 846,
        "startLoc": {
          "line": 830,
          "column": 2,
          "position": 7767
        },
        "endLoc": {
          "line": 846,
          "column": 16,
          "position": 7915
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 69,
        "end": 621,
        "startLoc": {
          "line": 69,
          "column": 2,
          "position": 541
        },
        "endLoc": {
          "line": 621,
          "column": 11,
          "position": 5833
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ",\r\n        }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('  ');\r\n    });\r\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\direct-purchase.test.ts",
        "start": 838,
        "end": 848,
        "startLoc": {
          "line": 838,
          "column": 6,
          "position": 7838
        },
        "endLoc": {
          "line": 848,
          "column": 2,
          "position": 7927
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 672,
        "end": 683,
        "startLoc": {
          "line": 672,
          "column": 39,
          "position": 5485
        },
        "endLoc": {
          "line": 683,
          "column": 3,
          "position": 5565
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Payment Requests API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\payment-requests\\payment-requests.test.ts",
        "start": 21,
        "end": 32,
        "startLoc": {
          "line": 21,
          "column": 13,
          "position": 268
        },
        "endLoc": {
          "line": 32,
          "column": 23,
          "position": 354
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 10,
        "end": 25,
        "startLoc": {
          "line": 10,
          "column": 2,
          "position": 110
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ": any;\n\n  beforeEach(async () => {\n    // Setup Supabase mock\n    mockSupabase = {\n      auth: {\n        getUser: vi.fn(),\n      },\n      from: vi.fn(),\n    };\n\n    mockCreateClient = vi.fn().mockResolvedValue(mockSupabase);\n\n    // Setup rate limit mock (success by default)\n    mockCheckRateLimit = vi.fn().mockResolvedValue({ success: true });\n\n    // Apply mocks",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 22,
        "end": 38,
        "startLoc": {
          "line": 22,
          "column": 19,
          "position": 128
        },
        "endLoc": {
          "line": 38,
          "column": 15,
          "position": 240
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 28,
        "end": 44,
        "startLoc": {
          "line": 28,
          "column": 26,
          "position": 168
        },
        "endLoc": {
          "line": 44,
          "column": 26,
          "position": 280
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ");\n  });\n\n  afterEach(() => {\n    vi.clearAllMocks();\n  });\n\n  /**\n   * Authentication Tests\n   */\n  describe('Authentication', () => {\n    it('should return 401 when user is not authenticated (auth error)', async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: null },\n        error: { message: 'Not authenticated' },\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 43,
        "end": 60,
        "startLoc": {
          "line": 43,
          "column": 19,
          "position": 302
        },
        "endLoc": {
          "line": 60,
          "column": 52,
          "position": 422
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 63,
        "end": 80,
        "startLoc": {
          "line": 63,
          "column": 26,
          "position": 448
        },
        "endLoc": {
          "line": 80,
          "column": 44,
          "position": 568
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe(' ');\n    });\n\n    it('should return 401 when user is null', async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: null },\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 66,
        "end": 79,
        "startLoc": {
          "line": 66,
          "column": 2,
          "position": 500
        },
        "endLoc": {
          "line": 79,
          "column": 52,
          "position": 618
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 88,
        "end": 101,
        "startLoc": {
          "line": 88,
          "column": 8,
          "position": 627
        },
        "endLoc": {
          "line": 101,
          "column": 44,
          "position": 745
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe(' ');\n    });\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 76,
        "end": 91,
        "startLoc": {
          "line": 76,
          "column": 5,
          "position": 599
        },
        "endLoc": {
          "line": 91,
          "column": 2,
          "position": 750
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 57,
        "end": 73,
        "startLoc": {
          "line": 57,
          "column": 2,
          "position": 403
        },
        "endLoc": {
          "line": 73,
          "column": 3,
          "position": 555
        }
      }
    },
    {
      "format": "typescript",
      "lines": 22,
      "fragment": ");\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe(' ');\n    });\n  });\n\n  /**\n   * Rate Limiting Tests\n   */\n  describe('Rate Limiting', () => {\n    it('should return 429 when rate limit is exceeded', async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'user-123' } },\n        error: null,\n      });\n\n      const rateLimitResponse = new Response(\n        JSON.stringify({\n          error: '   .    .',\n          limit: 20",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 85,
        "end": 106,
        "startLoc": {
          "line": 85,
          "column": 2,
          "position": 696
        },
        "endLoc": {
          "line": 106,
          "column": 3,
          "position": 861
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 109,
        "end": 130,
        "startLoc": {
          "line": 109,
          "column": 8,
          "position": 804
        },
        "endLoc": {
          "line": 130,
          "column": 2,
          "position": 969
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n\n      expect",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 115,
        "end": 126,
        "startLoc": {
          "line": 115,
          "column": 18,
          "position": 925
        },
        "endLoc": {
          "line": 126,
          "column": 7,
          "position": 1027
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 57,
        "end": 67,
        "startLoc": {
          "line": 57,
          "column": 2,
          "position": 403
        },
        "endLoc": {
          "line": 67,
          "column": 6,
          "position": 504
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ");\n\n      expect(response.status).toBe(429);\n    });\n  });\n\n  /**\n   * Input Validation Tests\n   */\n  describe('Input Validation', () => {\n    beforeEach(() => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'user-123' } },\n        error: null,\n      });\n    });\n\n    it('should return 400 when status is missing'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 124,
        "end": 141,
        "startLoc": {
          "line": 124,
          "column": 2,
          "position": 1022
        },
        "endLoc": {
          "line": 141,
          "column": 43,
          "position": 1130
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 150,
        "end": 167,
        "startLoc": {
          "line": 150,
          "column": 8,
          "position": 1111
        },
        "endLoc": {
          "line": 167,
          "column": 47,
          "position": 1219
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "}),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('  ');\n    });\n\n    it('should return 400 when status is invalid'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 158,
        "end": 169,
        "startLoc": {
          "line": 158,
          "column": 2,
          "position": 1332
        },
        "endLoc": {
          "line": 169,
          "column": 43,
          "position": 1440
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 62,
        "end": 155,
        "startLoc": {
          "line": 62,
          "column": 2,
          "position": 449
        },
        "endLoc": {
          "line": 155,
          "column": 48,
          "position": 1282
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "{\n        mockSupabase.from.mockReturnValue({\n          select: vi.fn().mockReturnThis(),\n          eq: vi.fn().mockReturnThis(),\n          single: vi.fn().mockResolvedValue({\n            data: null,\n            error: { message: 'Not found' },\n          }),\n        });\n\n        const request = new NextRequest('http://localhost:3000/api/orders/order-123/status'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 194,
        "end": 204,
        "startLoc": {
          "line": 194,
          "column": 2,
          "position": 1665
        },
        "endLoc": {
          "line": 204,
          "column": 52,
          "position": 1763
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 225,
        "end": 235,
        "startLoc": {
          "line": 225,
          "column": 2,
          "position": 1713
        },
        "endLoc": {
          "line": 235,
          "column": 44,
          "position": 1811
        }
      }
    },
    {
      "format": "typescript",
      "lines": 27,
      "fragment": "});\n  });\n\n  /**\n   * Order Validation Tests\n   */\n  describe('Order Validation', () => {\n    beforeEach(() => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'user-123' } },\n        error: null,\n      });\n    });\n\n    it('should return 404 when order is not found', async () => {\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: null,\n          error: { message: 'Not found' },\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status:",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 217,
        "end": 243,
        "startLoc": {
          "line": 217,
          "column": 5,
          "position": 1893
        },
        "endLoc": {
          "line": 243,
          "column": 2,
          "position": 2113
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 211,
        "end": 206,
        "startLoc": {
          "line": 211,
          "column": 5,
          "position": 1614
        },
        "endLoc": {
          "line": 206,
          "column": 2,
          "position": 1787
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ",\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(404",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 238,
        "end": 250,
        "startLoc": {
          "line": 238,
          "column": 2,
          "position": 2071
        },
        "endLoc": {
          "line": 250,
          "column": 4,
          "position": 2198
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 57,
        "end": 69,
        "startLoc": {
          "line": 57,
          "column": 2,
          "position": 403
        },
        "endLoc": {
          "line": 69,
          "column": 4,
          "position": 530
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ",\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(403",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 265,
        "end": 278,
        "startLoc": {
          "line": 265,
          "column": 5,
          "position": 2333
        },
        "endLoc": {
          "line": 278,
          "column": 4,
          "position": 2465
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 237,
        "end": 69,
        "startLoc": {
          "line": 237,
          "column": 2,
          "position": 2066
        },
        "endLoc": {
          "line": 69,
          "column": 4,
          "position": 530
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": ", async () => {\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'delivered',\n          },\n          error: null,\n        }),\n        update: vi.fn().mockReturnValue({\n          eq: vi.fn().mockResolvedValue({ error: null }),\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'dispute'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 326,
        "end": 346,
        "startLoc": {
          "line": 326,
          "column": 61,
          "position": 2897
        },
        "endLoc": {
          "line": 346,
          "column": 10,
          "position": 3095
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 225,
        "end": 314,
        "startLoc": {
          "line": 225,
          "column": 44,
          "position": 1704
        },
        "endLoc": {
          "line": 314,
          "column": 12,
          "position": 2772
        }
      }
    },
    {
      "format": "typescript",
      "lines": 26,
      "fragment": ", async () => {\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'in_progress',\n          },\n          error: null,\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.error).toContain",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 358,
        "end": 383,
        "startLoc": {
          "line": 358,
          "column": 69,
          "position": 3220
        },
        "endLoc": {
          "line": 383,
          "column": 10,
          "position": 3471
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 225,
        "end": 152,
        "startLoc": {
          "line": 225,
          "column": 44,
          "position": 1704
        },
        "endLoc": {
          "line": 152,
          "column": 5,
          "position": 1267
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'in_progress',\n          },\n          error: null,\n        }),\n        update",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 395,
        "end": 407,
        "startLoc": {
          "line": 395,
          "column": 7,
          "position": 3586
        },
        "endLoc": {
          "line": 407,
          "column": 7,
          "position": 3689
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 255,
        "end": 267,
        "startLoc": {
          "line": 255,
          "column": 7,
          "position": 2238
        },
        "endLoc": {
          "line": 267,
          "column": 2,
          "position": 2341
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\n          },\n          error: null,\n        }),\n        update: vi.fn().mockReturnValue({\n          eq: vi.fn().mockResolvedValue({ error: null }),\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 403,
        "end": 414,
        "startLoc": {
          "line": 403,
          "column": 14,
          "position": 3670
        },
        "endLoc": {
          "line": 414,
          "column": 12,
          "position": 3772
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 303,
        "end": 314,
        "startLoc": {
          "line": 303,
          "column": 12,
          "position": 2670
        },
        "endLoc": {
          "line": 314,
          "column": 12,
          "position": 2772
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n      expect(data.status).toBe('delivered'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 408,
        "end": 423,
        "startLoc": {
          "line": 408,
          "column": 2,
          "position": 3723
        },
        "endLoc": {
          "line": 423,
          "column": 12,
          "position": 3883
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 237,
        "end": 323,
        "startLoc": {
          "line": 237,
          "column": 2,
          "position": 2066
        },
        "endLoc": {
          "line": 323,
          "column": 12,
          "position": 2883
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ", async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'seller-123' } },\n        error: null,\n      });\n\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'revision'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 426,
        "end": 440,
        "startLoc": {
          "line": 426,
          "column": 65,
          "position": 3897
        },
        "endLoc": {
          "line": 440,
          "column": 11,
          "position": 4037
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 389,
        "end": 263,
        "startLoc": {
          "line": 389,
          "column": 66,
          "position": 3529
        },
        "endLoc": {
          "line": 263,
          "column": 14,
          "position": 2321
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ",\n          },\n          error: null,\n        }),\n        update: vi.fn().mockReturnValue({\n          eq: vi.fn().mockResolvedValue({ error: null }),\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'in_progress'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 440,
        "end": 451,
        "startLoc": {
          "line": 440,
          "column": 11,
          "position": 4038
        },
        "endLoc": {
          "line": 451,
          "column": 14,
          "position": 4140
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 303,
        "end": 314,
        "startLoc": {
          "line": 303,
          "column": 12,
          "position": 2670
        },
        "endLoc": {
          "line": 314,
          "column": 12,
          "position": 2772
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ", async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'seller-123' } },\n        error: null,\n      });\n\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'delivered',\n          },\n          error: null,\n        }),\n      }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 463,
        "end": 481,
        "startLoc": {
          "line": 463,
          "column": 68,
          "position": 4265
        },
        "endLoc": {
          "line": 481,
          "column": 2,
          "position": 4425
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 389,
        "end": 307,
        "startLoc": {
          "line": 389,
          "column": 66,
          "position": 3529
        },
        "endLoc": {
          "line": 307,
          "column": 7,
          "position": 2689
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'completed' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.error).toContain('  ');\n      expect(data.current_status).toBe('delivered'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 479,
        "end": 494,
        "startLoc": {
          "line": 479,
          "column": 5,
          "position": 4417
        },
        "endLoc": {
          "line": 494,
          "column": 12,
          "position": 4577
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 308,
        "end": 384,
        "startLoc": {
          "line": 308,
          "column": 2,
          "position": 2723
        },
        "endLoc": {
          "line": 384,
          "column": 14,
          "position": 3487
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ",\n      });\n\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'in_progress',\n          },\n          error: null,\n        }),\n        update: mockUpdate",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 513,
        "end": 528,
        "startLoc": {
          "line": 513,
          "column": 2,
          "position": 4749
        },
        "endLoc": {
          "line": 528,
          "column": 11,
          "position": 4864
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 392,
        "end": 407,
        "startLoc": {
          "line": 392,
          "column": 5,
          "position": 3577
        },
        "endLoc": {
          "line": 407,
          "column": 3,
          "position": 3692
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": "const mockUpdate = vi.fn().mockReturnValue({\n        eq: vi.fn().mockResolvedValue({ error: null }),\n      });\n\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'delivered',\n          },\n          error: null,\n        }),\n        update: mockUpdate",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 554,
        "end": 570,
        "startLoc": {
          "line": 554,
          "column": 7,
          "position": 5082
        },
        "endLoc": {
          "line": 570,
          "column": 11,
          "position": 5234
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 512,
        "end": 307,
        "startLoc": {
          "line": 512,
          "column": 7,
          "position": 4712
        },
        "endLoc": {
          "line": 307,
          "column": 3,
          "position": 2692
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ", async () => {\n      const mockUpdate = vi.fn().mockReturnValue({\n        eq: vi.fn().mockResolvedValue({ error: null }),\n      });\n\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'revision',\n          },\n          error: null,\n        }),\n        update: mockUpdate",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 590,
        "end": 607,
        "startLoc": {
          "line": 590,
          "column": 54,
          "position": 5395
        },
        "endLoc": {
          "line": 607,
          "column": 11,
          "position": 5559
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 511,
        "end": 444,
        "startLoc": {
          "line": 511,
          "column": 51,
          "position": 4700
        },
        "endLoc": {
          "line": 444,
          "column": 3,
          "position": 4060
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\n      mockSupabase.from.mockReturnValue({\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        single: vi.fn().mockResolvedValue({\n          data: {\n            id: 'order-123',\n            buyer_id: 'buyer-123',\n            seller_id: 'seller-123',\n            status: 'in_progress',\n          },\n          error: null,\n        }),\n        update: vi.fn().mockReturnValue({\n          eq: vi.fn().mockResolvedValue({\n            error: {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 636,
        "end": 651,
        "startLoc": {
          "line": 636,
          "column": 38,
          "position": 5780
        },
        "endLoc": {
          "line": 651,
          "column": 2,
          "position": 5926
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 225,
        "end": 408,
        "startLoc": {
          "line": 225,
          "column": 44,
          "position": 1704
        },
        "endLoc": {
          "line": 408,
          "column": 5,
          "position": 3719
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "}),\n        }),\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 652,
        "end": 665,
        "startLoc": {
          "line": 652,
          "column": 11,
          "position": 5937
        },
        "endLoc": {
          "line": 665,
          "column": 4,
          "position": 6071
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 408,
        "end": 69,
        "startLoc": {
          "line": 408,
          "column": 2,
          "position": 3721
        },
        "endLoc": {
          "line": 69,
          "column": 4,
          "position": 530
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/orders/order-123/status', {\n        method: 'PATCH',\n        body: JSON.stringify({ status: 'delivered' }),\n      });\n\n      const params = Promise.resolve({ id: 'order-123' });\n      const response = await PATCH(request, { params });\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 675,
        "end": 687,
        "startLoc": {
          "line": 675,
          "column": 2,
          "position": 6146
        },
        "endLoc": {
          "line": 687,
          "column": 16,
          "position": 6283
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\status.test.ts",
        "start": 58,
        "end": 666,
        "startLoc": {
          "line": 58,
          "column": 2,
          "position": 407
        },
        "endLoc": {
          "line": 666,
          "column": 21,
          "position": 6085
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": "const mockSupabase = {\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\n// Mock withAuth to pass user directly",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 6,
        "end": 22,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 59
        },
        "endLoc": {
          "line": 22,
          "column": 39,
          "position": 205
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 5,
        "end": 21,
        "startLoc": {
          "line": 5,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 21,
          "column": 51,
          "position": 194
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/seller');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 137,
        "end": 147,
        "startLoc": {
          "line": 137,
          "column": 2,
          "position": 1534
        },
        "endLoc": {
          "line": 147,
          "column": 4,
          "position": 1623
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 82,
        "end": 92,
        "startLoc": {
          "line": 82,
          "column": 2,
          "position": 914
        },
        "endLoc": {
          "line": 92,
          "column": 4,
          "position": 1003
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "],\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/orders/seller');\n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.orders).toEqual([]);\n    });\n\n    it('should handle database errors'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-orders.test.ts",
        "start": 81,
        "end": 93,
        "startLoc": {
          "line": 81,
          "column": 2,
          "position": 814
        },
        "endLoc": {
          "line": 93,
          "column": 32,
          "position": 915
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-orders.test.ts",
        "start": 67,
        "end": 96,
        "startLoc": {
          "line": 67,
          "column": 2,
          "position": 689
        },
        "endLoc": {
          "line": 96,
          "column": 26,
          "position": 1035
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/orders/seller');\n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBeDefined();\n    });\n  });\n});",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-orders.test.ts",
        "start": 97,
        "end": 107,
        "startLoc": {
          "line": 97,
          "column": 2,
          "position": 959
        },
        "endLoc": {
          "line": 107,
          "column": 2,
          "position": 1049
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 140,
        "end": 151,
        "startLoc": {
          "line": 140,
          "column": 11,
          "position": 1554
        },
        "endLoc": {
          "line": 151,
          "column": 2,
          "position": 1656
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Seller Orders Count API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-count.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 38,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 26,
          "position": 231
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/seller/count');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-count.test.ts",
        "start": 92,
        "end": 102,
        "startLoc": {
          "line": 92,
          "column": 2,
          "position": 940
        },
        "endLoc": {
          "line": 102,
          "column": 4,
          "position": 1029
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-count.test.ts",
        "start": 63,
        "end": 73,
        "startLoc": {
          "line": 63,
          "column": 2,
          "position": 647
        },
        "endLoc": {
          "line": 73,
          "column": 4,
          "position": 736
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n    warn",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 3,
        "end": 22,
        "startLoc": {
          "line": 3,
          "column": 39,
          "position": 51
        },
        "endLoc": {
          "line": 22,
          "column": 5,
          "position": 217
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 18,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 18,
          "column": 2,
          "position": 182
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "}),\r\n      });\r\n\r\n      const response = await POST(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(400);\r\n      expect(data.error).toBe('   ');\r\n    });\r\n\r\n    it('should return 404 if order not found'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 78,
        "end": 89,
        "startLoc": {
          "line": 78,
          "column": 2,
          "position": 852
        },
        "endLoc": {
          "line": 89,
          "column": 39,
          "position": 977
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 40,
        "end": 70,
        "startLoc": {
          "line": 40,
          "column": 2,
          "position": 402
        },
        "endLoc": {
          "line": 70,
          "column": 39,
          "position": 749
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/order-1/revision', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ reason: 'Please fix this' }),\r\n      });\r\n\r\n      const response = await POST(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(404",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 101,
        "end": 112,
        "startLoc": {
          "line": 101,
          "column": 12,
          "position": 1134
        },
        "endLoc": {
          "line": 112,
          "column": 4,
          "position": 1274
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 36,
        "end": 47,
        "startLoc": {
          "line": 36,
          "column": 2,
          "position": 356
        },
        "endLoc": {
          "line": 47,
          "column": 4,
          "position": 496
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(selectChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/order-1/revision', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ reason: 'Please fix this' }),\r\n      });\r\n\r\n      const response = await POST(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(403",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 126,
        "end": 140,
        "startLoc": {
          "line": 126,
          "column": 2,
          "position": 1459
        },
        "endLoc": {
          "line": 140,
          "column": 4,
          "position": 1619
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 98,
        "end": 47,
        "startLoc": {
          "line": 98,
          "column": 2,
          "position": 1114
        },
        "endLoc": {
          "line": 47,
          "column": 4,
          "position": 496
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const mockOrder = { id: 'order-1', buyer_id: 'user-1' };\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 189,
        "end": 201,
        "startLoc": {
          "line": 189,
          "column": 35,
          "position": 2160
        },
        "endLoc": {
          "line": 201,
          "column": 7,
          "position": 2295
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 144,
        "end": 156,
        "startLoc": {
          "line": 144,
          "column": 46,
          "position": 1651
        },
        "endLoc": {
          "line": 156,
          "column": 16,
          "position": 1786
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "});\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/order-1/revision', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ reason: 'Please fix this' }),\r\n      });\r\n\r\n      const response = await POST(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 212,
        "end": 223,
        "startLoc": {
          "line": 212,
          "column": 7,
          "position": 2438
        },
        "endLoc": {
          "line": 223,
          "column": 4,
          "position": 2579
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 36,
        "end": 47,
        "startLoc": {
          "line": 36,
          "column": 7,
          "position": 355
        },
        "endLoc": {
          "line": 47,
          "column": 4,
          "position": 496
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/order-1/revision', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ reason: 'Please fix this' }),\r\n      });\r\n\r\n      const response = await POST(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n\r\n      expect(response).toBeDefined();\r\n      const data = await response!.json();\r\n      expect(response!.status).toBe(500);\r\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 228,
        "end": 240,
        "startLoc": {
          "line": 228,
          "column": 2,
          "position": 2638
        },
        "endLoc": {
          "line": 240,
          "column": 16,
          "position": 2793
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 36,
        "end": 224,
        "startLoc": {
          "line": 36,
          "column": 2,
          "position": 356
        },
        "endLoc": {
          "line": 224,
          "column": 16,
          "position": 2594
        }
      }
    },
    {
      "format": "typescript",
      "lines": 24,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n    warn: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Complete Revision API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 3,
        "end": 26,
        "startLoc": {
          "line": 3,
          "column": 48,
          "position": 51
        },
        "endLoc": {
          "line": 26,
          "column": 24,
          "position": 243
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 26,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 26,
          "column": 21,
          "position": 243
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "} },\r\n        error: null,\r\n      });\r\n\r\n      const selectChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: null, error: { message: 'Not found' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(selectChain);\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 54,
        "end": 67,
        "startLoc": {
          "line": 54,
          "column": 2,
          "position": 542
        },
        "endLoc": {
          "line": 67,
          "column": 61,
          "position": 678
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 91,
        "end": 103,
        "startLoc": {
          "line": 91,
          "column": 2,
          "position": 1018
        },
        "endLoc": {
          "line": 103,
          "column": 52,
          "position": 1151
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision',\r\n        {\r\n          method: 'PATCH',\r\n        }\r\n      );\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(404",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 64,
        "end": 76,
        "startLoc": {
          "line": 64,
          "column": 12,
          "position": 658
        },
        "endLoc": {
          "line": 76,
          "column": 4,
          "position": 772
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 36,
        "end": 48,
        "startLoc": {
          "line": 36,
          "column": 2,
          "position": 356
        },
        "endLoc": {
          "line": 48,
          "column": 4,
          "position": 470
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "};\r\n      const selectChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(selectChain);\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 86,
        "end": 96,
        "startLoc": {
          "line": 86,
          "column": 2,
          "position": 892
        },
        "endLoc": {
          "line": 96,
          "column": 61,
          "position": 1003
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 122,
        "end": 131,
        "startLoc": {
          "line": 122,
          "column": 2,
          "position": 1388
        },
        "endLoc": {
          "line": 131,
          "column": 52,
          "position": 1496
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(selectChain);\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision',\r\n        {\r\n          method: 'PATCH',\r\n        }\r\n      );\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(403",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 90,
        "end": 105,
        "startLoc": {
          "line": 90,
          "column": 2,
          "position": 963
        },
        "endLoc": {
          "line": 105,
          "column": 4,
          "position": 1097
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 61,
        "end": 48,
        "startLoc": {
          "line": 61,
          "column": 2,
          "position": 638
        },
        "endLoc": {
          "line": 48,
          "column": 4,
          "position": 470
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": "};\r\n      const selectChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(selectChain);\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision',\r\n        {\r\n          method: 'PATCH',\r\n        }\r\n      );\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 115,
        "end": 134,
        "startLoc": {
          "line": 115,
          "column": 2,
          "position": 1217
        },
        "endLoc": {
          "line": 134,
          "column": 4,
          "position": 1422
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 122,
        "end": 48,
        "startLoc": {
          "line": 122,
          "column": 2,
          "position": 1388
        },
        "endLoc": {
          "line": 48,
          "column": 4,
          "position": 470
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": "};\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          // Order lookup\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n          };\r\n        } else if (callCount === 2) {\r\n          // Update order status\r\n          return {\r\n            update: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockResolvedValue({ error: null }),\r\n          };\r\n        } else {\r\n          // Update revision history",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 144,
        "end": 163,
        "startLoc": {
          "line": 144,
          "column": 2,
          "position": 1542
        },
        "endLoc": {
          "line": 163,
          "column": 27,
          "position": 1753
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 150,
        "end": 169,
        "startLoc": {
          "line": 150,
          "column": 2,
          "position": 1733
        },
        "endLoc": {
          "line": 169,
          "column": 27,
          "position": 1944
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "});\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision',\r\n        {\r\n          method: 'PATCH',\r\n        }\r\n      );\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 172,
        "end": 184,
        "startLoc": {
          "line": 172,
          "column": 7,
          "position": 1860
        },
        "endLoc": {
          "line": 184,
          "column": 4,
          "position": 1975
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 36,
        "end": 48,
        "startLoc": {
          "line": 36,
          "column": 7,
          "position": 355
        },
        "endLoc": {
          "line": 48,
          "column": 4,
          "position": 470
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'seller-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const mockOrder = { id: 'order-1', seller_id: 'seller-1', status: 'revision' };\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 188,
        "end": 200,
        "startLoc": {
          "line": 188,
          "column": 29,
          "position": 2007
        },
        "endLoc": {
          "line": 200,
          "column": 7,
          "position": 2148
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 138,
        "end": 150,
        "startLoc": {
          "line": 138,
          "column": 40,
          "position": 1454
        },
        "endLoc": {
          "line": 150,
          "column": 16,
          "position": 1595
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": "};\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            single: vi.fn().mockResolvedValue({ data: mockOrder, error: null }),\r\n          };\r\n        } else {\r\n          return {\r\n            update: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockResolvedValue({ error: { message: 'Update error' } }),\r\n          };\r\n        }\r\n      });\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 194,
        "end": 214,
        "startLoc": {
          "line": 194,
          "column": 2,
          "position": 2095
        },
        "endLoc": {
          "line": 214,
          "column": 61,
          "position": 2312
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 195,
        "end": 214,
        "startLoc": {
          "line": 195,
          "column": 2,
          "position": 2242
        },
        "endLoc": {
          "line": 214,
          "column": 52,
          "position": 2456
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "}),\r\n          };\r\n        }\r\n      });\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision',\r\n        {\r\n          method: 'PATCH',\r\n        }\r\n      );\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 208,
        "end": 223,
        "startLoc": {
          "line": 208,
          "column": 2,
          "position": 2276
        },
        "endLoc": {
          "line": 223,
          "column": 4,
          "position": 2406
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 169,
        "end": 48,
        "startLoc": {
          "line": 169,
          "column": 2,
          "position": 1845
        },
        "endLoc": {
          "line": 48,
          "column": 4,
          "position": 470
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\r\n\r\n      const request = new NextRequest(\r\n        'http://localhost:3000/api/orders/order-1/complete-revision',\r\n        {\r\n          method: 'PATCH',\r\n        }\r\n      );\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'order-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 228,
        "end": 241,
        "startLoc": {
          "line": 228,
          "column": 2,
          "position": 2465
        },
        "endLoc": {
          "line": 241,
          "column": 16,
          "position": 2594
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\complete-revision.test.ts",
        "start": 36,
        "end": 224,
        "startLoc": {
          "line": 36,
          "column": 2,
          "position": 356
        },
        "endLoc": {
          "line": 224,
          "column": 19,
          "position": 2421
        }
      }
    },
    {
      "format": "typescript",
      "lines": 24,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\n// Mock withAuth to pass user directly\r\nvi.mock('@/lib/api/auth-middleware', () => ({\r\n  withAuth: vi.fn((handler) => {\r\n    return async (request: NextRequest) => {\r\n      // Simulate authenticated user",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer.test.ts",
        "start": 3,
        "end": 26,
        "startLoc": {
          "line": 3,
          "column": 31,
          "position": 51
        },
        "endLoc": {
          "line": 26,
          "column": 31,
          "position": 259
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 3,
        "end": 26,
        "startLoc": {
          "line": 3,
          "column": 32,
          "position": 51
        },
        "endLoc": {
          "line": 26,
          "column": 6,
          "position": 259
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ");\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(data.orders).toHaveLength(1);\r\n    });\r\n\r\n    it('should handle database error', async () => {\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer.test.ts",
        "start": 91,
        "end": 109,
        "startLoc": {
          "line": 91,
          "column": 53,
          "position": 946
        },
        "endLoc": {
          "line": 109,
          "column": 41,
          "position": 1152
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 124,
        "end": 282,
        "startLoc": {
          "line": 124,
          "column": 59,
          "position": 1365
        },
        "endLoc": {
          "line": 282,
          "column": 51,
          "position": 3027
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer.test.ts",
        "start": 104,
        "end": 114,
        "startLoc": {
          "line": 104,
          "column": 2,
          "position": 1115
        },
        "endLoc": {
          "line": 114,
          "column": 4,
          "position": 1204
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer.test.ts",
        "start": 58,
        "end": 68,
        "startLoc": {
          "line": 58,
          "column": 2,
          "position": 607
        },
        "endLoc": {
          "line": 68,
          "column": 4,
          "position": 696
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "};\n    return handler(request, mockUser);\n  },\n}));\n\n// Mock Supabase\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst mockSupabase: Record<string, any> = {\n  from: vi.fn(() => mockSupabase),\n  select: vi.fn(() => mockSupabase),\n  eq: vi.fn(() => mockSupabase),\n  order",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-orders.test.ts",
        "start": 7,
        "end": 18,
        "startLoc": {
          "line": 7,
          "column": 2,
          "position": 102
        },
        "endLoc": {
          "line": 18,
          "column": 6,
          "position": 200
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-orders.test.ts",
        "start": 7,
        "end": 18,
        "startLoc": {
          "line": 7,
          "column": 2,
          "position": 102
        },
        "endLoc": {
          "line": 18,
          "column": 3,
          "position": 200
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ": vi.fn(() => mockSupabase),\n  order: vi.fn(() => mockSupabase),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/api/error-handler', () => ({\n  ApiError: class ApiError extends Error {\n    status: number;\n    constructor(message: string, status: number) {\n      super(message);\n      this.status = status;\n    }\n  },\n  handleApiError: vi.fn((error: Error & { status?: number }) => {\n    const { NextResponse } = require('next/server');\n    return NextResponse.json({ error: error.message }, { status: error.status || 500 });\n  }),\n}));\n\nimport { GET } from '@/app/api/orders/buyer/route'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-orders.test.ts",
        "start": 17,
        "end": 39,
        "startLoc": {
          "line": 17,
          "column": 3,
          "position": 184
        },
        "endLoc": {
          "line": 39,
          "column": 31,
          "position": 445
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-orders.test.ts",
        "start": 18,
        "end": 40,
        "startLoc": {
          "line": 18,
          "column": 3,
          "position": 201
        },
        "endLoc": {
          "line": 40,
          "column": 32,
          "position": 462
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer');\n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.orders).toHaveLength(2);\n    });\n\n    it('should handle status filter parameter'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-orders.test.ts",
        "start": 72,
        "end": 82,
        "startLoc": {
          "line": 72,
          "column": 2,
          "position": 740
        },
        "endLoc": {
          "line": 82,
          "column": 40,
          "position": 828
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer.test.ts",
        "start": 61,
        "end": 72,
        "startLoc": {
          "line": 61,
          "column": 11,
          "position": 627
        },
        "endLoc": {
          "line": 72,
          "column": 26,
          "position": 727
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer');\n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBeDefined();\n    });\n\n    it",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-orders.test.ts",
        "start": 114,
        "end": 124,
        "startLoc": {
          "line": 114,
          "column": 2,
          "position": 1095
        },
        "endLoc": {
          "line": 124,
          "column": 3,
          "position": 1180
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer.test.ts",
        "start": 107,
        "end": 117,
        "startLoc": {
          "line": 107,
          "column": 11,
          "position": 1135
        },
        "endLoc": {
          "line": 117,
          "column": 2,
          "position": 1230
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Buyer Orders Count API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 25,
          "position": 231
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(401);\r\n      expect(data.error).toBe(' ');\r\n    });\r\n\r\n    it('should return order counts by status', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 37,
        "end": 48,
        "startLoc": {
          "line": 37,
          "column": 47,
          "position": 362
        },
        "endLoc": {
          "line": 48,
          "column": 9,
          "position": 483
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-count.test.ts",
        "start": 37,
        "end": 48,
        "startLoc": {
          "line": 37,
          "column": 48,
          "position": 362
        },
        "endLoc": {
          "line": 48,
          "column": 11,
          "position": 483
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "},\r\n      ];\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: mockOrders, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer/count'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 60,
        "end": 70,
        "startLoc": {
          "line": 60,
          "column": 2,
          "position": 609
        },
        "endLoc": {
          "line": 70,
          "column": 47,
          "position": 708
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-count.test.ts",
        "start": 58,
        "end": 68,
        "startLoc": {
          "line": 58,
          "column": 2,
          "position": 585
        },
        "endLoc": {
          "line": 68,
          "column": 48,
          "position": 684
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer/count');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(data.counts.",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 94,
        "end": 105,
        "startLoc": {
          "line": 94,
          "column": 2,
          "position": 951
        },
        "endLoc": {
          "line": 105,
          "column": 2,
          "position": 1058
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 65,
        "end": 76,
        "startLoc": {
          "line": 65,
          "column": 11,
          "position": 664
        },
        "endLoc": {
          "line": 76,
          "column": 2,
          "position": 771
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\r\n    });\r\n\r\n    it('should handle database error', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: null",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 105,
        "end": 116,
        "startLoc": {
          "line": 105,
          "column": 2,
          "position": 1065
        },
        "endLoc": {
          "line": 116,
          "column": 5,
          "position": 1186
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 202,
        "end": 94,
        "startLoc": {
          "line": 202,
          "column": 3,
          "position": 2178
        },
        "endLoc": {
          "line": 94,
          "column": 2,
          "position": 949
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "} },\r\n        error: null,\r\n      });\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer/count'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 110,
        "end": 121,
        "startLoc": {
          "line": 110,
          "column": 2,
          "position": 1121
        },
        "endLoc": {
          "line": 121,
          "column": 47,
          "position": 1238
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller-count.test.ts",
        "start": 86,
        "end": 97,
        "startLoc": {
          "line": 86,
          "column": 2,
          "position": 860
        },
        "endLoc": {
          "line": 97,
          "column": 48,
          "position": 977
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/orders/buyer/count');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 116,
        "end": 126,
        "startLoc": {
          "line": 116,
          "column": 2,
          "position": 1201
        },
        "endLoc": {
          "line": 126,
          "column": 4,
          "position": 1290
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\buyer-count.test.ts",
        "start": 65,
        "end": 75,
        "startLoc": {
          "line": 65,
          "column": 2,
          "position": 671
        },
        "endLoc": {
          "line": 75,
          "column": 4,
          "position": 760
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\ndescribe('Notifications Read All API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\read-all.test.ts",
        "start": 13,
        "end": 28,
        "startLoc": {
          "line": 13,
          "column": 13,
          "position": 142
        },
        "endLoc": {
          "line": 28,
          "column": 29,
          "position": 258
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 2,
          "position": 65
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/notifications/read-all', {\n        method: 'PATCH',\n      });\n\n      const response = await PATCH(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\read-all.test.ts",
        "start": 97,
        "end": 107,
        "startLoc": {
          "line": 97,
          "column": 2,
          "position": 916
        },
        "endLoc": {
          "line": 107,
          "column": 16,
          "position": 1005
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\read-all.test.ts",
        "start": 83,
        "end": 93,
        "startLoc": {
          "line": 83,
          "column": 2,
          "position": 787
        },
        "endLoc": {
          "line": 93,
          "column": 19,
          "position": 876
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Notifications API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notifications.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 32,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 20,
          "position": 231
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ");\r\n    });\r\n\r\n    it('should handle database error', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockReturnThis(),\r\n        limit: vi.fn().mockResolvedValue({ data: null, error: { message: 'DB error' } }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/notifications'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notifications.test.ts",
        "start": 108,
        "end": 126,
        "startLoc": {
          "line": 108,
          "column": 2,
          "position": 1145
        },
        "endLoc": {
          "line": 126,
          "column": 42,
          "position": 1350
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 202,
        "end": 220,
        "startLoc": {
          "line": 202,
          "column": 3,
          "position": 2178
        },
        "endLoc": {
          "line": 220,
          "column": 47,
          "position": 2383
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/notifications');\r\n\r\n      const response = await GET(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notifications.test.ts",
        "start": 121,
        "end": 131,
        "startLoc": {
          "line": 121,
          "column": 2,
          "position": 1313
        },
        "endLoc": {
          "line": 131,
          "column": 4,
          "position": 1402
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notifications.test.ts",
        "start": 61,
        "end": 71,
        "startLoc": {
          "line": 61,
          "column": 2,
          "position": 655
        },
        "endLoc": {
          "line": 71,
          "column": 4,
          "position": 744
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Notification Read API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 42,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 24,
          "position": 231
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n        error: null,\r\n      });\r\n\r\n      const updateChain = {\r\n        update: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n      };\r\n      updateChain",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 74,
        "end": 84,
        "startLoc": {
          "line": 74,
          "column": 31,
          "position": 767
        },
        "endLoc": {
          "line": 84,
          "column": 12,
          "position": 877
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 48,
        "end": 58,
        "startLoc": {
          "line": 48,
          "column": 48,
          "position": 482
        },
        "endLoc": {
          "line": 58,
          "column": 53,
          "position": 592
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "});\r\n\r\n      mockSupabase.from.mockReturnValue(updateChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/notifications/notif-1/read', {\r\n        method: 'PATCH',\r\n      });\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'notif-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 86,
        "end": 97,
        "startLoc": {
          "line": 86,
          "column": 2,
          "position": 908
        },
        "endLoc": {
          "line": 97,
          "column": 4,
          "position": 1029
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 59,
        "end": 44,
        "startLoc": {
          "line": 59,
          "column": 2,
          "position": 614
        },
        "endLoc": {
          "line": 44,
          "column": 4,
          "position": 450
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('   ');\r\n    });\r\n\r\n    it('should handle unexpected errors', async () => {\r\n      mockSupabase.auth.getUser.mockRejectedValue(new Error('Unexpected'));\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/notifications/notif-1/read'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 94,
        "end": 104,
        "startLoc": {
          "line": 94,
          "column": 2,
          "position": 996
        },
        "endLoc": {
          "line": 104,
          "column": 55,
          "position": 1105
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\read-all.test.ts",
        "start": 89,
        "end": 99,
        "startLoc": {
          "line": 89,
          "column": 8,
          "position": 832
        },
        "endLoc": {
          "line": 99,
          "column": 51,
          "position": 931
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/notifications/notif-1/read', {\r\n        method: 'PATCH',\r\n      });\r\n\r\n      const response = await PATCH(request, { params: Promise.resolve({ id: 'notif-1' }) });\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('  '",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 102,
        "end": 112,
        "startLoc": {
          "line": 102,
          "column": 2,
          "position": 1088
        },
        "endLoc": {
          "line": 112,
          "column": 16,
          "position": 1209
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\notification-read.test.ts",
        "start": 35,
        "end": 98,
        "startLoc": {
          "line": 35,
          "column": 2,
          "position": 344
        },
        "endLoc": {
          "line": 98,
          "column": 19,
          "position": 1044
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ": vi.fn(() => mockSupabase),\n  eq: vi.fn(() => mockSupabase),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\ndescribe('Notifications Count API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\count.test.ts",
        "start": 12,
        "end": 28,
        "startLoc": {
          "line": 12,
          "column": 7,
          "position": 113
        },
        "endLoc": {
          "line": 28,
          "column": 26,
          "position": 258
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\notifications\\read-all.test.ts",
        "start": 12,
        "end": 25,
        "startLoc": {
          "line": 12,
          "column": 7,
          "position": 113
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\n\n// Mock Supabase\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst mockSupabase: Record<string, any> = {\n  auth: {\n    getUser: vi.fn(),\n  },\n  from: vi.fn(() => mockSupabase),\n  select: vi.fn(() => mockSupabase),\n  eq: vi.fn(() => mockSupabase),\n  neq",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\unread-count.test.ts",
        "start": 3,
        "end": 14,
        "startLoc": {
          "line": 3,
          "column": 36,
          "position": 49
        },
        "endLoc": {
          "line": 14,
          "column": 4,
          "position": 146
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payment-requests\\payment-requests.test.ts",
        "start": 3,
        "end": 12,
        "startLoc": {
          "line": 3,
          "column": 35,
          "position": 54
        },
        "endLoc": {
          "line": 12,
          "column": 7,
          "position": 133
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ": vi.fn(() => mockSupabase),\n  limit: vi.fn(),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\ndescribe('Chat Unread Count API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\unread-count.test.ts",
        "start": 15,
        "end": 31,
        "startLoc": {
          "line": 15,
          "column": 3,
          "position": 164
        },
        "endLoc": {
          "line": 31,
          "column": 24,
          "position": 303
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\search\\services.test.ts",
        "start": 11,
        "end": 25,
        "startLoc": {
          "line": 11,
          "column": 6,
          "position": 142
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\ndescribe",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\search.test.ts",
        "start": 3,
        "end": 17,
        "startLoc": {
          "line": 3,
          "column": 30,
          "position": 51
        },
        "endLoc": {
          "line": 17,
          "column": 9,
          "position": 157
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 17,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 17,
          "column": 3,
          "position": 160
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ": vi.fn(),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\ndescribe('Chat Rooms API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\rooms.test.ts",
        "start": 22,
        "end": 37,
        "startLoc": {
          "line": 22,
          "column": 12,
          "position": 280
        },
        "endLoc": {
          "line": 37,
          "column": 17,
          "position": 402
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 59
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\n\n// Mock Supabase\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst mockSupabase: Record<string, any> = {\n  auth: {\n    getUser: vi.fn(),\n  },\n  from: vi.fn(() => mockSupabase),\n  select: vi.fn(() => mockSupabase),\n  insert: vi.fn(() => mockSupabase),\n  update",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 3,
        "end": 14,
        "startLoc": {
          "line": 3,
          "column": 32,
          "position": 52
        },
        "endLoc": {
          "line": 14,
          "column": 7,
          "position": 149
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payment-requests\\payment-requests.test.ts",
        "start": 3,
        "end": 14,
        "startLoc": {
          "line": 3,
          "column": 35,
          "position": 54
        },
        "endLoc": {
          "line": 14,
          "column": 3,
          "position": 162
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": ": vi.fn(() => mockSupabase),\n  order: vi.fn(() => mockSupabase),\n  single: vi.fn(),\n  maybeSingle: vi.fn(),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\ndescribe('Chat Messages API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 16,
        "end": 34,
        "startLoc": {
          "line": 16,
          "column": 4,
          "position": 184
        },
        "endLoc": {
          "line": 34,
          "column": 20,
          "position": 351
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\rooms.test.ts",
        "start": 19,
        "end": 25,
        "startLoc": {
          "line": 19,
          "column": 4,
          "position": 235
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Unauthorized');\n    });\n\n    it('should return 400 if room_id is missing', async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'user-1' } },\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/chat/messages',",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 143,
        "end": 156,
        "startLoc": {
          "line": 143,
          "column": 5,
          "position": 1333
        },
        "endLoc": {
          "line": 156,
          "column": 2,
          "position": 1461
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 47,
        "end": 60,
        "startLoc": {
          "line": 47,
          "column": 4,
          "position": 476
        },
        "endLoc": {
          "line": 60,
          "column": 2,
          "position": 604
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ": null },\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/chat/messages', {\n        method: 'POST',\n        body: JSON.stringify({ room_id: 'room-1', message: 'Hello' }),\n      });\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 206,
        "end": 217,
        "startLoc": {
          "line": 206,
          "column": 14,
          "position": 1920
        },
        "endLoc": {
          "line": 217,
          "column": 4,
          "position": 2035
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 135,
        "end": 146,
        "startLoc": {
          "line": 135,
          "column": 5,
          "position": 1250
        },
        "endLoc": {
          "line": 146,
          "column": 4,
          "position": 1365
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ",\n        is_read: false,\n        created_at: new Date().toISOString(),\n      };\n\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: mockUser },\n        error: null,\n      });\n\n      mockSupabase.single.mockResolvedValue({\n        data: mockNewMessage,\n        error: null,\n      });\n\n      mockSupabase.maybeSingle.mockResolvedValue({\n        data: null",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 231,
        "end": 247,
        "startLoc": {
          "line": 231,
          "column": 18,
          "position": 2153
        },
        "endLoc": {
          "line": 247,
          "column": 5,
          "position": 2262
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 190,
        "end": 206,
        "startLoc": {
          "line": 190,
          "column": 8,
          "position": 1802
        },
        "endLoc": {
          "line": 206,
          "column": 2,
          "position": 1911
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  auth: {\r\n    getUser: vi.fn(),\r\n  },\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Chat Mark Read API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 42,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 21,
          "position": 231
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\user\\service-views.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 37,
          "position": 54
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "}),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(401);\r\n      expect(data.error).toBe('Unauthorized');\r\n    });\r\n\r\n    it('should return 400 if room_id is missing', async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: { id: 'user-1' } },\r\n      }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 38,
        "end": 51,
        "startLoc": {
          "line": 38,
          "column": 2,
          "position": 375
        },
        "endLoc": {
          "line": 51,
          "column": 2,
          "position": 512
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\rooms.test.ts",
        "start": 93,
        "end": 57,
        "startLoc": {
          "line": 93,
          "column": 2,
          "position": 899
        },
        "endLoc": {
          "line": 57,
          "column": 6,
          "position": 580
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('room_id is required');\r\n    });\r\n\r\n    it('should mark messages as read successfully'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 55,
        "end": 65,
        "startLoc": {
          "line": 55,
          "column": 2,
          "position": 553
        },
        "endLoc": {
          "line": 65,
          "column": 44,
          "position": 642
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 158,
        "end": 167,
        "startLoc": {
          "line": 158,
          "column": 2,
          "position": 1487
        },
        "endLoc": {
          "line": 167,
          "column": 57,
          "position": 1565
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "});\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/chat/messages/mark-read', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ room_id: 'room-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 90,
        "end": 100,
        "startLoc": {
          "line": 90,
          "column": 7,
          "position": 949
        },
        "endLoc": {
          "line": 100,
          "column": 4,
          "position": 1054
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 34,
        "end": 180,
        "startLoc": {
          "line": 34,
          "column": 7,
          "position": 328
        },
        "endLoc": {
          "line": 180,
          "column": 4,
          "position": 1711
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": "}),\r\n      };\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) return countChain;\r\n        return updateChain;\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/chat/messages/mark-read', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ room_id: 'room-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 120,
        "end": 138,
        "startLoc": {
          "line": 120,
          "column": 2,
          "position": 1318
        },
        "endLoc": {
          "line": 138,
          "column": 4,
          "position": 1492
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\mark-read.test.ts",
        "start": 82,
        "end": 180,
        "startLoc": {
          "line": 82,
          "column": 2,
          "position": 880
        },
        "endLoc": {
          "line": 180,
          "column": 4,
          "position": 1711
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\n\n// Mock Supabase\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst mockSupabase: Record<string, any> = {\n  auth: {\n    getUser: vi.fn(),\n  },\n  from: vi.fn(() => mockSupabase),\n  select: vi.fn(() => mockSupabase),\n  eq: vi.fn(() => mockSupabase),\n  maybeSingle",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 3,
        "end": 14,
        "startLoc": {
          "line": 3,
          "column": 33,
          "position": 49
        },
        "endLoc": {
          "line": 14,
          "column": 12,
          "position": 146
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payment-requests\\payment-requests.test.ts",
        "start": 3,
        "end": 12,
        "startLoc": {
          "line": 3,
          "column": 35,
          "position": 54
        },
        "endLoc": {
          "line": 12,
          "column": 7,
          "position": 133
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ": vi.fn(),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\ndescribe('Chat Favorites API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 16,
        "end": 31,
        "startLoc": {
          "line": 16,
          "column": 7,
          "position": 175
        },
        "endLoc": {
          "line": 31,
          "column": 21,
          "position": 297
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 59
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": ", {\n        method: 'POST',\n        body: JSON.stringify({ room_id: 'room-1' }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.error).toBe('Unauthorized');\n    });\n\n    it('should return 400 if room_id is missing', async () => {\n      mockSupabase.auth.getUser.mockResolvedValue({\n        data: { user: { id: 'user-1' } },\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/chat/favorites'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 47,
        "end": 64,
        "startLoc": {
          "line": 47,
          "column": 43,
          "position": 449
        },
        "endLoc": {
          "line": 64,
          "column": 43,
          "position": 615
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\messages.test.ts",
        "start": 173,
        "end": 53,
        "startLoc": {
          "line": 173,
          "column": 42,
          "position": 1634
        },
        "endLoc": {
          "line": 53,
          "column": 52,
          "position": 530
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ", {\n        method: 'POST',\n        body: JSON.stringify({}),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.error).toBe('room_id is required');\n    });\n\n    it('should add favorite when not exists'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 64,
        "end": 76,
        "startLoc": {
          "line": 64,
          "column": 43,
          "position": 616
        },
        "endLoc": {
          "line": 76,
          "column": 38,
          "position": 715
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\rooms.test.ts",
        "start": 108,
        "end": 167,
        "startLoc": {
          "line": 108,
          "column": 39,
          "position": 1046
        },
        "endLoc": {
          "line": 167,
          "column": 57,
          "position": 1565
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "});\n\n      const request = new NextRequest('http://localhost:3000/api/chat/favorites', {\n        method: 'POST',\n        body: JSON.stringify({ room_id: 'room-1' }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.is_favorite",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 82,
        "end": 93,
        "startLoc": {
          "line": 82,
          "column": 2,
          "position": 797
        },
        "endLoc": {
          "line": 93,
          "column": 12,
          "position": 901
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 45,
        "end": 101,
        "startLoc": {
          "line": 45,
          "column": 7,
          "position": 432
        },
        "endLoc": {
          "line": 101,
          "column": 8,
          "position": 1064
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\n\n      const request = new NextRequest('http://localhost:3000/api/chat/favorites', {\n        method: 'POST',\n        body: JSON.stringify({ room_id: 'room-1' }),\n      });\n\n      const response = await POST(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.is_favorite).toBe(false",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 109,
        "end": 120,
        "startLoc": {
          "line": 109,
          "column": 16,
          "position": 1045
        },
        "endLoc": {
          "line": 120,
          "column": 6,
          "position": 1153
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\chat\\favorites.test.ts",
        "start": 45,
        "end": 93,
        "startLoc": {
          "line": 45,
          "column": 2,
          "position": 433
        },
        "endLoc": {
          "line": 93,
          "column": 5,
          "position": 906
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ": vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Check Email API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\auth\\check-email.test.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 4,
          "position": 56
        },
        "endLoc": {
          "line": 21,
          "column": 18,
          "position": 193
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 25,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 59
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\r\n\r\n      const request = new Request('http://localhost:3000/api/auth/check-email', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ email: 'test@example.com' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('Failed to check email');\r\n    });\r\n  }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\auth\\check-email.test.ts",
        "start": 98,
        "end": 111,
        "startLoc": {
          "line": 98,
          "column": 2,
          "position": 976
        },
        "endLoc": {
          "line": 111,
          "column": 2,
          "position": 1107
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\auth\\check-email.test.ts",
        "start": 83,
        "end": 97,
        "startLoc": {
          "line": 83,
          "column": 2,
          "position": 815
        },
        "endLoc": {
          "line": 97,
          "column": 3,
          "position": 948
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Analytics Track API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 21,
        "end": 32,
        "startLoc": {
          "line": 21,
          "column": 20,
          "position": 232
        },
        "endLoc": {
          "line": 32,
          "column": 22,
          "position": 318
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 10,
        "end": 25,
        "startLoc": {
          "line": 10,
          "column": 2,
          "position": 110
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "}),\r\n        headers: {\r\n          'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0',\r\n        },\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(data.success).toBe(true);\r\n    });\r\n\r\n    it('should return 400 if path is missing'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 77,
        "end": 90,
        "startLoc": {
          "line": 77,
          "column": 2,
          "position": 756
        },
        "endLoc": {
          "line": 90,
          "column": 39,
          "position": 865
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 51,
        "end": 64,
        "startLoc": {
          "line": 51,
          "column": 2,
          "position": 504
        },
        "endLoc": {
          "line": 64,
          "column": 48,
          "position": 613
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: null },\r\n        error: null,\r\n      });\r\n\r\n      mockServiceSupabase.insert.mockResolvedValue({\r\n        data: null,\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/analytics/track', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ path: '/' }),\r\n        headers: {\r\n          'user-agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) Safari/605.1.15'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 108,
        "end": 123,
        "startLoc": {
          "line": 108,
          "column": 30,
          "position": 1045
        },
        "endLoc": {
          "line": 123,
          "column": 73,
          "position": 1190
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 38,
        "end": 53,
        "startLoc": {
          "line": 38,
          "column": 44,
          "position": 375
        },
        "endLoc": {
          "line": 53,
          "column": 61,
          "position": 520
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: null },\r\n        error: null,\r\n      });\r\n\r\n      mockServiceSupabase.insert.mockResolvedValue({\r\n        data: null,\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/analytics/track', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ path: '/' }),\r\n        headers: {\r\n          'user-agent': 'Mozilla/5.0 (iPad; CPU OS 14_0 like Mac OS X) Safari/605.1.15'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 133,
        "end": 148,
        "startLoc": {
          "line": 133,
          "column": 30,
          "position": 1267
        },
        "endLoc": {
          "line": 148,
          "column": 64,
          "position": 1412
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 38,
        "end": 53,
        "startLoc": {
          "line": 38,
          "column": 44,
          "position": 375
        },
        "endLoc": {
          "line": 53,
          "column": 61,
          "position": 520
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: null },\r\n        error: null,\r\n      });\r\n\r\n      mockServiceSupabase.insert.mockResolvedValue({\r\n        data: null,\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/analytics/track', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ path: '/' }),\r\n        headers: {\r\n          'user-agent': 'Googlebot/2.1 (+http://www.google.com/bot.html)'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 157,
        "end": 172,
        "startLoc": {
          "line": 157,
          "column": 20,
          "position": 1474
        },
        "endLoc": {
          "line": 172,
          "column": 50,
          "position": 1619
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 38,
        "end": 53,
        "startLoc": {
          "line": 38,
          "column": 44,
          "position": 375
        },
        "endLoc": {
          "line": 53,
          "column": 61,
          "position": 520
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: null },\r\n        error: null,\r\n      });\r\n\r\n      mockServiceSupabase.insert.mockResolvedValue({\r\n        data: null,\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/analytics/track', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ path: '/' }),\r\n        headers: {\r\n          'x-forwarded-for'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 181,
        "end": 196,
        "startLoc": {
          "line": 181,
          "column": 51,
          "position": 1681
        },
        "endLoc": {
          "line": 196,
          "column": 18,
          "position": 1823
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 38,
        "end": 53,
        "startLoc": {
          "line": 38,
          "column": 44,
          "position": 375
        },
        "endLoc": {
          "line": 53,
          "column": 13,
          "position": 517
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\r\n      mockSupabase.auth.getUser.mockResolvedValue({\r\n        data: { user: null },\r\n        error: null,\r\n      });\r\n\r\n      mockServiceSupabase.insert.mockResolvedValue({\r\n        data: null,\r\n        error: null,\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/analytics/track', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ path: '/' }),\r\n        headers: {\r\n          'user-agent': 'Chrome/120.0.0.0'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 233,
        "end": 248,
        "startLoc": {
          "line": 233,
          "column": 28,
          "position": 2146
        },
        "endLoc": {
          "line": 248,
          "column": 19,
          "position": 2291
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\analytics\\track.test.ts",
        "start": 38,
        "end": 53,
        "startLoc": {
          "line": 38,
          "column": 44,
          "position": 375
        },
        "endLoc": {
          "line": 53,
          "column": 61,
          "position": 520
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "createServiceRoleClient: vi.fn(() => mockSupabase),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Advertising Impression Track API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 11,
        "end": 22,
        "startLoc": {
          "line": 11,
          "column": 3,
          "position": 103
        },
        "endLoc": {
          "line": 22,
          "column": 35,
          "position": 202
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payment-requests\\payment-requests.test.ts",
        "start": 21,
        "end": 25,
        "startLoc": {
          "line": 21,
          "column": 3,
          "position": 255
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(400);\r\n      expect(data.error).toBe('serviceId and categoryId are required');\r\n    });\r\n\r\n    it('should return tracked=false when no active subscription'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 44,
        "end": 54,
        "startLoc": {
          "line": 44,
          "column": 2,
          "position": 453
        },
        "endLoc": {
          "line": 54,
          "column": 58,
          "position": 542
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 31,
        "end": 41,
        "startLoc": {
          "line": 31,
          "column": 2,
          "position": 311
        },
        "endLoc": {
          "line": 41,
          "column": 45,
          "position": 400
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/impression', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1', categoryId: 'cat-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 142,
        "end": 152,
        "startLoc": {
          "line": 142,
          "column": 2,
          "position": 1495
        },
        "endLoc": {
          "line": 152,
          "column": 4,
          "position": 1605
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 61,
        "end": 71,
        "startLoc": {
          "line": 61,
          "column": 12,
          "position": 636
        },
        "endLoc": {
          "line": 71,
          "column": 4,
          "position": 746
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "});\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/impression', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1', categoryId: 'cat-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('Internal server error'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 159,
        "end": 170,
        "startLoc": {
          "line": 159,
          "column": 7,
          "position": 1677
        },
        "endLoc": {
          "line": 170,
          "column": 24,
          "position": 1803
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 142,
        "end": 153,
        "startLoc": {
          "line": 142,
          "column": 7,
          "position": 1494
        },
        "endLoc": {
          "line": 153,
          "column": 30,
          "position": 1620
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ";\r\n\r\n// Mock createServiceRoleClient\r\nconst mockSupabase = {\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createServiceRoleClient: vi.fn(() => mockSupabase),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Advertising Click Track API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 3,
        "end": 22,
        "startLoc": {
          "line": 3,
          "column": 42,
          "position": 51
        },
        "endLoc": {
          "line": 22,
          "column": 30,
          "position": 202
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 47,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ");\r\n    });\r\n\r\n    it('should return tracked=false when no active subscription', async () => {\r\n      const selectChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({ data: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(selectChain);\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/click'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 38,
        "end": 50,
        "startLoc": {
          "line": 38,
          "column": 24,
          "position": 379
        },
        "endLoc": {
          "line": 50,
          "column": 52,
          "position": 505
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 51,
        "end": 63,
        "startLoc": {
          "line": 51,
          "column": 40,
          "position": 527
        },
        "endLoc": {
          "line": 63,
          "column": 57,
          "position": 653
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "}),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(data.success).toBe(true);\r\n      expect(data.tracked).toBe(false);\r\n    });\r\n\r\n    it('should track click and update subscription stats'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 52,
        "end": 63,
        "startLoc": {
          "line": 52,
          "column": 2,
          "position": 534
        },
        "endLoc": {
          "line": 63,
          "column": 51,
          "position": 638
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payments\\verify.test.ts",
        "start": 431,
        "end": 76,
        "startLoc": {
          "line": 431,
          "column": 9,
          "position": 3421
        },
        "endLoc": {
          "line": 76,
          "column": 56,
          "position": 792
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "};\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          // Subscription lookup\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            maybeSingle: vi.fn().mockResolvedValue({ data: mockSubscription }),\r\n          };\r\n        } else if (callCount === 2) {\r\n          // Recent impression lookup",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 71,
        "end": 84,
        "startLoc": {
          "line": 71,
          "column": 2,
          "position": 714
        },
        "endLoc": {
          "line": 84,
          "column": 28,
          "position": 856
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 81,
        "end": 94,
        "startLoc": {
          "line": 81,
          "column": 7,
          "position": 840
        },
        "endLoc": {
          "line": 94,
          "column": 21,
          "position": 982
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/click', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(data.success).toBe(true);\r\n      expect(data.tracked).toBe(true);\r\n      expect(data.clickCount",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 99,
        "end": 112,
        "startLoc": {
          "line": 99,
          "column": 2,
          "position": 1027
        },
        "endLoc": {
          "line": 112,
          "column": 11,
          "position": 1171
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 48,
        "end": 118,
        "startLoc": {
          "line": 48,
          "column": 12,
          "position": 488
        },
        "endLoc": {
          "line": 118,
          "column": 16,
          "position": 1251
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ",\r\n      };\r\n\r\n      let callCount = 0;\r\n      mockSupabase.from.mockImplementation(() => {\r\n        callCount++;\r\n        if (callCount === 1) {\r\n          return {\r\n            select: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockReturnThis(),\r\n            maybeSingle: vi.fn().mockResolvedValue({ data: mockSubscription }),\r\n          };\r\n        } else if",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 120,
        "end": 132,
        "startLoc": {
          "line": 120,
          "column": 4,
          "position": 1244
        },
        "endLoc": {
          "line": 132,
          "column": 3,
          "position": 1372
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 125,
        "end": 137,
        "startLoc": {
          "line": 125,
          "column": 3,
          "position": 1316
        },
        "endLoc": {
          "line": 137,
          "column": 2,
          "position": 1444
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ": null }),\r\n          };\r\n        } else {\r\n          return {\r\n            update: vi.fn().mockReturnThis(),\r\n            eq: vi.fn().mockResolvedValue({ error: { message: 'Update error' } }),\r\n          };\r\n        }\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/click'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 138,
        "end": 148,
        "startLoc": {
          "line": 138,
          "column": 5,
          "position": 1470
        },
        "endLoc": {
          "line": 148,
          "column": 52,
          "position": 1573
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\revision.test.ts",
        "start": 204,
        "end": 214,
        "startLoc": {
          "line": 204,
          "column": 6,
          "position": 2353
        },
        "endLoc": {
          "line": 214,
          "column": 52,
          "position": 2456
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "}),\r\n          };\r\n        }\r\n      });\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/click', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 143,
        "end": 156,
        "startLoc": {
          "line": 143,
          "column": 2,
          "position": 1540
        },
        "endLoc": {
          "line": 156,
          "column": 4,
          "position": 1660
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 96,
        "end": 50,
        "startLoc": {
          "line": 96,
          "column": 2,
          "position": 1011
        },
        "endLoc": {
          "line": 50,
          "column": 4,
          "position": 511
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "});\r\n\r\n      const request = new NextRequest('http://localhost:3000/api/advertising/track/click', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ serviceId: 'service-1' }),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('Internal server error'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 163,
        "end": 174,
        "startLoc": {
          "line": 163,
          "column": 7,
          "position": 1732
        },
        "endLoc": {
          "line": 174,
          "column": 24,
          "position": 1852
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 99,
        "end": 157,
        "startLoc": {
          "line": 99,
          "column": 7,
          "position": 1026
        },
        "endLoc": {
          "line": 157,
          "column": 31,
          "position": 1675
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "}),\r\n      });\r\n\r\n      const response = await POST(request);\r\n      const data = await response.json();\r\n\r\n      expect(response.status).toBe(500);\r\n      expect(data.error).toBe('Internal server error');\r\n    });\r\n  });\r\n});",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-click.test.ts",
        "start": 167,
        "end": 177,
        "startLoc": {
          "line": 167,
          "column": 2,
          "position": 1779
        },
        "endLoc": {
          "line": 177,
          "column": 2,
          "position": 1871
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\advertising\\track-impression.test.ts",
        "start": 163,
        "end": 173,
        "startLoc": {
          "line": 163,
          "column": 2,
          "position": 1730
        },
        "endLoc": {
          "line": 173,
          "column": 2,
          "position": 1822
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\nimport",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\devices.test.ts",
        "start": 22,
        "end": 37,
        "startLoc": {
          "line": 22,
          "column": 2,
          "position": 209
        },
        "endLoc": {
          "line": 37,
          "column": 7,
          "position": 323
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 2,
          "position": 65
        },
        "endLoc": {
          "line": 21,
          "column": 51,
          "position": 194
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "},\n      ];\n\n      mockSupabase.gte.mockResolvedValue({\n        data: mockDeviceData,\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/admin/analytics/devices');\n      const response = await GET(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.desktop).toBe(2); // null + 'Desktop'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\devices.test.ts",
        "start": 131,
        "end": 144,
        "startLoc": {
          "line": 131,
          "column": 2,
          "position": 1187
        },
        "endLoc": {
          "line": 144,
          "column": 20,
          "position": 1299
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\devices.test.ts",
        "start": 73,
        "end": 87,
        "startLoc": {
          "line": 73,
          "column": 2,
          "position": 659
        },
        "endLoc": {
          "line": 87,
          "column": 7,
          "position": 772
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\n\n// Mock Supabase\nconst mockSupabase = {\n  from: vi.fn(),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/admin/auth'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 4,
        "end": 15,
        "startLoc": {
          "line": 4,
          "column": 24,
          "position": 73
        },
        "endLoc": {
          "line": 15,
          "column": 19,
          "position": 148
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 3,
        "end": 13,
        "startLoc": {
          "line": 3,
          "column": 32,
          "position": 51
        },
        "endLoc": {
          "line": 13,
          "column": 15,
          "position": 126
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\nimport { checkAdminAuth } from '@/lib/admin/auth';\nconst",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 16,
        "end": 28,
        "startLoc": {
          "line": 16,
          "column": 2,
          "position": 167
        },
        "endLoc": {
          "line": 28,
          "column": 6,
          "position": 253
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\supabase\\queries\\search.test.ts",
        "start": 10,
        "end": 39,
        "startLoc": {
          "line": 10,
          "column": 2,
          "position": 110
        },
        "endLoc": {
          "line": 39,
          "column": 9,
          "position": 337
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\n      mockCheckAdminAuth.mockResolvedValue({\n        isAdmin: true,\n        user: { id: 'admin-1' } as unknown as User,\n        admin: {},\n        error: null,\n      });\n\n      const selectChain = {\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        neq",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 232,
        "end": 243,
        "startLoc": {
          "line": 232,
          "column": 47,
          "position": 2248
        },
        "endLoc": {
          "line": 243,
          "column": 4,
          "position": 2356
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 140,
        "end": 151,
        "startLoc": {
          "line": 140,
          "column": 43,
          "position": 1348
        },
        "endLoc": {
          "line": 151,
          "column": 7,
          "position": 1456
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\n      mockCheckAdminAuth.mockResolvedValue({\n        isAdmin: true,\n        user: { id: 'admin-1' } as unknown as User,\n        admin: {},\n        error: null,\n      });\n\n      const selectChain = {\n        select: vi.fn().mockReturnThis(),\n        eq: vi.fn().mockReturnThis(),\n        limit",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 324,
        "end": 335,
        "startLoc": {
          "line": 324,
          "column": 50,
          "position": 3167
        },
        "endLoc": {
          "line": 335,
          "column": 6,
          "position": 3275
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 140,
        "end": 151,
        "startLoc": {
          "line": 140,
          "column": 43,
          "position": 1348
        },
        "endLoc": {
          "line": 151,
          "column": 7,
          "position": 1456
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\n      mockCheckAdminAuth.mockResolvedValue({\n        isAdmin: true,\n        user: { id: 'admin-1' } as unknown as User,\n        admin: {},\n        error: null,\n      });\n\n      let callCount = 0;\n      mockSupabase.from.mockImplementation(() => {\n        callCount++;\n        if (callCount === 1 ||",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 386,
        "end": 397,
        "startLoc": {
          "line": 386,
          "column": 38,
          "position": 3761
        },
        "endLoc": {
          "line": 397,
          "column": 3,
          "position": 3868
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\categories.test.ts",
        "start": 349,
        "end": 360,
        "startLoc": {
          "line": 349,
          "column": 56,
          "position": 3409
        },
        "endLoc": {
          "line": 360,
          "column": 2,
          "position": 3515
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": ";\nimport type { User } from '@supabase/supabase-js';\n\n// Mock admin auth\nvi.mock('@/lib/admin/auth', () => ({\n  checkAdminAuth: vi.fn(),\n}));\n\n// Mock Supabase\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst mockSupabase: any = {\n  from: vi.fn(function (this: typeof mockSupabase) {\n    return this;\n  }),\n  select: vi.fn(function (this: typeof mockSupabase) {\n    return this;\n  }),\n  gte: vi.fn(function (this: typeof mockSupabase) {\n    return this;\n  }),\n  eq",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 3,
        "end": 23,
        "startLoc": {
          "line": 3,
          "column": 34,
          "position": 52
        },
        "endLoc": {
          "line": 23,
          "column": 3,
          "position": 216
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\devices.test.ts",
        "start": 3,
        "end": 23,
        "startLoc": {
          "line": 3,
          "column": 42,
          "position": 49
        },
        "endLoc": {
          "line": 23,
          "column": 2,
          "position": 212
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ": vi.fn(function (this: typeof mockSupabase) {\n    return this;\n  }),\n};\n\nvi.mock('@/lib/supabase/server', () => ({\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\n}));\n\nvi.mock('@/lib/logger', () => ({\n  logger: {\n    error: vi.fn(),\n    info: vi.fn(),\n    debug: vi.fn(),\n  },\n}));\n\nimport { checkAdminAuth } from '@/lib/admin/auth';\n\ndescribe('Admin Analytics API'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 26,
        "end": 45,
        "startLoc": {
          "line": 26,
          "column": 6,
          "position": 249
        },
        "endLoc": {
          "line": 45,
          "column": 22,
          "position": 406
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\devices.test.ts",
        "start": 20,
        "end": 39,
        "startLoc": {
          "line": 20,
          "column": 4,
          "position": 182
        },
        "endLoc": {
          "line": 39,
          "column": 29,
          "position": 339
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", async () => {\n      vi.mocked(checkAdminAuth).mockResolvedValue({\n        isAdmin: true,\n        user: { id: 'admin-1' } as unknown as User,\n        admin: {},\n        error: null,\n      });\n\n      mockSupabase.order.mockResolvedValue({\n        data: [],\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/admin/analytics?period=month'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 130,
        "end": 143,
        "startLoc": {
          "line": 130,
          "column": 48,
          "position": 1219
        },
        "endLoc": {
          "line": 143,
          "column": 57,
          "position": 1333
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 109,
        "end": 122,
        "startLoc": {
          "line": 109,
          "column": 47,
          "position": 1031
        },
        "endLoc": {
          "line": 122,
          "column": 56,
          "position": 1145
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", async () => {\n      vi.mocked(checkAdminAuth).mockResolvedValue({\n        isAdmin: true,\n        user: { id: 'admin-1' } as unknown as User,\n        admin: {},\n        error: null,\n      });\n\n      mockSupabase.order.mockResolvedValue({\n        data: [],\n        error: null,\n      });\n\n      const request = new NextRequest('http://localhost:3000/api/admin/analytics?period=year'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 151,
        "end": 164,
        "startLoc": {
          "line": 151,
          "column": 47,
          "position": 1407
        },
        "endLoc": {
          "line": 164,
          "column": 56,
          "position": 1521
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 109,
        "end": 122,
        "startLoc": {
          "line": 109,
          "column": 47,
          "position": 1031
        },
        "endLoc": {
          "line": 122,
          "column": 56,
          "position": 1145
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ");\n    });\n\n    it('should handle database errors', async () => {\n      vi.mocked(checkAdminAuth).mockResolvedValue({\n        isAdmin: true,\n        user: { id: 'admin-1' } as unknown as User,\n        admin: {},\n        error: null,\n      });\n\n      mockSupabase.order",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\analytics.test.ts",
        "start": 205,
        "end": 216,
        "startLoc": {
          "line": 205,
          "column": 7,
          "position": 1918
        },
        "endLoc": {
          "line": 216,
          "column": 6,
          "position": 2007
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\admin\\devices.test.ts",
        "start": 145,
        "end": 156,
        "startLoc": {
          "line": 145,
          "column": 2,
          "position": 1312
        },
        "endLoc": {
          "line": 156,
          "column": 4,
          "position": 1401
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "export async function POST(request: NextRequest) {\n  try {\n    const authResult = await requireAuth();\n    if (!authResult.success) return authResult.error;\n\n    const { supabase, user } = authResult;\n    if (!supabase || !user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const body = await request.json();\n    const { serviceId",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\user\\service-views\\route.ts",
        "start": 6,
        "end": 17,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 45
        },
        "endLoc": {
          "line": 17,
          "column": 10,
          "position": 183
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 19,
        "startLoc": {
          "line": 8,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 19,
          "column": 9,
          "position": 186
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "(request: NextRequest) {\n  try {\n    const authResult = await requireAuth();\n    if (!authResult.success) return authResult.error;\n\n    const { supabase, user } = authResult;\n    if (!supabase || !user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const { searchParams",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\user\\service-views\\route.ts",
        "start": 48,
        "end": 58,
        "startLoc": {
          "line": 48,
          "column": 4,
          "position": 464
        },
        "endLoc": {
          "line": 58,
          "column": 13,
          "position": 579
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 17,
        "startLoc": {
          "line": 8,
          "column": 5,
          "position": 55
        },
        "endLoc": {
          "line": 17,
          "column": 7,
          "position": 226
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": "export async function POST(request: NextRequest) {\r\n  try {\r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) return authResult.error;\r\n\r\n    const { supabase, user } = authResult;\r\n    if (!supabase || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { serviceId } = body;\r\n\r\n    if (!serviceId) {\r\n      return NextResponse.json({ error: 'Missing serviceId' }, { status: 400 });\r\n    }\r\n\r\n    logger",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\user\\service-favorites\\route.ts",
        "start": 6,
        "end": 23,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 50
        },
        "endLoc": {
          "line": 23,
          "column": 7,
          "position": 258
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 23,
        "startLoc": {
          "line": 8,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 23,
          "column": 44,
          "position": 236
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "(request: NextRequest) {\r\n  try {\r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) return authResult.error;\r\n\r\n    const { supabase, user } = authResult;\r\n    if (!supabase || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const { searchParams } = new URL(request.url);\r\n    const serviceId",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\user\\service-favorites\\route.ts",
        "start": 64,
        "end": 75,
        "startLoc": {
          "line": 64,
          "column": 7,
          "position": 721
        },
        "endLoc": {
          "line": 75,
          "column": 10,
          "position": 866
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 59,
        "startLoc": {
          "line": 8,
          "column": 5,
          "position": 55
        },
        "endLoc": {
          "line": 59,
          "column": 6,
          "position": 598
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ": NextRequest) {\r\n  try {\r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) return authResult.error;\r\n\r\n    const { supabase, user } = authResult;\r\n    if (!supabase || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    //    favorites services join",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\user\\service-favorites\\route.ts",
        "start": 115,
        "end": 125,
        "startLoc": {
          "line": 115,
          "column": 9,
          "position": 1305
        },
        "endLoc": {
          "line": 125,
          "column": 37,
          "position": 1424
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 18,
        "startLoc": {
          "line": 8,
          "column": 8,
          "position": 57
        },
        "endLoc": {
          "line": 18,
          "column": 6,
          "position": 166
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function POST(request: NextRequest) {\n  try {\n    const authResult = await requireAuth();\n    if (!authResult.success) return authResult.error;\n\n    const { supabase, user } = authResult;\n    if (!supabase || !user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const body = await request.json();\n    const {\n      seller_id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\seller\\portfolio\\route.ts",
        "start": 6,
        "end": 18,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 45
        },
        "endLoc": {
          "line": 18,
          "column": 10,
          "position": 184
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 19,
        "startLoc": {
          "line": 8,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 19,
          "column": 9,
          "position": 186
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ") {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\seller\\check\\route.ts",
        "start": 4,
        "end": 15,
        "startLoc": {
          "line": 4,
          "column": 2,
          "position": 38
        },
        "endLoc": {
          "line": 15,
          "column": 2,
          "position": 150
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\rooms\\create-from-order\\route.ts",
        "start": 6,
        "end": 17,
        "startLoc": {
          "line": 6,
          "column": 12,
          "position": 62
        },
        "endLoc": {
          "line": 17,
          "column": 5,
          "position": 174
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ";\r\nimport { logger } from '@/lib/logger';\r\nimport { verifyPaymentAuth, verifyOrderForPayment } from '@/lib/api/payment-verify';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    //    \r\n    const authResult = await verifyPaymentAuth(request);\r\n    if (!authResult.success) {\r\n      return authResult.error;\r\n    }\r\n\r\n    const { user",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\verify\\route.ts",
        "start": 4,
        "end": 16,
        "startLoc": {
          "line": 4,
          "column": 20,
          "position": 58
        },
        "endLoc": {
          "line": 16,
          "column": 5,
          "position": 170
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\verify-direct\\route.ts",
        "start": 2,
        "end": 14,
        "startLoc": {
          "line": 2,
          "column": 22,
          "position": 28
        },
        "endLoc": {
          "line": 14,
          "column": 9,
          "position": 140
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "export async function POST(request: NextRequest) {\n  try {\n    const authResult = await requireAuth();\n    if (!authResult.success) return authResult.error;\n\n    const { supabase, user } = authResult;\n    if (!supabase || !user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const body = await request.json();\n    const { order_id }",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\mock-payment\\route.ts",
        "start": 8,
        "end": 19,
        "startLoc": {
          "line": 8,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 19,
          "column": 2,
          "position": 188
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 8,
        "end": 19,
        "startLoc": {
          "line": 8,
          "column": 1,
          "position": 48
        },
        "endLoc": {
          "line": 19,
          "column": 2,
          "position": 187
        }
      }
    },
    {
      "format": "typescript",
      "lines": 19,
      "fragment": "}\n\n    //  \n    const { data: order, error: orderError } = await supabase\n      .from('orders')\n      .select('*')\n      .eq('id', order_id)\n      .single();\n\n    if (orderError || !order) {\n      return NextResponse.json({ error: '   ' }, { status: 404 });\n    }\n\n    //   \n    if (order.buyer_id !== user.id) {\n      return NextResponse.json({ error: ' ' }, { status: 403 });\n    }\n\n    //    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\mock-payment\\route.ts",
        "start": 23,
        "end": 41,
        "startLoc": {
          "line": 23,
          "column": 5,
          "position": 235
        },
        "endLoc": {
          "line": 41,
          "column": 18,
          "position": 396
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 34,
        "end": 52,
        "startLoc": {
          "line": 34,
          "column": 5,
          "position": 368
        },
        "endLoc": {
          "line": 52,
          "column": 18,
          "position": 529
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ")\n      .eq('id', order_id);\n\n    if (updateError) {\n      logger.error('Order update error:', updateError);\n      return NextResponse.json({ error: '  ' }, { status: 500 });\n    }\n\n    return NextResponse.json({\n      success: true,\n      message: 'Mock   ( )'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\mock-payment\\route.ts",
        "start": 54,
        "end": 64,
        "startLoc": {
          "line": 54,
          "column": 2,
          "position": 525
        },
        "endLoc": {
          "line": 64,
          "column": 22,
          "position": 612
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\bank-transfer\\request\\route.ts",
        "start": 86,
        "end": 96,
        "startLoc": {
          "line": 86,
          "column": 11,
          "position": 805
        },
        "endLoc": {
          "line": 96,
          "column": 20,
          "position": 892
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function POST(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    // Rate Limit ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payments\\direct-purchase\\route.ts",
        "start": 114,
        "end": 126,
        "startLoc": {
          "line": 114,
          "column": 1,
          "position": 1138
        },
        "endLoc": {
          "line": 126,
          "column": 17,
          "position": 1272
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 7,
        "end": 31,
        "startLoc": {
          "line": 7,
          "column": 1,
          "position": 72
        },
        "endLoc": {
          "line": 31,
          "column": 20,
          "position": 303
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ") {\n  try {\n    const supabase = await createClient();\n    const {\n      data: { user },\n      error: authError,\n    } = await supabase.auth.getUser();\n\n    if (authError || !user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payment-requests\\[id]\\route.ts",
        "start": 12,
        "end": 24,
        "startLoc": {
          "line": 12,
          "column": 13,
          "position": 92
        },
        "endLoc": {
          "line": 24,
          "column": 6,
          "position": 202
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 7,
        "end": 31,
        "startLoc": {
          "line": 7,
          "column": 12,
          "position": 84
        },
        "endLoc": {
          "line": 31,
          "column": 20,
          "position": 303
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": "(request: NextRequest, { params }: { params: Promise<{ id: string }> }) {\r\n  try {\r\n    const { id } = await params;\r\n\r\n    //   \r\n    const authResult = await requireAuth();\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\r\n    }\r\n\r\n    //  ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\[id]\\route.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 4,
          "position": 57
        },
        "endLoc": {
          "line": 21,
          "column": 9,
          "position": 237
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\complete-revision\\route.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 6,
          "position": 57
        },
        "endLoc": {
          "line": 21,
          "column": 17,
          "position": 237
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": "export const GET = withAuth(async (request: NextRequest, user) => {\r\n  try {\r\n    const supabase = await createClient();\r\n\r\n    // URL  status \r\n    const { searchParams } = new URL(request.url);\r\n    const status = searchParams.get('status');\r\n\r\n    //   \r\n    let query = supabase\r\n      .from('orders')\r\n      .select(\r\n        `\r\n        *,\r\n        service:services(id, title, thumbnail_url),\r\n        seller:users!seller_id(id, name, profile_image)\r\n      `",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\buyer\\route.ts",
        "start": 7,
        "end": 23,
        "startLoc": {
          "line": 7,
          "column": 1,
          "position": 67
        },
        "endLoc": {
          "line": 23,
          "column": 8,
          "position": 190
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\seller\\route.ts",
        "start": 7,
        "end": 23,
        "startLoc": {
          "line": 7,
          "column": 1,
          "position": 67
        },
        "endLoc": {
          "line": 23,
          "column": 8,
          "position": 190
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", user.id)\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (status && status !== 'all') {\r\n      query = query.eq('status', status);\r\n    }\r\n\r\n    const { data, error } = await query;\r\n\r\n    if (error) {\r\n      throw new ApiError('    ', 500);\r\n    }\r\n\r\n    return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\orders\\buyer\\route.ts",
        "start": 25,
        "end": 38,
        "startLoc": {
          "line": 25,
          "column": 11,
          "position": 202
        },
        "endLoc": {
          "line": 38,
          "column": 7,
          "position": 326
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\seller\\route.ts",
        "start": 25,
        "end": 38,
        "startLoc": {
          "line": 25,
          "column": 12,
          "position": 202
        },
        "endLoc": {
          "line": 38,
          "column": 48,
          "position": 326
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "//   \n    const authResult = await requireAuth();\n    if (!authResult.success) {\n      return authResult.error!;\n    }\n\n    const { user, supabase } = authResult;\n    if (!user || !supabase) {\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n\n    //      ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\notifications\\read-all\\route.ts",
        "start": 8,
        "end": 19,
        "startLoc": {
          "line": 8,
          "column": 5,
          "position": 67
        },
        "endLoc": {
          "line": 19,
          "column": 20,
          "position": 173
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\complete-revision\\route.ts",
        "start": 10,
        "end": 21,
        "startLoc": {
          "line": 10,
          "column": 5,
          "position": 120
        },
        "endLoc": {
          "line": 21,
          "column": 17,
          "position": 237
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "(_request: NextRequest) {\n  try {\n    //   \n    const authResult = await requireAuth();\n    if (!authResult.success) {\n      return authResult.error!;\n    }\n\n    const { user, supabase } = authResult;\n    if (!user || !supabase) {\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n\n    //     ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\notifications\\count\\route.ts",
        "start": 6,
        "end": 19,
        "startLoc": {
          "line": 6,
          "column": 4,
          "position": 52
        },
        "endLoc": {
          "line": 19,
          "column": 17,
          "position": 173
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\notifications\\read-all\\route.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 6,
          "position": 52
        },
        "endLoc": {
          "line": 21,
          "column": 17,
          "position": 237
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "export async function GET() {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const activities",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\mypage\\recent-activities\\route.ts",
        "start": 32,
        "end": 43,
        "startLoc": {
          "line": 32,
          "column": 1,
          "position": 419
        },
        "endLoc": {
          "line": 43,
          "column": 11,
          "position": 539
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\check\\route.ts",
        "start": 4,
        "end": 17,
        "startLoc": {
          "line": 4,
          "column": 1,
          "position": 30
        },
        "endLoc": {
          "line": 17,
          "column": 5,
          "position": 174
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "import { NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\nexport async function GET() {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    //  ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\mypage\\hub-stats\\route.ts",
        "start": 1,
        "end": 15,
        "startLoc": {
          "line": 1,
          "column": 1,
          "position": 0
        },
        "endLoc": {
          "line": 15,
          "column": 9,
          "position": 148
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\check\\route.ts",
        "start": 1,
        "end": 17,
        "startLoc": {
          "line": 1,
          "column": 1,
          "position": 0
        },
        "endLoc": {
          "line": 17,
          "column": 6,
          "position": 172
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const body",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\location\\route.ts",
        "start": 8,
        "end": 18,
        "startLoc": {
          "line": 8,
          "column": 5,
          "position": 74
        },
        "endLoc": {
          "line": 18,
          "column": 5,
          "position": 176
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\applications\\[appId]\\route.ts",
        "start": 88,
        "end": 173,
        "startLoc": {
          "line": 88,
          "column": 5,
          "position": 721
        },
        "endLoc": {
          "line": 173,
          "column": 12,
          "position": 1527
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ") {\r\n  try {\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\location\\route.ts",
        "start": 88,
        "end": 100,
        "startLoc": {
          "line": 88,
          "column": 2,
          "position": 880
        },
        "endLoc": {
          "line": 100,
          "column": 2,
          "position": 994
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\helper\\location\\route.ts",
        "start": 6,
        "end": 173,
        "startLoc": {
          "line": 6,
          "column": 12,
          "position": 62
        },
        "endLoc": {
          "line": 173,
          "column": 12,
          "position": 1527
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { isOnline",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\location\\route.ts",
        "start": 127,
        "end": 140,
        "startLoc": {
          "line": 127,
          "column": 6,
          "position": 1273
        },
        "endLoc": {
          "line": 140,
          "column": 9,
          "position": 1411
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\helper\\location\\route.ts",
        "start": 6,
        "end": 19,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 57
        },
        "endLoc": {
          "line": 19,
          "column": 4,
          "position": 195
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": "import { NextResponse } from 'next/server';\r\nimport { createClient } from '@/lib/supabase/server';\r\n\r\nexport async function GET() {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const { data: helper",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\check\\route.ts",
        "start": 1,
        "end": 15,
        "startLoc": {
          "line": 1,
          "column": 1,
          "position": 0
        },
        "endLoc": {
          "line": 15,
          "column": 7,
          "position": 155
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\check\\route.ts",
        "start": 1,
        "end": 15,
        "startLoc": {
          "line": 1,
          "column": 1,
          "position": 0
        },
        "endLoc": {
          "line": 15,
          "column": 7,
          "position": 155
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": "//   \r\n    if (isNaN(lat) || isNaN(lng)) {\r\n      return NextResponse.json(\r\n        {\r\n          error: 'Missing or invalid coordinates: lat, lng required',\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    //   \r\n    if (lat < -90 || lat > 90 || lng < -180 || lng > 180) {\r\n      return NextResponse.json(\r\n        {\r\n          error: 'Coordinates out of range',\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // RPC     (  )",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\experts\\nearby\\route.ts",
        "start": 19,
        "end": 39,
        "startLoc": {
          "line": 19,
          "column": 5,
          "position": 242
        },
        "endLoc": {
          "line": 39,
          "column": 33,
          "position": 406
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\experts\\nearby\\categories\\route.ts",
        "start": 16,
        "end": 36,
        "startLoc": {
          "line": 16,
          "column": 5,
          "position": 192
        },
        "endLoc": {
          "line": 36,
          "column": 26,
          "position": 356
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "(request: NextRequest, { params }: RouteParams) {\r\n  try {\r\n    const { id } = await params;\r\n\r\n    //    \r\n    const authResult = await verifyErrandsAuth();\r\n    if (!authResult.success) {\r\n      return authResult.error;\r\n    }\r\n\r\n    const { supabase, profileId } = authResult;\r\n\r\n    //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\[id]\\route.ts",
        "start": 305,
        "end": 317,
        "startLoc": {
          "line": 305,
          "column": 7,
          "position": 2862
        },
        "endLoc": {
          "line": 317,
          "column": 13,
          "position": 2975
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\[id]\\route.ts",
        "start": 228,
        "end": 240,
        "startLoc": {
          "line": 228,
          "column": 6,
          "position": 2062
        },
        "endLoc": {
          "line": 240,
          "column": 6,
          "position": 2175
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "//   \r\n    if (isNaN(lat) || isNaN(lng)) {\r\n      return NextResponse.json({ error: '   (lat, lng)' }, { status: 400 });\r\n    }\r\n\r\n    // /  \r\n    if (lat < -90 || lat > 90 || lng < -180 || lng > 180) {\r\n      return NextResponse.json({ error: '   ' }, { status: 400 });\r\n    }\r\n\r\n    const supabase = await createClient();\r\n\r\n    // PostgreSQL    (  )",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\nearby-helpers\\route.ts",
        "start": 15,
        "end": 27,
        "startLoc": {
          "line": 15,
          "column": 5,
          "position": 210
        },
        "endLoc": {
          "line": 27,
          "column": 37,
          "position": 365
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\errands\\nearby-helpers\\list\\route.ts",
        "start": 26,
        "end": 38,
        "startLoc": {
          "line": 26,
          "column": 5,
          "position": 275
        },
        "endLoc": {
          "line": 38,
          "column": 13,
          "position": 430
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\r\n}\r\n\r\nexport async function GET() {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ success",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\debug\\personalized\\route.ts",
        "start": 48,
        "end": 59,
        "startLoc": {
          "line": 48,
          "column": 2,
          "position": 354
        },
        "endLoc": {
          "line": 59,
          "column": 8,
          "position": 453
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\mypage\\recent-activities\\route.ts",
        "start": 29,
        "end": 40,
        "startLoc": {
          "line": 29,
          "column": 5,
          "position": 411
        },
        "endLoc": {
          "line": 40,
          "column": 6,
          "position": 510
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ",\r\n    });\r\n  } catch (error) {\r\n    return NextResponse.json(\r\n      {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Unknown error',\r\n        stack: error instanceof Error ? error.stack : undefined,\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\debug\\personalized\\route.ts",
        "start": 153,
        "end": 165,
        "startLoc": {
          "line": 153,
          "column": 10,
          "position": 1356
        },
        "endLoc": {
          "line": 165,
          "column": 2,
          "position": 1467
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\debug\\rpc-test\\route.ts",
        "start": 52,
        "end": 64,
        "startLoc": {
          "line": 52,
          "column": 2,
          "position": 465
        },
        "endLoc": {
          "line": 64,
          "column": 2,
          "position": 576
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "(_request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n    }\r\n\r\n    // 1.     ID ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\chat\\unread-count\\route.ts",
        "start": 6,
        "end": 17,
        "startLoc": {
          "line": 6,
          "column": 4,
          "position": 57
        },
        "endLoc": {
          "line": 17,
          "column": 28,
          "position": 172
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\messages\\mark-all-read\\route.ts",
        "start": 6,
        "end": 17,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 52
        },
        "endLoc": {
          "line": 17,
          "column": 36,
          "position": 156
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "(request: NextRequest) {\n  try {\n    const supabase = await createClient();\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      return NextResponse.json({ error: ' ' }, { status: 401 });\n    }\n\n    const { searchParams",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\chat\\search\\route.ts",
        "start": 4,
        "end": 15,
        "startLoc": {
          "line": 4,
          "column": 4,
          "position": 37
        },
        "endLoc": {
          "line": 15,
          "column": 13,
          "position": 145
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\rooms\\create-from-order\\route.ts",
        "start": 6,
        "end": 15,
        "startLoc": {
          "line": 6,
          "column": 5,
          "position": 57
        },
        "endLoc": {
          "line": 15,
          "column": 5,
          "position": 152
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "export async function GET(_request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n    }\r\n\r\n    //    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\chat\\rooms\\route.ts",
        "start": 153,
        "end": 164,
        "startLoc": {
          "line": 153,
          "column": 1,
          "position": 1747
        },
        "endLoc": {
          "line": 164,
          "column": 20,
          "position": 1869
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\unread-count\\route.ts",
        "start": 6,
        "end": 17,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 50
        },
        "endLoc": {
          "line": 17,
          "column": 36,
          "position": 156
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ": NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n    }\r\n\r\n    const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\chat\\rooms\\route.ts",
        "start": 265,
        "end": 276,
        "startLoc": {
          "line": 265,
          "column": 8,
          "position": 2807
        },
        "endLoc": {
          "line": 276,
          "column": 6,
          "position": 2920
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\messages\\mark-all-read\\route.ts",
        "start": 6,
        "end": 17,
        "startLoc": {
          "line": 6,
          "column": 9,
          "position": 54
        },
        "endLoc": {
          "line": 17,
          "column": 36,
          "position": 156
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ";\n\nexport async function GET(request: NextRequest) {\n  try {\n    const supabase = await createClient();\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    const {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\chat\\messages\\route.ts",
        "start": 3,
        "end": 16,
        "startLoc": {
          "line": 3,
          "column": 15,
          "position": 40
        },
        "endLoc": {
          "line": 16,
          "column": 2,
          "position": 156
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\search\\route.ts",
        "start": 2,
        "end": 276,
        "startLoc": {
          "line": 2,
          "column": 24,
          "position": 27
        },
        "endLoc": {
          "line": 276,
          "column": 5,
          "position": 2922
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function POST(request: NextRequest) {\n  try {\n    const supabase = await createClient();\n    const {\n      data: { user },\n    } = await supabase.auth.getUser();\n\n    if (!user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    const body = await request.json();\n    const { room_id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\chat\\messages\\route.ts",
        "start": 100,
        "end": 112,
        "startLoc": {
          "line": 100,
          "column": 1,
          "position": 861
        },
        "endLoc": {
          "line": 112,
          "column": 8,
          "position": 992
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\rooms\\create-from-order\\route.ts",
        "start": 6,
        "end": 277,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 50
        },
        "endLoc": {
          "line": 277,
          "column": 10,
          "position": 2941
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ";\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const body",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\auth\\verify-identity\\route.ts",
        "start": 4,
        "end": 18,
        "startLoc": {
          "line": 4,
          "column": 25,
          "position": 56
        },
        "endLoc": {
          "line": 18,
          "column": 5,
          "position": 197
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 5,
        "end": 24,
        "startLoc": {
          "line": 5,
          "column": 15,
          "position": 69
        },
        "endLoc": {
          "line": 24,
          "column": 2,
          "position": 204
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ") {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const { data",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\auth\\verify-identity\\route.ts",
        "start": 102,
        "end": 114,
        "startLoc": {
          "line": 102,
          "column": 2,
          "position": 1036
        },
        "endLoc": {
          "line": 114,
          "column": 5,
          "position": 1162
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 7,
        "end": 24,
        "startLoc": {
          "line": 7,
          "column": 12,
          "position": 84
        },
        "endLoc": {
          "line": 24,
          "column": 3,
          "position": 206
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function GET(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = await createClient();\n    const { searchParams } = new URL(request.url);\n    const includeInactive",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\categories\\route.ts",
        "start": 7,
        "end": 19,
        "startLoc": {
          "line": 7,
          "column": 1,
          "position": 58
        },
        "endLoc": {
          "line": 19,
          "column": 16,
          "position": 196
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 187,
        "startLoc": {
          "line": 33,
          "column": 1,
          "position": 347
        },
        "endLoc": {
          "line": 187,
          "column": 7,
          "position": 1649
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "export async function POST(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = await createClient();\n    const body = await request.json();\n\n    const { name",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\categories\\route.ts",
        "start": 39,
        "end": 52,
        "startLoc": {
          "line": 39,
          "column": 1,
          "position": 389
        },
        "endLoc": {
          "line": 52,
          "column": 5,
          "position": 525
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\advertising\\credits\\route.ts",
        "start": 86,
        "end": 98,
        "startLoc": {
          "line": 86,
          "column": 1,
          "position": 825
        },
        "endLoc": {
          "line": 98,
          "column": 9,
          "position": 972
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "export async function PATCH(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = await createClient();\n    const body = await request.json();\n\n    const { id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\categories\\route.ts",
        "start": 92,
        "end": 105,
        "startLoc": {
          "line": 92,
          "column": 1,
          "position": 883
        },
        "endLoc": {
          "line": 105,
          "column": 3,
          "position": 1019
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\advertising\\payments\\route.ts",
        "start": 303,
        "end": 98,
        "startLoc": {
          "line": 303,
          "column": 1,
          "position": 2674
        },
        "endLoc": {
          "line": 98,
          "column": 9,
          "position": 972
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = await createClient();\n    const { searchParams } = new URL(request.url);\n    const id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\categories\\route.ts",
        "start": 149,
        "end": 161,
        "startLoc": {
          "line": 149,
          "column": 7,
          "position": 1476
        },
        "endLoc": {
          "line": 161,
          "column": 3,
          "position": 1607
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 187,
        "startLoc": {
          "line": 33,
          "column": 4,
          "position": 354
        },
        "endLoc": {
          "line": 187,
          "column": 7,
          "position": 1649
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "const adminCheck = await checkAdminAuth();\r\n    if (!adminCheck.isAdmin) {\r\n      return NextResponse.json(\r\n        { error: adminCheck.error },\r\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\r\n      );\r\n    }\r\n\r\n    const supabase = await createClient();\r\n    const { searchParams } = new URL(request.url);\r\n\r\n    const period = (searchParams.get('period') || 'day') as Period",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\analytics\\route.ts",
        "start": 190,
        "end": 201,
        "startLoc": {
          "line": 190,
          "column": 5,
          "position": 1874
        },
        "endLoc": {
          "line": 201,
          "column": 7,
          "position": 2021
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\referrers\\route.ts",
        "start": 24,
        "end": 187,
        "startLoc": {
          "line": 24,
          "column": 5,
          "position": 182
        },
        "endLoc": {
          "line": 187,
          "column": 11,
          "position": 1668
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function POST(request: NextRequest) {\r\n  try {\r\n    const adminCheck = await checkAdminAuth();\r\n    if (!adminCheck.isAdmin) {\r\n      return NextResponse.json(\r\n        { error: adminCheck.error },\r\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\r\n      );\r\n    }\r\n\r\n    const supabase = await createClient();\r\n    const body = await request.json();\r\n    const { limit",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\analytics\\route.ts",
        "start": 248,
        "end": 260,
        "startLoc": {
          "line": 248,
          "column": 1,
          "position": 2428
        },
        "endLoc": {
          "line": 260,
          "column": 6,
          "position": 2575
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\advertising\\credits\\route.ts",
        "start": 86,
        "end": 98,
        "startLoc": {
          "line": 86,
          "column": 1,
          "position": 825
        },
        "endLoc": {
          "line": 98,
          "column": 9,
          "position": 972
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "export async function GET(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = createServiceRoleClient();\n    const { searchParams } = new URL(request.url);\n\n    const",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\route.ts",
        "start": 7,
        "end": 20,
        "startLoc": {
          "line": 7,
          "column": 1,
          "position": 58
        },
        "endLoc": {
          "line": 20,
          "column": 6,
          "position": 193
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\analytics\\devices\\route.ts",
        "start": 33,
        "end": 22,
        "startLoc": {
          "line": 33,
          "column": 1,
          "position": 347
        },
        "endLoc": {
          "line": 22,
          "column": 11,
          "position": 208
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function PATCH(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = createServiceRoleClient();\n    const body = await request.json();\n    const { subscriptionId",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\route.ts",
        "start": 140,
        "end": 152,
        "startLoc": {
          "line": 140,
          "column": 1,
          "position": 1305
        },
        "endLoc": {
          "line": 152,
          "column": 15,
          "position": 1438
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\advertising\\payments\\route.ts",
        "start": 303,
        "end": 315,
        "startLoc": {
          "line": 303,
          "column": 1,
          "position": 2674
        },
        "endLoc": {
          "line": 315,
          "column": 11,
          "position": 2807
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function DELETE(request: NextRequest) {\n  try {\n    const adminCheck = await checkAdminAuth();\n    if (!adminCheck.isAdmin) {\n      return NextResponse.json(\n        { error: adminCheck.error },\n        { status: adminCheck.error === 'Unauthorized' ? 401 : 403 }\n      );\n    }\n\n    const supabase = createServiceRoleClient();\n    const { searchParams } = new URL(request.url);\n    const subscriptionId",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\admin\\advertising\\route.ts",
        "start": 189,
        "end": 201,
        "startLoc": {
          "line": 189,
          "column": 1,
          "position": 1762
        },
        "endLoc": {
          "line": 201,
          "column": 15,
          "position": 1898
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\admin\\categories\\route.ts",
        "start": 149,
        "end": 20,
        "startLoc": {
          "line": 149,
          "column": 1,
          "position": 1469
        },
        "endLoc": {
          "line": 20,
          "column": 7,
          "position": 195
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ",\r\n        status: 'pending',\r\n        created_at: '2024-01-01T00:00:00Z',\r\n        updated_at: '2024-01-01T00:00:00Z',\r\n      } as unknown as Tables<'orders'>;\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 86,
        "end": 96,
        "startLoc": {
          "line": 86,
          "column": 6,
          "position": 784
        },
        "endLoc": {
          "line": 96,
          "column": 5,
          "position": 890
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 47,
        "end": 57,
        "startLoc": {
          "line": 47,
          "column": 6,
          "position": 416
        },
        "endLoc": {
          "line": 57,
          "column": 14,
          "position": 522
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ";\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: null,\r\n        }),\r\n        insert: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({\r\n          data: null",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 221,
        "end": 232,
        "startLoc": {
          "line": 221,
          "column": 15,
          "position": 2030
        },
        "endLoc": {
          "line": 232,
          "column": 5,
          "position": 2149
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 90,
        "end": 101,
        "startLoc": {
          "line": 90,
          "column": 2,
          "position": 824
        },
        "endLoc": {
          "line": 101,
          "column": 9,
          "position": 943
        }
      }
    },
    {
      "format": "typescript",
      "lines": 23,
      "fragment": ",\r\n        created_at: '2024-01-01T00:00:00Z',\r\n        updated_at: '2024-01-01T00:00:00Z',\r\n      } as unknown as Tables<'orders'>;\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: null,\r\n        }),\r\n        insert: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({\r\n          data: newOrder,\r\n          error: null,\r\n        }),\r\n      };\r\n\r\n      vi.mocked(mockSupabase.from).mockReturnValue(mockQueryBuilder as never);\r\n\r\n      const orderData = {\r\n        buyer_id: 'buyer-6'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 262,
        "end": 284,
        "startLoc": {
          "line": 262,
          "column": 15,
          "position": 2409
        },
        "endLoc": {
          "line": 284,
          "column": 10,
          "position": 2622
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 48,
        "end": 109,
        "startLoc": {
          "line": 48,
          "column": 10,
          "position": 424
        },
        "endLoc": {
          "line": 109,
          "column": 10,
          "position": 1005
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ">;\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: null,\r\n        }),\r\n        insert: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({\r\n          data: newPayment",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 357,
        "end": 368,
        "startLoc": {
          "line": 357,
          "column": 11,
          "position": 3281
        },
        "endLoc": {
          "line": 368,
          "column": 11,
          "position": 3401
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 90,
        "end": 101,
        "startLoc": {
          "line": 90,
          "column": 9,
          "position": 823
        },
        "endLoc": {
          "line": 101,
          "column": 9,
          "position": 943
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ">;\r\n\r\n      let callCount = 0;\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: null,\r\n        }),\r\n        insert: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockImplementation(() => {\r\n          callCount++;\r\n          if (callCount === 1) {\r\n            return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 399,
        "end": 413,
        "startLoc": {
          "line": 399,
          "column": 11,
          "position": 3680
        },
        "endLoc": {
          "line": 413,
          "column": 7,
          "position": 3833
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 137,
        "end": 151,
        "startLoc": {
          "line": 137,
          "column": 9,
          "position": 1259
        },
        "endLoc": {
          "line": 151,
          "column": 43,
          "position": 1412
        }
      }
    },
    {
      "format": "typescript",
      "lines": 21,
      "fragment": ");\r\n    });\r\n\r\n    it('should return error when check query fails', async () => {\r\n      const checkError = {\r\n        code: 'PGRST301',\r\n        message: 'Database connection failed',\r\n      } as PostgrestError;\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: checkError,\r\n        }),\r\n      };\r\n\r\n      vi.mocked(mockSupabase.from).mockReturnValue(mockQueryBuilder as never);\r\n\r\n      const paymentData",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 442,
        "end": 462,
        "startLoc": {
          "line": 442,
          "column": 5,
          "position": 4078
        },
        "endLoc": {
          "line": 462,
          "column": 12,
          "position": 4255
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 183,
        "end": 203,
        "startLoc": {
          "line": 183,
          "column": 2,
          "position": 1683
        },
        "endLoc": {
          "line": 203,
          "column": 10,
          "position": 1860
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\r\n\r\n      expect(result.data).toBeNull();\r\n      expect(result.error).toEqual(checkError);\r\n      expect(result.isExisting).toBe(false);\r\n    });\r\n\r\n    it('should return error when insert fails with non-constraint error', async () => {\r\n      const insertError = {\r\n        code: 'PGRST400',\r\n        message: 'Invalid payment method'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 469,
        "end": 479,
        "startLoc": {
          "line": 469,
          "column": 12,
          "position": 4316
        },
        "endLoc": {
          "line": 479,
          "column": 25,
          "position": 4412
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 210,
        "end": 220,
        "startLoc": {
          "line": 210,
          "column": 20,
          "position": 1924
        },
        "endLoc": {
          "line": 220,
          "column": 22,
          "position": 2020
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ",\r\n      } as PostgrestError;\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: null,\r\n        }),\r\n        insert: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: insertError,\r\n        }),\r\n      };\r\n\r\n      vi.mocked(mockSupabase.from).mockReturnValue(mockQueryBuilder as never);\r\n\r\n      const paymentData",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 479,
        "end": 498,
        "startLoc": {
          "line": 479,
          "column": 25,
          "position": 4413
        },
        "endLoc": {
          "line": 498,
          "column": 12,
          "position": 4592
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 189,
        "end": 239,
        "startLoc": {
          "line": 189,
          "column": 29,
          "position": 1734
        },
        "endLoc": {
          "line": 239,
          "column": 10,
          "position": 2200
        }
      }
    },
    {
      "format": "typescript",
      "lines": 22,
      "fragment": ",\r\n        created_at: '2024-01-01T00:00:00Z',\r\n      } as unknown as Tables<'payments'>;\r\n\r\n      const mockQueryBuilder = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        maybeSingle: vi.fn().mockResolvedValue({\r\n          data: null,\r\n          error: null,\r\n        }),\r\n        insert: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({\r\n          data: newPayment,\r\n          error: null,\r\n        }),\r\n      };\r\n\r\n      vi.mocked(mockSupabase.from).mockReturnValue(mockQueryBuilder as never);\r\n\r\n      const paymentData = {\r\n        order_id: 'order-999'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 520,
        "end": 541,
        "startLoc": {
          "line": 520,
          "column": 14,
          "position": 4790
        },
        "endLoc": {
          "line": 541,
          "column": 12,
          "position": 4995
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\transaction.test.ts",
        "start": 318,
        "end": 376,
        "startLoc": {
          "line": 318,
          "column": 12,
          "position": 2909
        },
        "endLoc": {
          "line": 376,
          "column": 12,
          "position": 3463
        }
      }
    },
    {
      "format": "typescript",
      "lines": 20,
      "fragment": ";\r\n\r\n// Mock Supabase\r\nconst mockSupabase = {\r\n  from: vi.fn(),\r\n};\r\n\r\nvi.mock('@/lib/supabase/server', () => ({\r\n  createClient: vi.fn(() => Promise.resolve(mockSupabase)),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Notifications'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 11,
        "end": 30,
        "startLoc": {
          "line": 11,
          "column": 22,
          "position": 76
        },
        "endLoc": {
          "line": 30,
          "column": 16,
          "position": 232
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\orders\\seller.test.ts",
        "start": 3,
        "end": 25,
        "startLoc": {
          "line": 3,
          "column": 32,
          "position": 51
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "};\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyNewOrder",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 89,
        "end": 99,
        "startLoc": {
          "line": 89,
          "column": 2,
          "position": 805
        },
        "endLoc": {
          "line": 99,
          "column": 15,
          "position": 913
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 45,
        "end": 55,
        "startLoc": {
          "line": 45,
          "column": 7,
          "position": 368
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\r\n      const mockNotification = { id: 'notif-1' };\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyPaymentReceived",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 113,
        "end": 124,
        "startLoc": {
          "line": 113,
          "column": 46,
          "position": 1026
        },
        "endLoc": {
          "line": 124,
          "column": 22,
          "position": 1160
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 88,
        "end": 55,
        "startLoc": {
          "line": 88,
          "column": 39,
          "position": 779
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\r\n      const mockNotification = { id: 'notif-1' };\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyOrderCancelled",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 138,
        "end": 149,
        "startLoc": {
          "line": 138,
          "column": 45,
          "position": 1278
        },
        "endLoc": {
          "line": 149,
          "column": 21,
          "position": 1412
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 88,
        "end": 55,
        "startLoc": {
          "line": 88,
          "column": 39,
          "position": 779
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\r\n      const mockNotification = { id: 'notif-1' };\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyWorkCompleted",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 161,
        "end": 172,
        "startLoc": {
          "line": 161,
          "column": 44,
          "position": 1509
        },
        "endLoc": {
          "line": 172,
          "column": 20,
          "position": 1643
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 88,
        "end": 55,
        "startLoc": {
          "line": 88,
          "column": 39,
          "position": 779
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\r\n      const mockNotification = { id: 'notif-1' };\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyOrderConfirmed",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 185,
        "end": 196,
        "startLoc": {
          "line": 185,
          "column": 45,
          "position": 1748
        },
        "endLoc": {
          "line": 196,
          "column": 21,
          "position": 1882
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 88,
        "end": 55,
        "startLoc": {
          "line": 88,
          "column": 39,
          "position": 779
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\r\n      const mockNotification = { id: 'notif-1' };\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyNewReview",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 209,
        "end": 220,
        "startLoc": {
          "line": 209,
          "column": 40,
          "position": 1992
        },
        "endLoc": {
          "line": 220,
          "column": 16,
          "position": 2126
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 88,
        "end": 55,
        "startLoc": {
          "line": 88,
          "column": 39,
          "position": 779
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", async () => {\r\n      const mockNotification = { id: 'notif-1' };\r\n\r\n      const queryChain = {\r\n        insert: vi.fn().mockReturnThis(),\r\n        select: vi.fn().mockReturnThis(),\r\n        single: vi.fn().mockResolvedValue({ data: mockNotification, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await notifyNewMessage",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 233,
        "end": 244,
        "startLoc": {
          "line": 233,
          "column": 41,
          "position": 2236
        },
        "endLoc": {
          "line": 244,
          "column": 17,
          "position": 2370
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\notifications.test.ts",
        "start": 88,
        "end": 55,
        "startLoc": {
          "line": 88,
          "column": 39,
          "position": 779
        },
        "endLoc": {
          "line": 55,
          "column": 19,
          "position": 476
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": ");\n\n      vi.resetModules();\n      const { logger } = await import('@/lib/logger');\n\n      const error = new Error('Test error');\n      logger.error('Error occurred', error);\n\n      expect(mockConsoleError).toHaveBeenCalled();\n      const call = mockConsoleError.mock.calls[0];\n      expect(call[1]).toHaveProperty('name')",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\logger.test.ts",
        "start": 316,
        "end": 326,
        "startLoc": {
          "line": 316,
          "column": 13,
          "position": 2922
        },
        "endLoc": {
          "line": 326,
          "column": 2,
          "position": 3022
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\logger.test.ts",
        "start": 299,
        "end": 309,
        "startLoc": {
          "line": 299,
          "column": 14,
          "position": 2741
        },
        "endLoc": {
          "line": 309,
          "column": 2,
          "position": 2841
        }
      }
    },
    {
      "format": "typescript",
      "lines": 16,
      "fragment": ", async () => {\n      vi.stubEnv('NEXT_PUBLIC_LOG_LEVEL', 'debug');\n      vi.stubEnv('NODE_ENV', 'development');\n      delete (global as { window?: unknown }).window;\n\n      vi.resetModules();\n      const { logger } = await import('@/lib/logger');\n\n      logger.debug('Server message');\n\n      const call = mockConsoleLog.mock.calls[0];\n      expect(call[0]).toContain('[Server]');\n    });\n  });\n\n  describe('Edge cases'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\logger.test.ts",
        "start": 651,
        "end": 666,
        "startLoc": {
          "line": 651,
          "column": 35,
          "position": 5997
        },
        "endLoc": {
          "line": 666,
          "column": 13,
          "position": 6139
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\logger.test.ts",
        "start": 180,
        "end": 195,
        "startLoc": {
          "line": 180,
          "column": 44,
          "position": 1609
        },
        "endLoc": {
          "line": 195,
          "column": 14,
          "position": 1751
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ": vi.fn(() => mockSupabase),\r\n}));\r\n\r\nvi.mock('@/lib/logger', () => ({\r\n  logger: {\r\n    error: vi.fn(),\r\n    info: vi.fn(),\r\n    debug: vi.fn(),\r\n  },\r\n}));\r\n\r\ndescribe('Categories'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\categories.test.ts",
        "start": 20,
        "end": 31,
        "startLoc": {
          "line": 20,
          "column": 13,
          "position": 168
        },
        "endLoc": {
          "line": 31,
          "column": 13,
          "position": 266
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\api\\payment-requests\\payment-requests.test.ts",
        "start": 21,
        "end": 25,
        "startLoc": {
          "line": 21,
          "column": 24,
          "position": 256
        },
        "endLoc": {
          "line": 25,
          "column": 18,
          "position": 207
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": ", name: 'Development', slug: 'development', parent_id: null, level: 1 },\r\n      ];\r\n\r\n      const queryChain = {\r\n        select: vi.fn().mockReturnThis(),\r\n        eq: vi.fn().mockReturnThis(),\r\n        order: vi.fn().mockResolvedValue({ data: mockCategories, error: null }),\r\n      };\r\n\r\n      mockSupabase.from.mockReturnValue(queryChain);\r\n\r\n      const result = await getTopLevelCategories",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\lib\\categories.test.ts",
        "start": 81,
        "end": 92,
        "startLoc": {
          "line": 81,
          "column": 8,
          "position": 922
        },
        "endLoc": {
          "line": 92,
          "column": 22,
          "position": 1060
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\lib\\categories.test.ts",
        "start": 43,
        "end": 54,
        "startLoc": {
          "line": 43,
          "column": 8,
          "position": 450
        },
        "endLoc": {
          "line": 54,
          "column": 21,
          "position": 588
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ", () => {\r\n      const { result } = renderHook(() => useRateLimiting(defaultConfig));\r\n\r\n      act(() => {\r\n        result.current.incrementAttempts();\r\n      });\r\n      act(() => {\r\n        result.current.incrementAttempts();\r\n      });\r\n\r\n      expect(result.current.attempts).toBe(2);\r\n\r\n      act",
      "tokens": 0,
      "firstFile": {
        "name": "src\\__tests__\\unit\\hooks\\useRateLimiting.test.ts",
        "start": 74,
        "end": 86,
        "startLoc": {
          "line": 74,
          "column": 32,
          "position": 750
        },
        "endLoc": {
          "line": 86,
          "column": 4,
          "position": 866
        }
      },
      "secondFile": {
        "name": "src\\__tests__\\unit\\hooks\\useRateLimiting.test.ts",
        "start": 41,
        "end": 52,
        "startLoc": {
          "line": 41,
          "column": 56,
          "position": 418
        },
        "endLoc": {
          "line": 52,
          "column": 7,
          "position": 532
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "const stats = ratingMap.get(service.id);\r\n    if (stats && stats.count > 0) {\r\n      service.rating = stats.sum / stats.count;\r\n      service.review_count = stats.count;\r\n    } else {\r\n      service.rating = 0;\r\n      service.review_count = 0;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Enrich services with seller user information\r\n */",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\supabase\\queries\\service-enrichment-helpers.ts",
        "start": 86,
        "end": 99,
        "startLoc": {
          "line": 86,
          "column": 5,
          "position": 780
        },
        "endLoc": {
          "line": 99,
          "column": 4,
          "position": 892
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\services.ts",
        "start": 351,
        "end": 362,
        "startLoc": {
          "line": 351,
          "column": 7,
          "position": 3201
        },
        "endLoc": {
          "line": 362,
          "column": 7,
          "position": 3315
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "for (const review of reviewStats) {\r\n    const current = ratingMap.get(review.service_id) || { sum: 0, count: 0 };\r\n    ratingMap.set(review.service_id, {\r\n      sum: current.sum + review.rating,\r\n      count: current.count + 1,\r\n    });\r\n  }\r\n\r\n  return ratingMap;\r\n}\r\n\r\n/**\r\n *    \r\n */",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\supabase\\queries\\personalized-services.ts",
        "start": 139,
        "end": 152,
        "startLoc": {
          "line": 139,
          "column": 3,
          "position": 1121
        },
        "endLoc": {
          "line": 152,
          "column": 4,
          "position": 1238
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\search.ts",
        "start": 66,
        "end": 76,
        "startLoc": {
          "line": 66,
          "column": 3,
          "position": 584
        },
        "endLoc": {
          "line": 76,
          "column": 61,
          "position": 699
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ", userId)\r\n    .order('created_at', { ascending: false });\r\n\r\n  if (status && status !== 'all') {\r\n    query = query.eq('status', status);\r\n  }\r\n\r\n  const { data, error } = await query;\r\n\r\n  if (error) throw error;\r\n  return data;\r\n}\r\n\r\nexport async function getSellerOrders",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\supabase\\queries\\orders.ts",
        "start": 15,
        "end": 28,
        "startLoc": {
          "line": 15,
          "column": 11,
          "position": 94
        },
        "endLoc": {
          "line": 28,
          "column": 16,
          "position": 215
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\services.ts",
        "start": 64,
        "end": 77,
        "startLoc": {
          "line": 64,
          "column": 12,
          "position": 613
        },
        "endLoc": {
          "line": 77,
          "column": 15,
          "position": 734
        }
      }
    },
    {
      "format": "typescript",
      "lines": 15,
      "fragment": ")\r\n    .eq('seller_id', userId)\r\n    .order('created_at', { ascending: false });\r\n\r\n  if (status && status !== 'all') {\r\n    query = query.eq('status', status);\r\n  }\r\n\r\n  const { data, error } = await query;\r\n\r\n  if (error) throw error;\r\n  return data;\r\n}\r\n\r\nexport async function getOrderById",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\supabase\\queries\\orders.ts",
        "start": 39,
        "end": 53,
        "startLoc": {
          "line": 39,
          "column": 5,
          "position": 279
        },
        "endLoc": {
          "line": 53,
          "column": 13,
          "position": 408
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\services.ts",
        "start": 63,
        "end": 77,
        "startLoc": {
          "line": 63,
          "column": 5,
          "position": 605
        },
        "endLoc": {
          "line": 77,
          "column": 15,
          "position": 734
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ").select('*', { count: 'exact', head: true });\r\n\r\n  if (status) {\r\n    query = query.eq('status', status);\r\n  }\r\n\r\n  const { count, error } = await query;\r\n\r\n  if (error) throw error;\r\n  return count || 0;\r\n}\r\n\r\n//    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\supabase\\queries\\admin.ts",
        "start": 602,
        "end": 614,
        "startLoc": {
          "line": 602,
          "column": 11,
          "position": 6184
        },
        "endLoc": {
          "line": 614,
          "column": 16,
          "position": 6295
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\admin.ts",
        "start": 526,
        "end": 538,
        "startLoc": {
          "line": 526,
          "column": 9,
          "position": 5486
        },
        "endLoc": {
          "line": 538,
          "column": 17,
          "position": 5597
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": ").select('*', { count: 'exact', head: true });\r\n\r\n  if (status) {\r\n    query = query.eq('status', status);\r\n  }\r\n\r\n  const { count, error } = await query;\r\n\r\n  if (error) throw error;\r\n  return count || 0;\r\n}\r\n\r\n//    ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\supabase\\queries\\admin.ts",
        "start": 720,
        "end": 732,
        "startLoc": {
          "line": 720,
          "column": 20,
          "position": 7176
        },
        "endLoc": {
          "line": 732,
          "column": 16,
          "position": 7287
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\admin.ts",
        "start": 526,
        "end": 538,
        "startLoc": {
          "line": 526,
          "column": 9,
          "position": 5486
        },
        "endLoc": {
          "line": 538,
          "column": 17,
          "position": 5597
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "(request: NextRequest) {\n  try {\n    const supabase = await createClient();\n\n    const {\n      data: { user },\n      error: authError,\n    } = await supabase.auth.getUser();\n\n    if (authError || !user) {\n      return NextResponse.json({ error: 'Unauthorized'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\portfolio\\route.ts",
        "start": 5,
        "end": 15,
        "startLoc": {
          "line": 5,
          "column": 7,
          "position": 50
        },
        "endLoc": {
          "line": 15,
          "column": 15,
          "position": 145
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 7,
        "end": 16,
        "startLoc": {
          "line": 7,
          "column": 5,
          "position": 79
        },
        "endLoc": {
          "line": 16,
          "column": 12,
          "position": 173
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "const supabase = await createClient();\n\n    const {\n      data: { user },\n      error: authError,\n    } = await supabase.auth.getUser();\n\n    if (authError || !user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    const {",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\portfolio\\route.ts",
        "start": 7,
        "end": 18,
        "startLoc": {
          "line": 7,
          "column": 5,
          "position": 65
        },
        "endLoc": {
          "line": 18,
          "column": 2,
          "position": 168
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\upload\\route.ts",
        "start": 16,
        "end": 26,
        "startLoc": {
          "line": 16,
          "column": 5,
          "position": 166
        },
        "endLoc": {
          "line": 26,
          "column": 9,
          "position": 278
        }
      }
    },
    {
      "format": "typescript",
      "lines": 17,
      "fragment": ";\r\nimport { logger } from '@/lib/logger';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const { room_id",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payment-requests\\route.ts",
        "start": 2,
        "end": 18,
        "startLoc": {
          "line": 2,
          "column": 24,
          "position": 31
        },
        "endLoc": {
          "line": 18,
          "column": 8,
          "position": 205
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 4,
        "end": 19,
        "startLoc": {
          "line": 4,
          "column": 14,
          "position": 56
        },
        "endLoc": {
          "line": 19,
          "column": 23,
          "position": 216
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const { searchParams",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\payment-requests\\route.ts",
        "start": 94,
        "end": 106,
        "startLoc": {
          "line": 94,
          "column": 4,
          "position": 1049
        },
        "endLoc": {
          "line": 106,
          "column": 13,
          "position": 1180
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 7,
        "end": 24,
        "startLoc": {
          "line": 7,
          "column": 5,
          "position": 79
        },
        "endLoc": {
          "line": 24,
          "column": 3,
          "position": 206
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ": NextRequest) {\n  try {\n    //   \n    const authResult = await requireAuth();\n    if (!authResult.success) {\n      return authResult.error!;\n    }\n\n    const { user, supabase } = authResult;\n    if (!user || !supabase) {\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\n    }\n\n    // URL ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\notifications\\route.ts",
        "start": 6,
        "end": 19,
        "startLoc": {
          "line": 6,
          "column": 8,
          "position": 54
        },
        "endLoc": {
          "line": 19,
          "column": 12,
          "position": 173
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\notifications\\read-all\\route.ts",
        "start": 6,
        "end": 21,
        "startLoc": {
          "line": 6,
          "column": 9,
          "position": 54
        },
        "endLoc": {
          "line": 21,
          "column": 17,
          "position": 237
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function GET() {\r\n  try {\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    // helper_profiles profiles  user_id auth.users.id ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\route.ts",
        "start": 6,
        "end": 18,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 50
        },
        "endLoc": {
          "line": 18,
          "column": 59,
          "position": 170
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\seller\\check\\route.ts",
        "start": 4,
        "end": 98,
        "startLoc": {
          "line": 4,
          "column": 1,
          "position": 30
        },
        "endLoc": {
          "line": 98,
          "column": 25,
          "position": 821
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function POST(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\route.ts",
        "start": 89,
        "end": 101,
        "startLoc": {
          "line": 89,
          "column": 1,
          "position": 818
        },
        "endLoc": {
          "line": 101,
          "column": 14,
          "position": 942
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\chat\\rooms\\create-from-order\\route.ts",
        "start": 6,
        "end": 98,
        "startLoc": {
          "line": 6,
          "column": 1,
          "position": 50
        },
        "endLoc": {
          "line": 98,
          "column": 25,
          "position": 821
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "export async function PATCH(request: NextRequest) {\r\n  try {\r\n    const supabase = await createClient();\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (!user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    const { data: existingHelper",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\helper\\route.ts",
        "start": 161,
        "end": 173,
        "startLoc": {
          "line": 161,
          "column": 1,
          "position": 1557
        },
        "endLoc": {
          "line": 173,
          "column": 15,
          "position": 1688
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\helper\\location\\route.ts",
        "start": 127,
        "end": 100,
        "startLoc": {
          "line": 127,
          "column": 1,
          "position": 1266
        },
        "endLoc": {
          "line": 100,
          "column": 14,
          "position": 999
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "();\r\n    if (!authResult.success) {\r\n      return authResult.error!;\r\n    }\r\n\r\n    const { user, supabase } = authResult;\r\n    if (!user || !supabase) {\r\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\r\n    }\r\n\r\n    // profiles   profile id  (FK )",
      "tokens": 0,
      "firstFile": {
        "name": "src\\app\\api\\errands\\route.ts",
        "start": 339,
        "end": 349,
        "startLoc": {
          "line": 339,
          "column": 13,
          "position": 3558
        },
        "endLoc": {
          "line": 349,
          "column": 46,
          "position": 3662
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\complete-revision\\route.ts",
        "start": 11,
        "end": 21,
        "startLoc": {
          "line": 11,
          "column": 12,
          "position": 133
        },
        "endLoc": {
          "line": 21,
          "column": 17,
          "position": 237
        }
      }
    },
    {
      "format": "typescript",
      "lines": 18,
      "fragment": "| null\r\n): Map<string, { sum: number; count: number }> {\r\n  const ratingMap = new Map<string, { sum: number; count: number }>();\r\n  if (!reviewStats) return ratingMap;\r\n\r\n  for (const review of reviewStats) {\r\n    const current = ratingMap.get(review.service_id) || { sum: 0, count: 0 };\r\n    ratingMap.set(review.service_id, {\r\n      sum: current.sum + review.rating,\r\n      count: current.count + 1,\r\n    });\r\n  }\r\n  return ratingMap;\r\n}\r\n\r\n/**\r\n *     (rating )\r\n */",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\services\\service-helpers.ts",
        "start": 28,
        "end": 45,
        "startLoc": {
          "line": 28,
          "column": 2,
          "position": 232
        },
        "endLoc": {
          "line": 45,
          "column": 4,
          "position": 430
        }
      },
      "secondFile": {
        "name": "src\\lib\\supabase\\queries\\search.ts",
        "start": 61,
        "end": 76,
        "startLoc": {
          "line": 61,
          "column": 2,
          "position": 501
        },
        "endLoc": {
          "line": 76,
          "column": 61,
          "position": 699
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ")}`,\r\n    {\r\n      method: 'GET',\r\n      headers: {\r\n        Authorization: `PortOne ${apiSecret}`,\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n      },\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    logger.error('PortOne Identity Verification API error:'",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\portone\\identity.ts",
        "start": 11,
        "end": 24,
        "startLoc": {
          "line": 11,
          "column": 23,
          "position": 99
        },
        "endLoc": {
          "line": 24,
          "column": 43,
          "position": 203
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\webhook\\portone\\payment\\route.ts",
        "start": 18,
        "end": 29,
        "startLoc": {
          "line": 18,
          "column": 10,
          "position": 163
        },
        "endLoc": {
          "line": 29,
          "column": 29,
          "position": 262
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "{\r\n  const categoryMap: Record<string, string> = {\r\n    DELIVERY: '',\r\n    SHOPPING: '',\r\n    MOVING: '/',\r\n    QUEUEING: '',\r\n    PET_CARE: '',\r\n    CLEANING: '',\r\n    BUG_CATCHING: ' ',\r\n    DOCUMENT: '',\r\n    OTHER: '',\r\n  };\r\n  return categoryMap[category] || category;\r\n}",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\errands\\category.ts",
        "start": 8,
        "end": 21,
        "startLoc": {
          "line": 8,
          "column": 2,
          "position": 23
        },
        "endLoc": {
          "line": 21,
          "column": 2,
          "position": 136
        }
      },
      "secondFile": {
        "name": "src\\lib\\errands\\helpers.ts",
        "start": 18,
        "end": 31,
        "startLoc": {
          "line": 18,
          "column": 2,
          "position": 206
        },
        "endLoc": {
          "line": 31,
          "column": 2,
          "position": 319
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ".seller_id)\r\n    .eq('user_id', userId)\r\n    .single();\r\n\r\n  if (!seller) {\r\n    return {\r\n      success: false,\r\n      error: NextResponse.json({ error: 'Unauthorized' }, { status: 403 }),\r\n    };\r\n  }\r\n\r\n  return {\r\n    success: true,\r\n    data: { service",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\api\\ownership.ts",
        "start": 83,
        "end": 96,
        "startLoc": {
          "line": 83,
          "column": 8,
          "position": 644
        },
        "endLoc": {
          "line": 96,
          "column": 8,
          "position": 756
        }
      },
      "secondFile": {
        "name": "src\\lib\\api\\ownership.ts",
        "start": 41,
        "end": 54,
        "startLoc": {
          "line": 41,
          "column": 10,
          "position": 301
        },
        "endLoc": {
          "line": 54,
          "column": 10,
          "position": 413
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": ");\r\n  if (!authResult.success) {\r\n    return { success: false, error: authResult.error! };\r\n  }\r\n\r\n  const { user, supabase } = authResult;\r\n  if (!user || !supabase) {\r\n    return {\r\n      success: false,\r\n      error: NextResponse.json({ error: 'Authentication failed' }, { status: 401 }),\r\n    };\r\n  }\r\n\r\n  //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\api\\errands-common.ts",
        "start": 27,
        "end": 40,
        "startLoc": {
          "line": 27,
          "column": 2,
          "position": 222
        },
        "endLoc": {
          "line": 40,
          "column": 14,
          "position": 358
        }
      },
      "secondFile": {
        "name": "src\\lib\\api\\payment-verify.ts",
        "start": 30,
        "end": 43,
        "startLoc": {
          "line": 30,
          "column": 23,
          "position": 289
        },
        "endLoc": {
          "line": 43,
          "column": 6,
          "position": 425
        }
      }
    },
    {
      "format": "typescript",
      "lines": 14,
      "fragment": "const authResult = await requireLogin();\r\n  if (!authResult.success) {\r\n    return { success: false, error: authResult.error! };\r\n  }\r\n\r\n  const { user, supabase } = authResult;\r\n  if (!user || !supabase) {\r\n    return {\r\n      success: false,\r\n      error: NextResponse.json({ error: 'Authentication failed' }, { status: 401 }),\r\n    };\r\n  }\r\n\r\n  //   ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\api\\chat-common.ts",
        "start": 27,
        "end": 40,
        "startLoc": {
          "line": 27,
          "column": 3,
          "position": 216
        },
        "endLoc": {
          "line": 40,
          "column": 12,
          "position": 362
        }
      },
      "secondFile": {
        "name": "src\\lib\\api\\errands-common.ts",
        "start": 27,
        "end": 43,
        "startLoc": {
          "line": 27,
          "column": 3,
          "position": 212
        },
        "endLoc": {
          "line": 43,
          "column": 6,
          "position": 425
        }
      }
    },
    {
      "format": "typescript",
      "lines": 12,
      "fragment": "{\r\n    const supabase = await createClient();\r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    return",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\api\\auth-middleware.ts",
        "start": 19,
        "end": 30,
        "startLoc": {
          "line": 19,
          "column": 2,
          "position": 103
        },
        "endLoc": {
          "line": 30,
          "column": 7,
          "position": 217
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\payments\\prepare\\route.ts",
        "start": 8,
        "end": 31,
        "startLoc": {
          "line": 8,
          "column": 2,
          "position": 91
        },
        "endLoc": {
          "line": 31,
          "column": 20,
          "position": 303
        }
      }
    },
    {
      "format": "typescript",
      "lines": 134,
      "fragment": "import { NextResponse } from 'next/server';\nimport { createClient } from '@/lib/supabase/server';\nimport type { SupabaseClient } from '@supabase/supabase-js';\nimport { Ratelimit } from '@upstash/ratelimit';\nimport { checkRateLimit } from '@/lib/rate-limit';\n\n/**\n * API   \n */\nexport interface AuthResult {\n  success: boolean;\n  user?: {\n    id: string;\n    email?: string;\n  };\n  supabase?: SupabaseClient;\n  error?: NextResponse | Response;\n}\n\n/**\n * API    \n *    401   \n */\nexport async function requireAuth(): Promise<AuthResult> {\n  const supabase = await createClient();\n  const {\n    data: { user },\n    error: authError,\n  } = await supabase.auth.getUser();\n\n  if (authError || !user) {\n    return {\n      success: false,\n      error: NextResponse.json({ error: ' ' }, { status: 401 }),\n    };\n  }\n\n  return {\n    success: true,\n    user,\n    supabase,\n  };\n}\n\n/**\n * API     ( )\n * ' '  \n */\nexport async function requireLogin(): Promise<AuthResult> {\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return {\n      success: false,\n      error: NextResponse.json({ error: ' ' }, { status: 401 }),\n    };\n  }\n\n  return {\n    success: true,\n    user,\n    supabase,\n  };\n}\n\n/**\n *  profile.id \n */\nexport async function getUserProfileId(\n  supabase: SupabaseClient,\n  userId: string\n): Promise<string | null> {\n  const { data: userProfile } = await supabase\n    .from('profiles')\n    .select('id')\n    .eq('user_id', userId)\n    .single();\n\n  return userProfile?.id || null;\n}\n\n/**\n *  seller.id \n */\nexport async function getUserSellerId(\n  supabase: SupabaseClient,\n  userId: string\n): Promise<string | null> {\n  const { data: seller } = await supabase\n    .from('sellers')\n    .select('id')\n    .eq('user_id', userId)\n    .single();\n\n  return seller?.id || null;\n}\n\n/**\n * API    + Rate Limiting \n *   Rate Limit  \n */\nexport async function requireAuthWithRateLimit(rateLimiter: Ratelimit): Promise<AuthResult> {\n  //   \n  const authResult = await requireAuth();\n  if (!authResult.success) {\n    return authResult;\n  }\n\n  const { user, supabase } = authResult;\n  if (!user || !supabase) {\n    return {\n      success: false,\n      error: NextResponse.json({ error: 'Authentication failed' }, { status: 401 }),\n    };\n  }\n\n  // Rate Limiting \n  const rateLimitResult = await checkRateLimit(user.id, rateLimiter);\n  if (!rateLimitResult.success) {\n    return {\n      success: false,\n      error: rateLimitResult.error,\n    };\n  }\n\n  return {\n    success: true,\n    user,\n    supabase,\n  };\n}",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\api\\auth-backup.ts",
        "start": 1,
        "end": 134,
        "startLoc": {
          "line": 1,
          "column": 1,
          "position": 0
        },
        "endLoc": {
          "line": 134,
          "column": 2,
          "position": 891
        }
      },
      "secondFile": {
        "name": "src\\lib\\api\\auth.ts",
        "start": 1,
        "end": 134,
        "startLoc": {
          "line": 1,
          "column": 1,
          "position": 0
        },
        "endLoc": {
          "line": 134,
          "column": 2,
          "position": 891
        }
      }
    },
    {
      "format": "typescript",
      "lines": 13,
      "fragment": "const supabase = await createClient();\r\n\r\n    //   \r\n    const {\r\n      data: { user },\r\n      error: authError,\r\n    } = await supabase.auth.getUser();\r\n\r\n    if (authError || !user) {\r\n      return NextResponse.json({ error: ' ' }, { status: 401 });\r\n    }\r\n\r\n    //     ",
      "tokens": 0,
      "firstFile": {
        "name": "src\\utils\\orderCountApi.ts",
        "start": 14,
        "end": 26,
        "startLoc": {
          "line": 14,
          "column": 5,
          "position": 107
        },
        "endLoc": {
          "line": 26,
          "column": 19,
          "position": 223
        }
      },
      "secondFile": {
        "name": "src\\app\\api\\orders\\[id]\\confirm\\route.ts",
        "start": 19,
        "end": 31,
        "startLoc": {
          "line": 19,
          "column": 5,
          "position": 187
        },
        "endLoc": {
          "line": 31,
          "column": 20,
          "position": 303
        }
      }
    },
    {
      "format": "typescript",
      "lines": 11,
      "fragment": "let weatherMultiplier = 1;\r\n  if (weather === 'RAIN') {\r\n    weatherMultiplier = PRICING_CONSTANTS.WEATHER_RAIN_MULTIPLIER;\r\n  } else if (weather === 'SNOW') {\r\n    weatherMultiplier = PRICING_CONSTANTS.WEATHER_SNOW_MULTIPLIER;\r\n  } else if (weather === 'EXTREME') {\r\n    weatherMultiplier = PRICING_CONSTANTS.WEATHER_EXTREME_MULTIPLIER;\r\n  }\r\n\r\n  const weatherSurcharge = Math.round(\r\n    (basePrice + rangeFee",
      "tokens": 0,
      "firstFile": {
        "name": "src\\lib\\errand-pricing.ts",
        "start": 243,
        "end": 253,
        "startLoc": {
          "line": 243,
          "column": 3,
          "position": 2100
        },
        "endLoc": {
          "line": 253,
          "column": 9,
          "position": 2218
        }
      },
      "secondFile": {
        "name": "src\\lib\\errand-pricing.ts",
        "start": 79,
        "end": 88,
        "startLoc": {
          "line": 79,
          "column": 3,
          "position": 680
        },
        "endLoc": {
          "line": 88,
          "column": 14,
          "position": 795
        }
      }
    }
  ]
}
